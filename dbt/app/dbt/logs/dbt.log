

============================== 2024-02-03 03:30:00.126404 | 62fb0b47-111c-4469-891d-07ecb65292bf ==============================
[0m03:30:00.126435 [info ] [MainThread]: Running with dbt=1.2.3
[0m03:30:00.127255 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
[0m03:30:00.127672 [debug] [MainThread]: Tracking: tracking
[0m03:30:00.130546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a3cbe3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a3cbe800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a3cbe680>]}
[0m03:30:00.131405 [info ] [MainThread]: To view your profiles.yml file, run:

xdg-open /root/.dbt
[0m03:30:00.132279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a3cbe800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a3cbe680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a3cbe890>]}
[0m03:30:00.133119 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 03:35:32.972562 | affdf934-bf0d-4e80-b536-85b0a8fd2580 ==============================
[0m03:35:32.972588 [info ] [MainThread]: Running with dbt=1.2.3
[0m03:35:32.973323 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
[0m03:35:32.973655 [debug] [MainThread]: Tracking: tracking
[0m03:35:32.976745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f799fb32860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f799fb32b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f799fb32ad0>]}
[0m03:35:32.977483 [info ] [MainThread]: To view your profiles.yml file, run:

xdg-open /root/.dbt
[0m03:35:32.978099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f799fb32b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f799fb32ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f799fb32b30>]}
[0m03:35:32.978605 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 03:54:05.109091 | 71a0a4fe-02fd-4386-8638-33f184f4ab92 ==============================
[0m03:54:05.109119 [info ] [MainThread]: Running with dbt=1.2.3
[0m03:54:05.109887 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
[0m03:54:05.110220 [debug] [MainThread]: Tracking: tracking
[0m03:54:05.113093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f385c54e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f385c5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f385c5a20>]}
[0m03:54:05.113872 [info ] [MainThread]: To view your profiles.yml file, run:

xdg-open /root/.dbt
[0m03:54:05.114540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f385c5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f385c5a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f38586e00>]}
[0m03:54:05.115061 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 03:58:11.378586 | b44ef264-849d-45e7-82ec-04fd8f1fa66f ==============================
[0m03:58:11.378619 [info ] [MainThread]: Running with dbt=1.2.3
[0m03:58:11.379416 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
[0m03:58:11.379813 [debug] [MainThread]: Tracking: tracking
[0m03:58:11.383654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e060e26b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e060e32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e060e3280>]}
[0m03:58:11.384446 [info ] [MainThread]: To view your profiles.yml file, run:

xdg-open /root/.dbt
[0m03:58:11.385056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e060e32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e060e3280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e060e3730>]}
[0m03:58:11.385528 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 04:04:44.386574 | dffaf75e-bd2d-4b58-b71a-de89e02827ca ==============================
[0m04:04:44.386622 [info ] [MainThread]: Running with dbt=1.2.3
[0m04:04:44.387985 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:04:44.388669 [debug] [MainThread]: Tracking: tracking
[0m04:04:44.392837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac33d8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac33d8670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac33d8610>]}
[0m04:04:44.438110 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m04:04:44.438872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dffaf75e-bd2d-4b58-b71a-de89e02827ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac33db880>]}
[0m04:04:44.502017 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:04:44.509566 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:04:44.590214 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:04:44.594344 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:04:44.597779 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:04:44.619004 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:04:44.621545 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:04:44.623077 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:04:44.627073 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:04:44.631717 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:04:44.636934 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:04:44.664264 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:04:44.680405 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:04:44.698692 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:04:44.705279 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:04:44.708152 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:04:44.712044 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:04:44.715312 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:04:44.720633 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:04:44.724506 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:04:44.729332 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:04:44.732246 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:04:44.737809 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:04:44.741059 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:04:44.744412 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:04:44.747278 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:04:44.750596 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:04:44.757939 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:04:44.761371 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:04:44.764442 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:04:44.767526 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:04:44.771517 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:04:44.773997 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:04:44.777166 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:04:44.782342 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:04:44.790130 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:04:44.794865 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:04:44.799694 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:04:44.801806 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:04:44.804297 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:04:44.806887 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:04:44.814120 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:04:44.826628 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:04:44.864703 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:04:44.904488 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:04:44.909605 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:04:44.965310 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:04:45.014257 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:04:45.028896 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:04:45.060191 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:04:45.065211 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:04:45.115793 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:04:45.125012 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:04:45.143501 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:04:45.154928 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:04:45.162360 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:04:45.166398 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:04:45.184170 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:04:45.190065 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:04:45.195882 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:04:45.211700 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:04:45.234448 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:04:45.291871 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:04:45.336878 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:04:45.359529 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:04:45.390957 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:04:45.397829 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:04:45.442977 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:04:45.456990 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:04:45.466278 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:04:45.475425 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:04:46.265887 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ffd.test

[0m04:04:46.281454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dffaf75e-bd2d-4b58-b71a-de89e02827ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac32a4790>]}
[0m04:04:46.295599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dffaf75e-bd2d-4b58-b71a-de89e02827ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac33d85b0>]}
[0m04:04:46.296467 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:04:46.296988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dffaf75e-bd2d-4b58-b71a-de89e02827ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac33db640>]}
[0m04:04:46.299068 [info ] [MainThread]: 
[0m04:04:46.299752 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m04:04:46.313603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac32a4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac32a4b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac32a4be0>]}
[0m04:04:46.314226 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 04:05:43.904666 | c4dc7176-3491-4cef-9193-dabf89151d98 ==============================
[0m04:05:43.904707 [info ] [MainThread]: Running with dbt=1.2.3
[0m04:05:43.905621 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:05:43.906030 [debug] [MainThread]: Tracking: tracking
[0m04:05:43.910007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f473cbc0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f473cbc0dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f473cbc0d60>]}
[0m04:05:44.010803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m04:05:44.011556 [debug] [MainThread]: Partial parsing: added file: ffd://models/test/test.sql
[0m04:05:44.052922 [debug] [MainThread]: 1699: static parser successfully parsed test/test.sql
[0m04:05:44.115120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4dc7176-3491-4cef-9193-dabf89151d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f473cb384f0>]}
[0m04:05:44.130745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4dc7176-3491-4cef-9193-dabf89151d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f473cabec50>]}
[0m04:05:44.131485 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:05:44.132056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4dc7176-3491-4cef-9193-dabf89151d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f473cba4550>]}
[0m04:05:44.134435 [info ] [MainThread]: 
[0m04:05:44.135649 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:05:44.137693 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:05:44.173112 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:05:44.173629 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "prod", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:05:44.173910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:05:44.347097 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.17 seconds
[0m04:05:44.352624 [debug] [ThreadPool]: On list_ffd: Close
[0m04:05:44.356849 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_public"
[0m04:05:44.379095 [debug] [ThreadPool]: Using postgres connection "list_ffd_public"
[0m04:05:44.379587 [debug] [ThreadPool]: On list_ffd_public: BEGIN
[0m04:05:44.379919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:05:44.408505 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m04:05:44.409065 [debug] [ThreadPool]: Using postgres connection "list_ffd_public"
[0m04:05:44.409594 [debug] [ThreadPool]: On list_ffd_public: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "prod", "connection_name": "list_ffd_public"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:05:44.470239 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.06 seconds
[0m04:05:44.476526 [debug] [ThreadPool]: On list_ffd_public: ROLLBACK
[0m04:05:44.478006 [debug] [ThreadPool]: On list_ffd_public: Close
[0m04:05:44.496318 [debug] [MainThread]: Using postgres connection "master"
[0m04:05:44.496913 [debug] [MainThread]: On master: BEGIN
[0m04:05:44.497267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:05:44.520648 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m04:05:44.521236 [debug] [MainThread]: Using postgres connection "master"
[0m04:05:44.521877 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:05:44.549702 [debug] [MainThread]: SQL status: SELECT 0 in 0.03 seconds
[0m04:05:44.554944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4dc7176-3491-4cef-9193-dabf89151d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f473cb74730>]}
[0m04:05:44.555978 [debug] [MainThread]: On master: ROLLBACK
[0m04:05:44.557058 [debug] [MainThread]: Using postgres connection "master"
[0m04:05:44.557655 [debug] [MainThread]: On master: BEGIN
[0m04:05:44.558886 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:05:44.559511 [debug] [MainThread]: On master: COMMIT
[0m04:05:44.559998 [debug] [MainThread]: Using postgres connection "master"
[0m04:05:44.560254 [debug] [MainThread]: On master: COMMIT
[0m04:05:44.560716 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:05:44.561026 [debug] [MainThread]: On master: Close
[0m04:05:44.561853 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m04:05:44.562545 [info ] [MainThread]: 
[0m04:05:44.636868 [debug] [Thread-1 (]: Began running node model.ffd.test
[0m04:05:44.638267 [info ] [Thread-1 (]: 1 of 1 START view model public.test ............................................ [RUN]
[0m04:05:44.640138 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.test"
[0m04:05:44.640834 [debug] [Thread-1 (]: Began compiling node model.ffd.test
[0m04:05:44.641412 [debug] [Thread-1 (]: Compiling model.ffd.test
[0m04:05:44.649699 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.test"
[0m04:05:44.650821 [debug] [Thread-1 (]: finished collecting timing info
[0m04:05:44.651143 [debug] [Thread-1 (]: Began executing node model.ffd.test
[0m04:05:44.768387 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.test"
[0m04:05:44.769610 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:05:44.769943 [debug] [Thread-1 (]: On model.ffd.test: BEGIN
[0m04:05:44.770239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:05:44.797980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:05:44.798576 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:05:44.799210 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "prod", "node_id": "model.ffd.test"} */

  create view "ffd"."public"."test__dbt_tmp" as (
    SELECT 1
UNION
SELECT 2
  );
[0m04:05:44.885539 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.09 seconds
[0m04:05:44.910429 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:05:44.910925 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "prod", "node_id": "model.ffd.test"} */
alter table "ffd"."public"."test" rename to "test__dbt_backup"
[0m04:05:44.914220 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:05:44.920966 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:05:44.921564 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "prod", "node_id": "model.ffd.test"} */
alter table "ffd"."public"."test__dbt_tmp" rename to "test"
[0m04:05:44.923282 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:05:44.986307 [debug] [Thread-1 (]: On model.ffd.test: COMMIT
[0m04:05:44.986813 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:05:44.987085 [debug] [Thread-1 (]: On model.ffd.test: COMMIT
[0m04:05:44.993678 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:05:45.011271 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:05:45.011755 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "prod", "node_id": "model.ffd.test"} */
drop table if exists "ffd"."public"."test__dbt_backup" cascade
[0m04:05:45.053302 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.04 seconds
[0m04:05:45.056561 [debug] [Thread-1 (]: finished collecting timing info
[0m04:05:45.057351 [debug] [Thread-1 (]: On model.ffd.test: Close
[0m04:05:45.059130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4dc7176-3491-4cef-9193-dabf89151d98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f473c1a1510>]}
[0m04:05:45.060736 [info ] [Thread-1 (]: 1 of 1 OK created view model public.test ....................................... [[32mCREATE VIEW[0m in 0.42s]
[0m04:05:45.062481 [debug] [Thread-1 (]: Finished running node model.ffd.test
[0m04:05:45.065717 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:05:45.066586 [debug] [MainThread]: Using postgres connection "master"
[0m04:05:45.067115 [debug] [MainThread]: On master: BEGIN
[0m04:05:45.067631 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:05:45.092392 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m04:05:45.093040 [debug] [MainThread]: On master: COMMIT
[0m04:05:45.093398 [debug] [MainThread]: Using postgres connection "master"
[0m04:05:45.093749 [debug] [MainThread]: On master: COMMIT
[0m04:05:45.094347 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:05:45.094749 [debug] [MainThread]: On master: Close
[0m04:05:45.095953 [info ] [MainThread]: 
[0m04:05:45.096915 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m04:05:45.097830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:05:45.098354 [debug] [MainThread]: Connection 'model.ffd.test' was properly closed.
[0m04:05:45.116394 [info ] [MainThread]: 
[0m04:05:45.117036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:05:45.117682 [info ] [MainThread]: 
[0m04:05:45.118230 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:05:45.119006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f473c1ed240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f473c1aca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f473cb77160>]}
[0m04:05:45.119620 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 04:08:13.710846 | 09e49513-7d4b-4e00-8bed-b434a8bfc85e ==============================
[0m04:08:13.710887 [info ] [MainThread]: Running with dbt=1.2.3
[0m04:08:13.711881 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:08:13.712331 [debug] [MainThread]: Tracking: tracking
[0m04:08:13.715560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca871cca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca871cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca871cd30>]}
[0m04:08:13.811100 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:08:13.811560 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:08:13.827365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09e49513-7d4b-4e00-8bed-b434a8bfc85e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca6d4c0d0>]}
[0m04:08:13.843188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09e49513-7d4b-4e00-8bed-b434a8bfc85e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca6f2d510>]}
[0m04:08:13.844010 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:08:13.844562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09e49513-7d4b-4e00-8bed-b434a8bfc85e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca6f2d690>]}
[0m04:08:13.847081 [info ] [MainThread]: 
[0m04:08:13.848306 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:08:13.850335 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:08:13.887678 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:08:13.888271 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "prod", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:08:13.888544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:08:13.919275 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.03 seconds
[0m04:08:13.922247 [debug] [ThreadPool]: On list_ffd: Close
[0m04:08:13.925330 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_public"
[0m04:08:13.947571 [debug] [ThreadPool]: Using postgres connection "list_ffd_public"
[0m04:08:13.948135 [debug] [ThreadPool]: On list_ffd_public: BEGIN
[0m04:08:13.948404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:08:13.977399 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m04:08:13.977911 [debug] [ThreadPool]: Using postgres connection "list_ffd_public"
[0m04:08:13.978185 [debug] [ThreadPool]: On list_ffd_public: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "prod", "connection_name": "list_ffd_public"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:08:13.986088 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:13.991281 [debug] [ThreadPool]: On list_ffd_public: ROLLBACK
[0m04:08:13.992323 [debug] [ThreadPool]: On list_ffd_public: Close
[0m04:08:14.009206 [debug] [MainThread]: Using postgres connection "master"
[0m04:08:14.009849 [debug] [MainThread]: On master: BEGIN
[0m04:08:14.010246 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:08:14.033400 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m04:08:14.033950 [debug] [MainThread]: Using postgres connection "master"
[0m04:08:14.034574 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:08:14.047927 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m04:08:14.052528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09e49513-7d4b-4e00-8bed-b434a8bfc85e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca6f1af80>]}
[0m04:08:14.053550 [debug] [MainThread]: On master: ROLLBACK
[0m04:08:14.054553 [debug] [MainThread]: Using postgres connection "master"
[0m04:08:14.054971 [debug] [MainThread]: On master: BEGIN
[0m04:08:14.056017 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:08:14.056511 [debug] [MainThread]: On master: COMMIT
[0m04:08:14.056900 [debug] [MainThread]: Using postgres connection "master"
[0m04:08:14.057275 [debug] [MainThread]: On master: COMMIT
[0m04:08:14.057924 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:08:14.058401 [debug] [MainThread]: On master: Close
[0m04:08:14.059519 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m04:08:14.060512 [info ] [MainThread]: 
[0m04:08:14.068269 [debug] [Thread-1 (]: Began running node model.ffd.test
[0m04:08:14.069168 [info ] [Thread-1 (]: 1 of 1 START view model public.test ............................................ [RUN]
[0m04:08:14.070505 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.test"
[0m04:08:14.071021 [debug] [Thread-1 (]: Began compiling node model.ffd.test
[0m04:08:14.071476 [debug] [Thread-1 (]: Compiling model.ffd.test
[0m04:08:14.077059 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.test"
[0m04:08:14.078300 [debug] [Thread-1 (]: finished collecting timing info
[0m04:08:14.078888 [debug] [Thread-1 (]: Began executing node model.ffd.test
[0m04:08:14.198272 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.test"
[0m04:08:14.199292 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:08:14.199587 [debug] [Thread-1 (]: On model.ffd.test: BEGIN
[0m04:08:14.199891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:08:14.229471 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:08:14.229994 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:08:14.230262 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "prod", "node_id": "model.ffd.test"} */

  create view "ffd"."public"."test__dbt_tmp" as (
    SELECT 1
UNION
SELECT 2
  );
[0m04:08:14.235939 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m04:08:14.256616 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:08:14.257102 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "prod", "node_id": "model.ffd.test"} */
alter table "ffd"."public"."test" rename to "test__dbt_backup"
[0m04:08:14.258658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:08:14.265265 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:08:14.265824 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "prod", "node_id": "model.ffd.test"} */
alter table "ffd"."public"."test__dbt_tmp" rename to "test"
[0m04:08:14.267243 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:08:14.328404 [debug] [Thread-1 (]: On model.ffd.test: COMMIT
[0m04:08:14.328907 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:08:14.329176 [debug] [Thread-1 (]: On model.ffd.test: COMMIT
[0m04:08:14.345852 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m04:08:14.369231 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:08:14.369723 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "prod", "node_id": "model.ffd.test"} */
drop view if exists "ffd"."public"."test__dbt_backup" cascade
[0m04:08:14.379171 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m04:08:14.383441 [debug] [Thread-1 (]: finished collecting timing info
[0m04:08:14.384177 [debug] [Thread-1 (]: On model.ffd.test: Close
[0m04:08:14.385742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09e49513-7d4b-4e00-8bed-b434a8bfc85e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca4c3be20>]}
[0m04:08:14.387148 [info ] [Thread-1 (]: 1 of 1 OK created view model public.test ....................................... [[32mCREATE VIEW[0m in 0.32s]
[0m04:08:14.388635 [debug] [Thread-1 (]: Finished running node model.ffd.test
[0m04:08:14.390975 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:08:14.391508 [debug] [MainThread]: Using postgres connection "master"
[0m04:08:14.391776 [debug] [MainThread]: On master: BEGIN
[0m04:08:14.392136 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:08:14.417456 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:08:14.418239 [debug] [MainThread]: On master: COMMIT
[0m04:08:14.418865 [debug] [MainThread]: Using postgres connection "master"
[0m04:08:14.419479 [debug] [MainThread]: On master: COMMIT
[0m04:08:14.420324 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:08:14.420871 [debug] [MainThread]: On master: Close
[0m04:08:14.422354 [info ] [MainThread]: 
[0m04:08:14.423286 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m04:08:14.424242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:08:14.424747 [debug] [MainThread]: Connection 'model.ffd.test' was properly closed.
[0m04:08:14.444573 [info ] [MainThread]: 
[0m04:08:14.445199 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:08:14.445802 [info ] [MainThread]: 
[0m04:08:14.446298 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:08:14.447003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca4c3bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca6e2a2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca6e2bc70>]}
[0m04:08:14.447556 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 04:18:18.176007 | 34aaf723-3c93-4ad8-ac14-a29ee3de39da ==============================
[0m04:18:18.176043 [info ] [MainThread]: Running with dbt=1.2.3
[0m04:18:18.176973 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:18:18.177376 [debug] [MainThread]: Tracking: tracking
[0m04:18:18.180922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afec9cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afec9d000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afec9cfa0>]}
[0m04:18:18.236634 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:18:18.237461 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m04:18:18.238069 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:18:18.238714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '34aaf723-3c93-4ad8-ac14-a29ee3de39da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afec82770>]}
[0m04:18:18.276602 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:18:18.284019 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:18:18.371353 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:18:18.375376 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:18:18.378667 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:18:18.399107 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:18:18.401060 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:18:18.402329 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:18:18.406139 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:18:18.410713 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:18:18.415805 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:18:18.442656 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:18:18.457719 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:18:18.475584 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:18:18.482129 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:18:18.485142 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:18:18.489121 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:18:18.492436 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:18:18.496244 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:18:18.499528 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:18:18.502673 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:18:18.505436 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:18:18.510983 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:18:18.514104 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:18:18.517835 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:18:18.520965 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:18:18.524187 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:18:18.531426 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:18:18.534728 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:18:18.537498 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:18:18.540442 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:18:18.544304 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:18:18.546900 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:18:18.550285 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:18:18.555424 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:18:18.563235 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:18:18.567814 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:18:18.572143 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:18:18.574181 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:18:18.576702 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:18:18.579240 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:18:18.586453 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:18:18.599471 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:18:18.637349 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:18:18.677209 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:18:18.682505 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:18:18.738310 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:18:18.786560 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:18:18.801985 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:18:18.833474 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:18:18.838537 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:18:18.889885 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:18:18.899165 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:18:18.917220 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:18:18.928256 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:18:18.935468 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:18:18.939437 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:18:18.957174 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:18:18.962918 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:18:18.969069 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:18:18.984314 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:18:19.006720 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:18:19.063347 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:18:19.110793 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:18:19.133979 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:18:19.166114 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:18:19.172949 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:18:19.218243 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:18:19.232492 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:18:19.241670 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:18:19.250805 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:18:20.015431 [debug] [MainThread]: 1699: static parser successfully parsed stg/test.sql
[0m04:18:20.139240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34aaf723-3c93-4ad8-ac14-a29ee3de39da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afec18850>]}
[0m04:18:20.154757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34aaf723-3c93-4ad8-ac14-a29ee3de39da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afec181f0>]}
[0m04:18:20.155505 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:18:20.156067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34aaf723-3c93-4ad8-ac14-a29ee3de39da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afec82d70>]}
[0m04:18:20.158487 [info ] [MainThread]: 
[0m04:18:20.159702 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:18:20.161593 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:18:20.195016 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:18:20.195525 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:18:20.195857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:18:20.222092 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.03 seconds
[0m04:18:20.225438 [debug] [ThreadPool]: On list_ffd: Close
[0m04:18:20.227605 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_mrt_stg"
[0m04:18:20.228857 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_mrt_stg"
[0m04:18:20.229612 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='ffd', schema='mrt_stg', identifier=None)"
[0m04:18:20.247885 [debug] [ThreadPool]: Using postgres connection "create_ffd_mrt_stg"
[0m04:18:20.248415 [debug] [ThreadPool]: On create_ffd_mrt_stg: BEGIN
[0m04:18:20.248708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:18:20.270880 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m04:18:20.271446 [debug] [ThreadPool]: Using postgres connection "create_ffd_mrt_stg"
[0m04:18:20.271922 [debug] [ThreadPool]: On create_ffd_mrt_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "create_ffd_mrt_stg"} */
create schema if not exists "mrt_stg"
[0m04:18:20.280679 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.01 seconds
[0m04:18:20.284026 [debug] [ThreadPool]: On create_ffd_mrt_stg: COMMIT
[0m04:18:20.284577 [debug] [ThreadPool]: Using postgres connection "create_ffd_mrt_stg"
[0m04:18:20.285029 [debug] [ThreadPool]: On create_ffd_mrt_stg: COMMIT
[0m04:18:20.299244 [debug] [ThreadPool]: SQL status: COMMIT in 0.01 seconds
[0m04:18:20.300184 [debug] [ThreadPool]: On create_ffd_mrt_stg: Close
[0m04:18:20.304558 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_mrt_stg"
[0m04:18:20.326503 [debug] [ThreadPool]: Using postgres connection "list_ffd_mrt_stg"
[0m04:18:20.327003 [debug] [ThreadPool]: On list_ffd_mrt_stg: BEGIN
[0m04:18:20.327272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:18:20.355726 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m04:18:20.356265 [debug] [ThreadPool]: Using postgres connection "list_ffd_mrt_stg"
[0m04:18:20.356540 [debug] [ThreadPool]: On list_ffd_mrt_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "list_ffd_mrt_stg"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mrt_stg'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mrt_stg'
  
[0m04:18:20.365251 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m04:18:20.369900 [debug] [ThreadPool]: On list_ffd_mrt_stg: ROLLBACK
[0m04:18:20.370902 [debug] [ThreadPool]: On list_ffd_mrt_stg: Close
[0m04:18:20.387452 [debug] [MainThread]: Using postgres connection "master"
[0m04:18:20.387989 [debug] [MainThread]: On master: BEGIN
[0m04:18:20.388258 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:18:20.416433 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:18:20.417128 [debug] [MainThread]: Using postgres connection "master"
[0m04:18:20.417699 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:18:20.430638 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m04:18:20.435503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34aaf723-3c93-4ad8-ac14-a29ee3de39da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afe277ac0>]}
[0m04:18:20.436447 [debug] [MainThread]: On master: ROLLBACK
[0m04:18:20.437334 [debug] [MainThread]: Using postgres connection "master"
[0m04:18:20.437767 [debug] [MainThread]: On master: BEGIN
[0m04:18:20.438733 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:18:20.439177 [debug] [MainThread]: On master: COMMIT
[0m04:18:20.439569 [debug] [MainThread]: Using postgres connection "master"
[0m04:18:20.439984 [debug] [MainThread]: On master: COMMIT
[0m04:18:20.440605 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:18:20.441052 [debug] [MainThread]: On master: Close
[0m04:18:20.442178 [info ] [MainThread]: Concurrency: 1 threads (target='mrt')
[0m04:18:20.443124 [info ] [MainThread]: 
[0m04:18:20.450135 [debug] [Thread-1 (]: Began running node model.ffd.test
[0m04:18:20.451000 [info ] [Thread-1 (]: 1 of 1 START table model mrt_stg.test .......................................... [RUN]
[0m04:18:20.452251 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.test"
[0m04:18:20.452771 [debug] [Thread-1 (]: Began compiling node model.ffd.test
[0m04:18:20.453285 [debug] [Thread-1 (]: Compiling model.ffd.test
[0m04:18:20.459573 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.test"
[0m04:18:20.460865 [debug] [Thread-1 (]: finished collecting timing info
[0m04:18:20.461353 [debug] [Thread-1 (]: Began executing node model.ffd.test
[0m04:18:20.586776 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.test"
[0m04:18:20.587880 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:18:20.588179 [debug] [Thread-1 (]: On model.ffd.test: BEGIN
[0m04:18:20.588452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:18:20.616348 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:18:20.616960 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:18:20.617594 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.test"} */


  create  table "ffd"."mrt_stg"."test__dbt_tmp"
  as (
    SELECT 1
UNION
SELECT 2
  );
[0m04:18:20.622512 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m04:18:20.646443 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:18:20.646935 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.test"} */
alter table "ffd"."mrt_stg"."test__dbt_tmp" rename to "test"
[0m04:18:20.648313 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:18:20.713774 [debug] [Thread-1 (]: On model.ffd.test: COMMIT
[0m04:18:20.714294 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:18:20.714568 [debug] [Thread-1 (]: On model.ffd.test: COMMIT
[0m04:18:20.724711 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:18:20.743812 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:18:20.744309 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.test"} */
drop table if exists "ffd"."mrt_stg"."test__dbt_backup" cascade
[0m04:18:20.745161 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m04:18:20.747933 [debug] [Thread-1 (]: finished collecting timing info
[0m04:18:20.748417 [debug] [Thread-1 (]: On model.ffd.test: Close
[0m04:18:20.749497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34aaf723-3c93-4ad8-ac14-a29ee3de39da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afe2b4190>]}
[0m04:18:20.750536 [info ] [Thread-1 (]: 1 of 1 OK created table model mrt_stg.test ..................................... [[32mSELECT 2[0m in 0.30s]
[0m04:18:20.751701 [debug] [Thread-1 (]: Finished running node model.ffd.test
[0m04:18:20.754411 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:18:20.754965 [debug] [MainThread]: Using postgres connection "master"
[0m04:18:20.755263 [debug] [MainThread]: On master: BEGIN
[0m04:18:20.755548 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:18:20.784196 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:18:20.784855 [debug] [MainThread]: On master: COMMIT
[0m04:18:20.785218 [debug] [MainThread]: Using postgres connection "master"
[0m04:18:20.785574 [debug] [MainThread]: On master: COMMIT
[0m04:18:20.786224 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:18:20.786625 [debug] [MainThread]: On master: Close
[0m04:18:20.787712 [info ] [MainThread]: 
[0m04:18:20.788643 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m04:18:20.789469 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:18:20.789922 [debug] [MainThread]: Connection 'model.ffd.test' was properly closed.
[0m04:18:20.809010 [info ] [MainThread]: 
[0m04:18:20.809642 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:18:20.810237 [info ] [MainThread]: 
[0m04:18:20.810724 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:18:20.811443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afec18490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afec195a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afe285c90>]}
[0m04:18:20.812067 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 04:19:37.368735 | c7a8ee65-a05b-45b1-8a24-7c7d52f97cf8 ==============================
[0m04:19:37.368774 [info ] [MainThread]: Running with dbt=1.2.3
[0m04:19:37.369707 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:19:37.370115 [debug] [MainThread]: Tracking: tracking
[0m04:19:37.373357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f12570f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f12571030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f12570fd0>]}
[0m04:19:37.428970 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:19:37.429888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c7a8ee65-a05b-45b1-8a24-7c7d52f97cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f12542470>]}
[0m04:19:37.468059 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:19:37.475519 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:19:37.564977 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:19:37.569005 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:19:37.572329 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:19:37.593036 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:19:37.594991 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:19:37.596281 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:19:37.600171 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:19:37.604910 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:19:37.610345 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:19:37.637440 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:19:37.652152 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:19:37.670446 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:19:37.677126 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:19:37.680352 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:19:37.684444 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:19:37.687869 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:19:37.691716 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:19:37.695138 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:19:37.698382 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:19:37.701577 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:19:37.707466 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:19:37.710840 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:19:37.714843 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:19:37.718024 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:19:37.721520 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:19:37.729385 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:19:37.732726 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:19:37.735454 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:19:37.738236 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:19:37.742025 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:19:37.744473 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:19:37.747663 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:19:37.752791 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:19:37.760814 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:19:37.765301 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:19:37.769566 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:19:37.771637 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:19:37.774101 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:19:37.776632 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:19:37.783917 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:19:37.796014 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:19:37.833303 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:19:37.872874 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:19:37.878074 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:19:37.934796 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:19:37.982790 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:19:37.997599 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:19:38.028371 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:19:38.033227 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:19:38.083855 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:19:38.093263 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:19:38.111907 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:19:38.123127 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:19:38.130368 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:19:38.134343 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:19:38.151682 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:19:38.157706 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:19:38.163558 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:19:38.179183 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:19:38.201611 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:19:38.259510 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:19:38.304231 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:19:38.327237 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:19:38.358729 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:19:38.365374 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:19:38.410008 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:19:38.424017 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:19:38.433150 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:19:38.442055 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:19:39.210998 [debug] [MainThread]: 1699: static parser successfully parsed stg/test.sql
[0m04:19:39.332070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7a8ee65-a05b-45b1-8a24-7c7d52f97cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f124e87c0>]}
[0m04:19:39.347660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7a8ee65-a05b-45b1-8a24-7c7d52f97cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f124e8160>]}
[0m04:19:39.348492 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:19:39.349015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7a8ee65-a05b-45b1-8a24-7c7d52f97cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f12541c60>]}
[0m04:19:39.351464 [info ] [MainThread]: 
[0m04:19:39.352801 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:19:39.354760 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:19:39.390148 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:19:39.390660 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:19:39.390935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:19:39.423886 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
[0m04:19:39.429079 [debug] [ThreadPool]: On list_ffd: Close
[0m04:19:39.432851 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_mrt_stg"
[0m04:19:39.456635 [debug] [ThreadPool]: Using postgres connection "list_ffd_mrt_stg"
[0m04:19:39.457140 [debug] [ThreadPool]: On list_ffd_mrt_stg: BEGIN
[0m04:19:39.457415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:19:39.484699 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m04:19:39.485320 [debug] [ThreadPool]: Using postgres connection "list_ffd_mrt_stg"
[0m04:19:39.485680 [debug] [ThreadPool]: On list_ffd_mrt_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "list_ffd_mrt_stg"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mrt_stg'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mrt_stg'
  
[0m04:19:39.495650 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m04:19:39.499371 [debug] [ThreadPool]: On list_ffd_mrt_stg: ROLLBACK
[0m04:19:39.500287 [debug] [ThreadPool]: On list_ffd_mrt_stg: Close
[0m04:19:39.517113 [debug] [MainThread]: Using postgres connection "master"
[0m04:19:39.517763 [debug] [MainThread]: On master: BEGIN
[0m04:19:39.518156 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:19:39.541733 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m04:19:39.542276 [debug] [MainThread]: Using postgres connection "master"
[0m04:19:39.542561 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:19:39.554722 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m04:19:39.557754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7a8ee65-a05b-45b1-8a24-7c7d52f97cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f11b303a0>]}
[0m04:19:39.558516 [debug] [MainThread]: On master: ROLLBACK
[0m04:19:39.559241 [debug] [MainThread]: Using postgres connection "master"
[0m04:19:39.559591 [debug] [MainThread]: On master: BEGIN
[0m04:19:39.560436 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:19:39.560898 [debug] [MainThread]: On master: COMMIT
[0m04:19:39.561207 [debug] [MainThread]: Using postgres connection "master"
[0m04:19:39.561512 [debug] [MainThread]: On master: COMMIT
[0m04:19:39.562159 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:19:39.562558 [debug] [MainThread]: On master: Close
[0m04:19:39.563460 [info ] [MainThread]: Concurrency: 1 threads (target='mrt')
[0m04:19:39.564407 [info ] [MainThread]: 
[0m04:19:39.573292 [debug] [Thread-1 (]: Began running node model.ffd.test
[0m04:19:39.574217 [info ] [Thread-1 (]: 1 of 1 START table model mrt_stg.test .......................................... [RUN]
[0m04:19:39.575665 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.test"
[0m04:19:39.576362 [debug] [Thread-1 (]: Began compiling node model.ffd.test
[0m04:19:39.576759 [debug] [Thread-1 (]: Compiling model.ffd.test
[0m04:19:39.581515 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.test"
[0m04:19:39.582547 [debug] [Thread-1 (]: finished collecting timing info
[0m04:19:39.583028 [debug] [Thread-1 (]: Began executing node model.ffd.test
[0m04:19:39.710100 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.test"
[0m04:19:39.711141 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:19:39.711439 [debug] [Thread-1 (]: On model.ffd.test: BEGIN
[0m04:19:39.711708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:19:39.735577 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m04:19:39.736211 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:19:39.736570 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.test"} */


  create  table "ffd"."mrt_stg"."test__dbt_tmp"
  as (
    SELECT 1
UNION
SELECT 2
  );
[0m04:19:39.741469 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m04:19:39.763968 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:19:39.764474 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.test"} */
alter table "ffd"."mrt_stg"."test" rename to "test__dbt_backup"
[0m04:19:39.765730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:19:39.772046 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:19:39.772510 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.test"} */
alter table "ffd"."mrt_stg"."test__dbt_tmp" rename to "test"
[0m04:19:39.773663 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:19:39.845872 [debug] [Thread-1 (]: On model.ffd.test: COMMIT
[0m04:19:39.846391 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:19:39.846662 [debug] [Thread-1 (]: On model.ffd.test: COMMIT
[0m04:19:39.854930 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:19:39.874418 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:19:39.874901 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.test"} */
drop table if exists "ffd"."mrt_stg"."test__dbt_backup" cascade
[0m04:19:39.888914 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m04:19:39.891993 [debug] [Thread-1 (]: finished collecting timing info
[0m04:19:39.892749 [debug] [Thread-1 (]: On model.ffd.test: Close
[0m04:19:39.894363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7a8ee65-a05b-45b1-8a24-7c7d52f97cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f11b9f2e0>]}
[0m04:19:39.895839 [info ] [Thread-1 (]: 1 of 1 OK created table model mrt_stg.test ..................................... [[32mSELECT 2[0m in 0.32s]
[0m04:19:39.897510 [debug] [Thread-1 (]: Finished running node model.ffd.test
[0m04:19:39.900752 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:19:39.901546 [debug] [MainThread]: Using postgres connection "master"
[0m04:19:39.902013 [debug] [MainThread]: On master: BEGIN
[0m04:19:39.902471 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:19:39.928955 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:19:39.929764 [debug] [MainThread]: On master: COMMIT
[0m04:19:39.930401 [debug] [MainThread]: Using postgres connection "master"
[0m04:19:39.931084 [debug] [MainThread]: On master: COMMIT
[0m04:19:39.932056 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:19:39.932546 [debug] [MainThread]: On master: Close
[0m04:19:39.934059 [info ] [MainThread]: 
[0m04:19:39.935106 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m04:19:39.936145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:19:39.936624 [debug] [MainThread]: Connection 'model.ffd.test' was properly closed.
[0m04:19:39.954206 [info ] [MainThread]: 
[0m04:19:39.954845 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:19:39.955462 [info ] [MainThread]: 
[0m04:19:39.956006 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:19:39.956785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f11b849d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f124e8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f124cc4f0>]}
[0m04:19:39.957344 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 04:21:46.432599 | 605c4d80-9731-4d8e-a03a-614d9fe0d7bf ==============================
[0m04:21:46.432637 [info ] [MainThread]: Running with dbt=1.2.3
[0m04:21:46.433551 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:21:46.433970 [debug] [MainThread]: Tracking: tracking
[0m04:21:46.437848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70415a0ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70415a0fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70415a0f70>]}
[0m04:21:46.493801 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:21:46.494667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '605c4d80-9731-4d8e-a03a-614d9fe0d7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70415867d0>]}
[0m04:21:46.532589 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:21:46.540101 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:21:46.625781 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:21:46.630512 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:21:46.634414 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:21:46.655979 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:21:46.658561 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:21:46.660606 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:21:46.665094 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:21:46.669823 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:21:46.675097 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:21:46.702364 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:21:46.718803 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:21:46.739086 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:21:46.746339 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:21:46.749375 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:21:46.753219 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:21:46.756513 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:21:46.760341 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:21:46.763679 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:21:46.766875 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:21:46.769632 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:21:46.775181 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:21:46.778306 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:21:46.781945 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:21:46.784881 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:21:46.788223 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:21:46.796115 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:21:46.799913 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:21:46.803217 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:21:46.807014 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:21:46.811740 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:21:46.814709 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:21:46.818042 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:21:46.823172 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:21:46.830904 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:21:46.835525 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:21:46.839917 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:21:46.841946 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:21:46.844374 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:21:46.846941 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:21:46.854711 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:21:46.866928 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:21:46.904637 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:21:46.944543 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:21:46.949878 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:21:47.006302 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:21:47.054924 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:21:47.069461 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:21:47.100101 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:21:47.105333 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:21:47.155144 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:21:47.164978 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:21:47.183485 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:21:47.194356 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:21:47.201819 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:21:47.205828 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:21:47.223499 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:21:47.229521 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:21:47.235169 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:21:47.250180 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:21:47.272629 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:21:47.329405 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:21:47.374749 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:21:47.397614 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:21:47.429158 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:21:47.435969 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:21:47.481420 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:21:47.495450 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:21:47.505013 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:21:47.513470 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:21:48.292812 [debug] [MainThread]: 1699: static parser successfully parsed stg/test.sql
[0m04:21:48.433143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '605c4d80-9731-4d8e-a03a-614d9fe0d7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70414d66e0>]}
[0m04:21:48.450130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '605c4d80-9731-4d8e-a03a-614d9fe0d7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70415a30d0>]}
[0m04:21:48.450937 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:21:48.451494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '605c4d80-9731-4d8e-a03a-614d9fe0d7bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7041586230>]}
[0m04:21:48.454640 [info ] [MainThread]: 
[0m04:21:48.456277 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:21:48.459388 [debug] [ThreadPool]: Acquiring new postgres connection "list_stg"
[0m04:21:48.481328 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m04:21:48.481940 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m04:21:48.482308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:21:48.505057 [debug] [ThreadPool]: On list_stg: Close
[0m04:21:48.507343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:21:48.508040 [debug] [MainThread]: Connection 'list_stg' was properly closed.
[0m04:21:48.508867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70414d48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70414d7280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70414ccc10>]}
[0m04:21:48.509802 [debug] [MainThread]: Flushing usage events
[0m04:21:48.772062 [error] [MainThread]: Encountered an error:
Runtime Error
  Cross-db references not allowed in postgres (stg vs ffd)
[0m04:21:48.843278 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/postgres/connections.py", line 65, in exception_handler
    yield
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 976, in execute_macro
    result = macro_function(**kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/clients/jinja.py", line 321, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/clients/jinja.py", line 248, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 20, in macro
  File "/usr/local/lib/python3.10/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/clients/jinja.py", line 321, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/clients/jinja.py", line 248, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/usr/local/lib/python3.10/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/postgres/impl.py", line 76, in verify_database
    raise dbt.exceptions.NotImplementedException(
dbt.exceptions.NotImplementedException: Cross-db references not allowed in postgres (stg vs ffd)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/main.py", line 129, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.10/site-packages/dbt/main.py", line 191, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.10/site-packages/dbt/main.py", line 238, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/runnable.py", line 470, in run
    result = self.execute_with_hooks(selected_uids)
  File "/usr/local/lib/python3.10/site-packages/dbt/task/runnable.py", line 432, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/lib/python3.10/site-packages/dbt/task/run.py", line 442, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/usr/local/lib/python3.10/site-packages/dbt/task/runnable.py", line 555, in create_schemas
    existing_schemas_lowered.update(ls_future.result())
  File "/usr/local/lib/python3.10/concurrent/futures/_base.py", line 451, in result
    return self.__get_result()
  File "/usr/local/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
    raise self._exception
  File "/usr/local/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/utils.py", line 480, in connected
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.10/site-packages/dbt/task/runnable.py", line 532, in list_schemas
    for s in adapter.list_schemas(database_quoted)
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/sql/impl.py", line 207, in list_schemas
    results = self.execute_macro(LIST_SCHEMAS_MACRO_NAME, kwargs={"database": database})
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 975, in execute_macro
    with self.connections.exception_handler(f"macro {macro_name}"):
  File "/usr/local/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/usr/local/lib/python3.10/site-packages/dbt/adapters/postgres/connections.py", line 88, in exception_handler
    raise dbt.exceptions.RuntimeException(e) from e
dbt.exceptions.RuntimeException: Runtime Error
  Cross-db references not allowed in postgres (stg vs ffd)



============================== 2024-02-03 04:22:35.868040 | a6c5ba0f-9479-4fc1-b916-eae1506b286d ==============================
[0m04:22:35.868079 [info ] [MainThread]: Running with dbt=1.2.3
[0m04:22:35.869018 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:22:35.869436 [debug] [MainThread]: Tracking: tracking
[0m04:22:35.873258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f40358f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f40359030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f40358fd0>]}
[0m04:22:35.929508 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:22:35.930352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a6c5ba0f-9479-4fc1-b916-eae1506b286d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4032a200>]}
[0m04:22:35.968251 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:22:35.975664 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:22:36.060302 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:22:36.064375 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:22:36.067729 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:22:36.089149 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:22:36.091225 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:22:36.092626 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:22:36.096585 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:22:36.101199 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:22:36.106501 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:22:36.133879 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:22:36.148652 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:22:36.166943 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:22:36.173683 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:22:36.176567 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:22:36.180495 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:22:36.183987 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:22:36.187945 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:22:36.191456 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:22:36.194574 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:22:36.197341 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:22:36.202896 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:22:36.206045 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:22:36.209670 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:22:36.212576 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:22:36.215752 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:22:36.223144 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:22:36.226858 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:22:36.229628 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:22:36.232391 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:22:36.236215 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:22:36.238701 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:22:36.241866 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:22:36.247073 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:22:36.255201 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:22:36.259632 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:22:36.263896 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:22:36.265874 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:22:36.268275 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:22:36.270783 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:22:36.277810 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:22:36.290335 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:22:36.328128 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:22:36.368431 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:22:36.373655 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:22:36.429935 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:22:36.478393 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:22:36.493036 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:22:36.524378 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:22:36.529353 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:22:36.579931 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:22:36.589359 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:22:36.607393 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:22:36.618503 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:22:36.626074 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:22:36.630144 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:22:36.647856 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:22:36.653584 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:22:36.659521 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:22:36.675571 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:22:36.700308 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:22:36.757799 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:22:36.806185 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:22:36.828705 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:22:36.860992 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:22:36.868506 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:22:36.913012 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:22:36.927763 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:22:36.938360 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:22:36.947547 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:22:37.714229 [debug] [MainThread]: 1699: static parser successfully parsed stg/test.sql
[0m04:22:37.842207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6c5ba0f-9479-4fc1-b916-eae1506b286d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f402d07c0>]}
[0m04:22:37.858166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6c5ba0f-9479-4fc1-b916-eae1506b286d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f402d0160>]}
[0m04:22:37.858922 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:22:37.859461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6c5ba0f-9479-4fc1-b916-eae1506b286d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f40329c60>]}
[0m04:22:37.862031 [info ] [MainThread]: 
[0m04:22:37.863266 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:22:37.865280 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:22:37.898657 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:22:37.899162 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:22:37.899462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:22:37.926450 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
[0m04:22:37.929468 [debug] [ThreadPool]: On list_ffd: Close
[0m04:22:37.932514 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_mrt_stg"
[0m04:22:37.954623 [debug] [ThreadPool]: Using postgres connection "list_ffd_mrt_stg"
[0m04:22:37.955128 [debug] [ThreadPool]: On list_ffd_mrt_stg: BEGIN
[0m04:22:37.955398 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:22:37.984276 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m04:22:37.984976 [debug] [ThreadPool]: Using postgres connection "list_ffd_mrt_stg"
[0m04:22:37.985682 [debug] [ThreadPool]: On list_ffd_mrt_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "list_ffd_mrt_stg"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mrt_stg'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mrt_stg'
  
[0m04:22:37.994776 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m04:22:37.999992 [debug] [ThreadPool]: On list_ffd_mrt_stg: ROLLBACK
[0m04:22:38.000994 [debug] [ThreadPool]: On list_ffd_mrt_stg: Close
[0m04:22:38.017939 [debug] [MainThread]: Using postgres connection "master"
[0m04:22:38.018549 [debug] [MainThread]: On master: BEGIN
[0m04:22:38.018914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:22:38.046047 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:22:38.046563 [debug] [MainThread]: Using postgres connection "master"
[0m04:22:38.046839 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:22:38.060149 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m04:22:38.064843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6c5ba0f-9479-4fc1-b916-eae1506b286d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f403143a0>]}
[0m04:22:38.065760 [debug] [MainThread]: On master: ROLLBACK
[0m04:22:38.066657 [debug] [MainThread]: Using postgres connection "master"
[0m04:22:38.067098 [debug] [MainThread]: On master: BEGIN
[0m04:22:38.068150 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:22:38.068672 [debug] [MainThread]: On master: COMMIT
[0m04:22:38.069124 [debug] [MainThread]: Using postgres connection "master"
[0m04:22:38.069572 [debug] [MainThread]: On master: COMMIT
[0m04:22:38.070310 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:22:38.070785 [debug] [MainThread]: On master: Close
[0m04:22:38.072053 [info ] [MainThread]: Concurrency: 1 threads (target='mrt')
[0m04:22:38.072791 [info ] [MainThread]: 
[0m04:22:38.079699 [debug] [Thread-1 (]: Began running node model.ffd.test
[0m04:22:38.080636 [info ] [Thread-1 (]: 1 of 1 START table model mrt_stg.test .......................................... [RUN]
[0m04:22:38.082216 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.test"
[0m04:22:38.082854 [debug] [Thread-1 (]: Began compiling node model.ffd.test
[0m04:22:38.083434 [debug] [Thread-1 (]: Compiling model.ffd.test
[0m04:22:38.089359 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.test"
[0m04:22:38.090335 [debug] [Thread-1 (]: finished collecting timing info
[0m04:22:38.090700 [debug] [Thread-1 (]: Began executing node model.ffd.test
[0m04:22:38.215652 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.test"
[0m04:22:38.216766 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:22:38.217070 [debug] [Thread-1 (]: On model.ffd.test: BEGIN
[0m04:22:38.217344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:22:38.243300 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:22:38.243909 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:22:38.244325 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.test"} */


  create  table "ffd"."mrt_stg"."test__dbt_tmp"
  as (
    SELECT 1
UNION
SELECT 2
  );
[0m04:22:38.249782 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m04:22:38.272831 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:22:38.273332 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.test"} */
alter table "ffd"."mrt_stg"."test" rename to "test__dbt_backup"
[0m04:22:38.274695 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:22:38.281003 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:22:38.281459 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.test"} */
alter table "ffd"."mrt_stg"."test__dbt_tmp" rename to "test"
[0m04:22:38.283070 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:22:38.356476 [debug] [Thread-1 (]: On model.ffd.test: COMMIT
[0m04:22:38.357010 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:22:38.357291 [debug] [Thread-1 (]: On model.ffd.test: COMMIT
[0m04:22:38.369116 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:22:38.387755 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:22:38.388293 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.test"} */
drop table if exists "ffd"."mrt_stg"."test__dbt_backup" cascade
[0m04:22:38.403251 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m04:22:38.408056 [debug] [Thread-1 (]: finished collecting timing info
[0m04:22:38.408843 [debug] [Thread-1 (]: On model.ffd.test: Close
[0m04:22:38.410622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6c5ba0f-9479-4fc1-b916-eae1506b286d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f3f9872e0>]}
[0m04:22:38.412300 [info ] [Thread-1 (]: 1 of 1 OK created table model mrt_stg.test ..................................... [[32mSELECT 2[0m in 0.33s]
[0m04:22:38.414216 [debug] [Thread-1 (]: Finished running node model.ffd.test
[0m04:22:38.417005 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:22:38.417562 [debug] [MainThread]: Using postgres connection "master"
[0m04:22:38.417834 [debug] [MainThread]: On master: BEGIN
[0m04:22:38.418097 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:22:38.442432 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m04:22:38.443158 [debug] [MainThread]: On master: COMMIT
[0m04:22:38.443704 [debug] [MainThread]: Using postgres connection "master"
[0m04:22:38.444168 [debug] [MainThread]: On master: COMMIT
[0m04:22:38.445110 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:22:38.445677 [debug] [MainThread]: On master: Close
[0m04:22:38.447205 [info ] [MainThread]: 
[0m04:22:38.448339 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m04:22:38.449355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:22:38.449919 [debug] [MainThread]: Connection 'model.ffd.test' was properly closed.
[0m04:22:38.468613 [info ] [MainThread]: 
[0m04:22:38.469257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:22:38.469873 [info ] [MainThread]: 
[0m04:22:38.470404 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:22:38.471176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f4029e7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f402d0400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f402b6020>]}
[0m04:22:38.471764 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 04:26:36.341060 | c25c7a83-b1fd-4ab2-a157-fa88b8748501 ==============================
[0m04:26:36.341098 [info ] [MainThread]: Running with dbt=1.2.3
[0m04:26:36.342020 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:26:36.342441 [debug] [MainThread]: Tracking: tracking
[0m04:26:36.345607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46cb0f9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46cb0cd630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46cb0ce4a0>]}
[0m04:26:36.401829 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:26:36.402669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c25c7a83-b1fd-4ab2-a157-fa88b8748501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46cb0ce4a0>]}
[0m04:26:36.441988 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:26:36.449415 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:26:36.535805 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:26:36.540228 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:26:36.543901 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:26:36.564963 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:26:36.567002 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:26:36.568307 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:26:36.572180 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:26:36.576739 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:26:36.581868 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:26:36.608500 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:26:36.622877 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:26:36.640828 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:26:36.647361 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:26:36.650493 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:26:36.654467 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:26:36.657856 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:26:36.661992 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:26:36.665327 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:26:36.668497 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:26:36.671960 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:26:36.678541 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:26:36.681900 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:26:36.685954 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:26:36.689121 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:26:36.692881 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:26:36.701961 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:26:36.705679 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:26:36.708703 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:26:36.712590 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:26:36.716742 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:26:36.720026 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:26:36.723571 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:26:36.729648 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:26:36.737452 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:26:36.741862 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:26:36.746078 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:26:36.748069 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:26:36.750438 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:26:36.752952 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:26:36.760020 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:26:36.772167 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:26:36.812122 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:26:36.850379 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:26:36.855482 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:26:36.910940 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:26:36.958232 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:26:36.972932 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:26:37.003601 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:26:37.008501 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:26:37.058926 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:26:37.068278 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:26:37.086788 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:26:37.097665 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:26:37.104927 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:26:37.109030 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:26:37.125869 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:26:37.132260 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:26:37.138178 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:26:37.153246 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:26:37.176292 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:26:37.232723 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:26:37.277665 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:26:37.300045 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:26:37.332975 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:26:37.339553 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:26:37.384132 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:26:37.398468 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:26:37.407565 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:26:37.416009 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:26:38.172679 [debug] [MainThread]: 1699: static parser successfully parsed int/test.sql
[0m04:26:38.211283 [debug] [MainThread]: 1699: static parser successfully parsed stg copy/test.sql
[0m04:26:38.216370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c98defe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c98b6b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c98b6830>]}
[0m04:26:38.217011 [debug] [MainThread]: Flushing usage events
[0m04:26:38.474503 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "test".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("test").
  
  To fix this, change the name of one of these resources:
  - model.ffd.test (models/stg copy/test.sql)
  - model.ffd.test (models/int/test.sql)
[0m04:26:38.511220 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/dbt/main.py", line 129, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.10/site-packages/dbt/main.py", line 191, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.10/site-packages/dbt/main.py", line 238, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/runnable.py", line 451, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/runnable.py", line 159, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.10/site-packages/dbt/task/runnable.py", line 81, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/usr/local/lib/python3.10/site-packages/dbt/parser/manifest.py", line 219, in get_full_manifest
    manifest = loader.load()
  File "/usr/local/lib/python3.10/site-packages/dbt/parser/manifest.py", line 349, in load
    self.parse_project(
  File "/usr/local/lib/python3.10/site-packages/dbt/parser/manifest.py", line 473, in parse_project
    parser.parse_file(block)
  File "/usr/local/lib/python3.10/site-packages/dbt/parser/base.py", line 392, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.10/site-packages/dbt/parser/base.py", line 368, in parse_node
    self.add_result_node(block, result)
  File "/usr/local/lib/python3.10/site-packages/dbt/parser/base.py", line 350, in add_result_node
    self.manifest.add_node(block.file, node)
  File "/usr/local/lib/python3.10/site-packages/dbt/contracts/graph/manifest.py", line 1075, in add_node
    self.add_node_nofile(node)
  File "/usr/local/lib/python3.10/site-packages/dbt/contracts/graph/manifest.py", line 1071, in add_node_nofile
    _check_duplicates(node, self.nodes)
  File "/usr/local/lib/python3.10/site-packages/dbt/contracts/graph/manifest.py", line 1217, in _check_duplicates
    raise_duplicate_resource_name(value, src[value.unique_id])
  File "/usr/local/lib/python3.10/site-packages/dbt/exceptions.py", line 898, in raise_duplicate_resource_name
    raise_compiler_error(
  File "/usr/local/lib/python3.10/site-packages/dbt/exceptions.py", line 445, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two models with the name "test".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("test").
  
  To fix this, change the name of one of these resources:
  - model.ffd.test (models/stg copy/test.sql)
  - model.ffd.test (models/int/test.sql)



============================== 2024-02-03 04:27:12.147757 | 5456866a-336c-4dfc-8720-cf3d1fc113fc ==============================
[0m04:27:12.147838 [info ] [MainThread]: Running with dbt=1.2.3
[0m04:27:12.148771 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:27:12.149191 [debug] [MainThread]: Tracking: tracking
[0m04:27:12.153312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe63ecc9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe63ec9a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe63ec9a4a0>]}
[0m04:27:12.210061 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:27:12.210979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5456866a-336c-4dfc-8720-cf3d1fc113fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe63ec9a710>]}
[0m04:27:12.249825 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:27:12.257146 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:27:12.340689 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:27:12.345097 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:27:12.348549 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:27:12.370071 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:27:12.372213 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:27:12.373578 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:27:12.377427 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:27:12.382041 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:27:12.387150 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:27:12.414423 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:27:12.429223 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:27:12.447810 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:27:12.454672 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:27:12.457958 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:27:12.461938 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:27:12.465282 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:27:12.469094 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:27:12.472459 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:27:12.475655 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:27:12.478418 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:27:12.484431 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:27:12.487663 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:27:12.490978 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:27:12.493892 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:27:12.497169 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:27:12.504461 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:27:12.507930 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:27:12.510872 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:27:12.513925 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:27:12.517987 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:27:12.520593 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:27:12.524379 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:27:12.530199 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:27:12.538610 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:27:12.543306 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:27:12.547687 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:27:12.549782 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:27:12.552310 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:27:12.554893 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:27:12.562117 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:27:12.574398 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:27:12.612349 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:27:12.651547 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:27:12.656626 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:27:12.712958 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:27:12.761249 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:27:12.776453 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:27:12.807865 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:27:12.812782 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:27:12.863584 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:27:12.872940 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:27:12.890715 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:27:12.902127 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:27:12.909299 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:27:12.913261 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:27:12.930869 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:27:12.936976 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:27:12.942792 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:27:12.958083 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:27:12.980841 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:27:13.037394 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:27:13.083038 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:27:13.105722 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:27:13.137114 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:27:13.144028 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:27:13.189667 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:27:13.204294 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:27:13.213412 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:27:13.221972 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:27:13.992987 [debug] [MainThread]: 1699: static parser successfully parsed int/int__test.sql
[0m04:27:14.032000 [debug] [MainThread]: 1699: static parser successfully parsed stg copy/test.sql
[0m04:27:14.040385 [debug] [MainThread]: 1699: static parser successfully parsed stg/stg__test.sql
[0m04:27:14.132806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5456866a-336c-4dfc-8720-cf3d1fc113fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe63ec9ab00>]}
[0m04:27:14.149012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5456866a-336c-4dfc-8720-cf3d1fc113fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe63eca4610>]}
[0m04:27:14.149771 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:27:14.150295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5456866a-336c-4dfc-8720-cf3d1fc113fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe63ecca770>]}
[0m04:27:14.153168 [info ] [MainThread]: 
[0m04:27:14.154389 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:27:14.157015 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:27:14.191943 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:27:14.192464 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:27:14.192739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:27:14.224947 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
[0m04:27:14.229954 [debug] [ThreadPool]: On list_ffd: Close
[0m04:27:14.231904 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:27:14.237042 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:27:14.237517 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:27:14.237784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:27:14.265598 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
[0m04:27:14.268819 [debug] [ThreadPool]: On list_ffd: Close
[0m04:27:14.270742 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:27:14.277301 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:27:14.277766 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:27:14.278026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:27:14.307460 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
[0m04:27:14.312182 [debug] [ThreadPool]: On list_ffd: Close
[0m04:27:14.314142 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_mrt"
[0m04:27:14.315057 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_mrt"
[0m04:27:14.315596 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='ffd', schema='mrt', identifier=None)"
[0m04:27:14.332913 [debug] [ThreadPool]: Using postgres connection "create_ffd_mrt"
[0m04:27:14.333488 [debug] [ThreadPool]: On create_ffd_mrt: BEGIN
[0m04:27:14.333779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:27:14.356430 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m04:27:14.356974 [debug] [ThreadPool]: Using postgres connection "create_ffd_mrt"
[0m04:27:14.357273 [debug] [ThreadPool]: On create_ffd_mrt: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "create_ffd_mrt"} */
create schema if not exists "mrt"
[0m04:27:14.358531 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m04:27:14.360847 [debug] [ThreadPool]: On create_ffd_mrt: COMMIT
[0m04:27:14.361288 [debug] [ThreadPool]: Using postgres connection "create_ffd_mrt"
[0m04:27:14.361561 [debug] [ThreadPool]: On create_ffd_mrt: COMMIT
[0m04:27:14.374285 [debug] [ThreadPool]: SQL status: COMMIT in 0.01 seconds
[0m04:27:14.374950 [debug] [ThreadPool]: On create_ffd_mrt: Close
[0m04:27:14.377266 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_mrt_int"
[0m04:27:14.378758 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_mrt_int"
[0m04:27:14.379603 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='ffd', schema='mrt_int', identifier=None)"
[0m04:27:14.389699 [debug] [ThreadPool]: Using postgres connection "create_ffd_mrt_int"
[0m04:27:14.390292 [debug] [ThreadPool]: On create_ffd_mrt_int: BEGIN
[0m04:27:14.390652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:27:14.413915 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m04:27:14.414431 [debug] [ThreadPool]: Using postgres connection "create_ffd_mrt_int"
[0m04:27:14.414699 [debug] [ThreadPool]: On create_ffd_mrt_int: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "create_ffd_mrt_int"} */
create schema if not exists "mrt_int"
[0m04:27:14.415879 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m04:27:14.417795 [debug] [ThreadPool]: On create_ffd_mrt_int: COMMIT
[0m04:27:14.418145 [debug] [ThreadPool]: Using postgres connection "create_ffd_mrt_int"
[0m04:27:14.418408 [debug] [ThreadPool]: On create_ffd_mrt_int: COMMIT
[0m04:27:14.424435 [debug] [ThreadPool]: SQL status: COMMIT in 0.01 seconds
[0m04:27:14.425187 [debug] [ThreadPool]: On create_ffd_mrt_int: Close
[0m04:27:14.429428 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_mrt"
[0m04:27:14.452274 [debug] [ThreadPool]: Using postgres connection "list_ffd_mrt"
[0m04:27:14.452773 [debug] [ThreadPool]: On list_ffd_mrt: BEGIN
[0m04:27:14.453040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:27:14.478618 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m04:27:14.479138 [debug] [ThreadPool]: Using postgres connection "list_ffd_mrt"
[0m04:27:14.479407 [debug] [ThreadPool]: On list_ffd_mrt: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "list_ffd_mrt"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mrt'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mrt'
  
[0m04:27:14.488548 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m04:27:14.492976 [debug] [ThreadPool]: On list_ffd_mrt: ROLLBACK
[0m04:27:14.493956 [debug] [ThreadPool]: On list_ffd_mrt: Close
[0m04:27:14.495592 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_mrt_int"
[0m04:27:14.501850 [debug] [ThreadPool]: Using postgres connection "list_ffd_mrt_int"
[0m04:27:14.502325 [debug] [ThreadPool]: On list_ffd_mrt_int: BEGIN
[0m04:27:14.502584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:27:14.528392 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m04:27:14.529082 [debug] [ThreadPool]: Using postgres connection "list_ffd_mrt_int"
[0m04:27:14.529535 [debug] [ThreadPool]: On list_ffd_mrt_int: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "list_ffd_mrt_int"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mrt_int'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mrt_int'
  
[0m04:27:14.537901 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m04:27:14.542185 [debug] [ThreadPool]: On list_ffd_mrt_int: ROLLBACK
[0m04:27:14.543174 [debug] [ThreadPool]: On list_ffd_mrt_int: Close
[0m04:27:14.544718 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_mrt_stg"
[0m04:27:14.550312 [debug] [ThreadPool]: Using postgres connection "list_ffd_mrt_stg"
[0m04:27:14.550780 [debug] [ThreadPool]: On list_ffd_mrt_stg: BEGIN
[0m04:27:14.551043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:27:14.579108 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m04:27:14.579616 [debug] [ThreadPool]: Using postgres connection "list_ffd_mrt_stg"
[0m04:27:14.579911 [debug] [ThreadPool]: On list_ffd_mrt_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "list_ffd_mrt_stg"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mrt_stg'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mrt_stg'
  
[0m04:27:14.588789 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m04:27:14.593639 [debug] [ThreadPool]: On list_ffd_mrt_stg: ROLLBACK
[0m04:27:14.594717 [debug] [ThreadPool]: On list_ffd_mrt_stg: Close
[0m04:27:14.613249 [debug] [MainThread]: Using postgres connection "master"
[0m04:27:14.613895 [debug] [MainThread]: On master: BEGIN
[0m04:27:14.614293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:27:14.641601 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:27:14.642335 [debug] [MainThread]: Using postgres connection "master"
[0m04:27:14.642962 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:27:14.657532 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m04:27:14.662197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5456866a-336c-4dfc-8720-cf3d1fc113fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe63cd806d0>]}
[0m04:27:14.663231 [debug] [MainThread]: On master: ROLLBACK
[0m04:27:14.664228 [debug] [MainThread]: Using postgres connection "master"
[0m04:27:14.664719 [debug] [MainThread]: On master: BEGIN
[0m04:27:14.665780 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:27:14.666210 [debug] [MainThread]: On master: COMMIT
[0m04:27:14.666560 [debug] [MainThread]: Using postgres connection "master"
[0m04:27:14.666897 [debug] [MainThread]: On master: COMMIT
[0m04:27:14.667484 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:27:14.667911 [debug] [MainThread]: On master: Close
[0m04:27:14.668953 [info ] [MainThread]: Concurrency: 1 threads (target='mrt')
[0m04:27:14.669807 [info ] [MainThread]: 
[0m04:27:14.677782 [debug] [Thread-1 (]: Began running node model.ffd.int__test
[0m04:27:14.679117 [info ] [Thread-1 (]: 1 of 3 START table model mrt_int.int__test ..................................... [RUN]
[0m04:27:14.680639 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.int__test"
[0m04:27:14.681194 [debug] [Thread-1 (]: Began compiling node model.ffd.int__test
[0m04:27:14.681681 [debug] [Thread-1 (]: Compiling model.ffd.int__test
[0m04:27:14.687864 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.int__test"
[0m04:27:14.689248 [debug] [Thread-1 (]: finished collecting timing info
[0m04:27:14.689816 [debug] [Thread-1 (]: Began executing node model.ffd.int__test
[0m04:27:14.813379 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.int__test"
[0m04:27:14.814413 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:27:14.814703 [debug] [Thread-1 (]: On model.ffd.int__test: BEGIN
[0m04:27:14.814972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:27:14.843841 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:27:14.844493 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:27:14.845066 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.int__test"} */


  create  table "ffd"."mrt_int"."int__test__dbt_tmp"
  as (
    SELECT 3
UNION
SELECT 4
  );
[0m04:27:14.850514 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m04:27:14.873625 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:27:14.874150 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.int__test"} */
alter table "ffd"."mrt_int"."int__test__dbt_tmp" rename to "int__test"
[0m04:27:14.875400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:27:14.944040 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m04:27:14.944566 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:27:14.944835 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m04:27:14.950101 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:27:14.967763 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:27:14.968270 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.int__test"} */
drop table if exists "ffd"."mrt_int"."int__test__dbt_backup" cascade
[0m04:27:14.969135 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m04:27:14.971882 [debug] [Thread-1 (]: finished collecting timing info
[0m04:27:14.972364 [debug] [Thread-1 (]: On model.ffd.int__test: Close
[0m04:27:14.973455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5456866a-336c-4dfc-8720-cf3d1fc113fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe63c40ff10>]}
[0m04:27:14.974633 [info ] [Thread-1 (]: 1 of 3 OK created table model mrt_int.int__test ................................ [[32mSELECT 2[0m in 0.29s]
[0m04:27:14.975903 [debug] [Thread-1 (]: Finished running node model.ffd.int__test
[0m04:27:14.976657 [debug] [Thread-1 (]: Began running node model.ffd.stg__test
[0m04:27:14.977685 [info ] [Thread-1 (]: 2 of 3 START table model mrt_stg.stg__test ..................................... [RUN]
[0m04:27:14.978757 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.stg__test"
[0m04:27:14.979219 [debug] [Thread-1 (]: Began compiling node model.ffd.stg__test
[0m04:27:14.979542 [debug] [Thread-1 (]: Compiling model.ffd.stg__test
[0m04:27:14.983997 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.stg__test"
[0m04:27:14.984874 [debug] [Thread-1 (]: finished collecting timing info
[0m04:27:14.985222 [debug] [Thread-1 (]: Began executing node model.ffd.stg__test
[0m04:27:14.995272 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.stg__test"
[0m04:27:14.996195 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:27:14.996492 [debug] [Thread-1 (]: On model.ffd.stg__test: BEGIN
[0m04:27:14.996757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:27:15.024100 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:27:15.024661 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:27:15.025168 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.stg__test"} */


  create  table "ffd"."mrt_stg"."stg__test__dbt_tmp"
  as (
    SELECT 1
UNION
SELECT 2
  );
[0m04:27:15.030445 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m04:27:15.041025 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:27:15.041631 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."mrt_stg"."stg__test__dbt_tmp" rename to "stg__test"
[0m04:27:15.043017 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:27:15.047897 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m04:27:15.048360 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:27:15.048626 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m04:27:15.058369 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:27:15.065747 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:27:15.066441 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.stg__test"} */
drop table if exists "ffd"."mrt_stg"."stg__test__dbt_backup" cascade
[0m04:27:15.067697 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m04:27:15.070475 [debug] [Thread-1 (]: finished collecting timing info
[0m04:27:15.070934 [debug] [Thread-1 (]: On model.ffd.stg__test: Close
[0m04:27:15.072033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5456866a-336c-4dfc-8720-cf3d1fc113fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe63cda93c0>]}
[0m04:27:15.073091 [info ] [Thread-1 (]: 2 of 3 OK created table model mrt_stg.stg__test ................................ [[32mSELECT 2[0m in 0.09s]
[0m04:27:15.074215 [debug] [Thread-1 (]: Finished running node model.ffd.stg__test
[0m04:27:15.074944 [debug] [Thread-1 (]: Began running node model.ffd.test
[0m04:27:15.075827 [info ] [Thread-1 (]: 3 of 3 START view model mrt.test ............................................... [RUN]
[0m04:27:15.076950 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.test"
[0m04:27:15.077423 [debug] [Thread-1 (]: Began compiling node model.ffd.test
[0m04:27:15.077728 [debug] [Thread-1 (]: Compiling model.ffd.test
[0m04:27:15.082133 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.test"
[0m04:27:15.083077 [debug] [Thread-1 (]: finished collecting timing info
[0m04:27:15.083404 [debug] [Thread-1 (]: Began executing node model.ffd.test
[0m04:27:15.141547 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.test"
[0m04:27:15.142589 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:27:15.142881 [debug] [Thread-1 (]: On model.ffd.test: BEGIN
[0m04:27:15.143152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:27:15.167511 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m04:27:15.168177 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:27:15.168630 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.test"} */

  create view "ffd"."mrt"."test__dbt_tmp" as (
    SELECT 1
UNION
SELECT 2
  );
[0m04:27:15.174208 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m04:27:15.184143 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:27:15.184816 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.test"} */
alter table "ffd"."mrt"."test__dbt_tmp" rename to "test"
[0m04:27:15.186276 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:27:15.190164 [debug] [Thread-1 (]: On model.ffd.test: COMMIT
[0m04:27:15.190580 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:27:15.190843 [debug] [Thread-1 (]: On model.ffd.test: COMMIT
[0m04:27:15.200239 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:27:15.211256 [debug] [Thread-1 (]: Using postgres connection "model.ffd.test"
[0m04:27:15.211973 [debug] [Thread-1 (]: On model.ffd.test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.test"} */
drop view if exists "ffd"."mrt"."test__dbt_backup" cascade
[0m04:27:15.213204 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:27:15.215901 [debug] [Thread-1 (]: finished collecting timing info
[0m04:27:15.216393 [debug] [Thread-1 (]: On model.ffd.test: Close
[0m04:27:15.217482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5456866a-336c-4dfc-8720-cf3d1fc113fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe63c450f40>]}
[0m04:27:15.218496 [info ] [Thread-1 (]: 3 of 3 OK created view model mrt.test .......................................... [[32mCREATE VIEW[0m in 0.14s]
[0m04:27:15.219621 [debug] [Thread-1 (]: Finished running node model.ffd.test
[0m04:27:15.222341 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:27:15.223368 [debug] [MainThread]: Using postgres connection "master"
[0m04:27:15.223956 [debug] [MainThread]: On master: BEGIN
[0m04:27:15.224216 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:27:15.249201 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m04:27:15.249781 [debug] [MainThread]: On master: COMMIT
[0m04:27:15.250286 [debug] [MainThread]: Using postgres connection "master"
[0m04:27:15.250900 [debug] [MainThread]: On master: COMMIT
[0m04:27:15.251877 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:27:15.252208 [debug] [MainThread]: On master: Close
[0m04:27:15.253744 [info ] [MainThread]: 
[0m04:27:15.254679 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m04:27:15.255535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:27:15.256059 [debug] [MainThread]: Connection 'model.ffd.test' was properly closed.
[0m04:27:15.369268 [info ] [MainThread]: 
[0m04:27:15.370566 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:27:15.371240 [info ] [MainThread]: 
[0m04:27:15.371771 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m04:27:15.372575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe63edcd330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe63edcded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe63edcd210>]}
[0m04:27:15.373328 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 04:27:51.034667 | 3681a19f-594c-4a8b-8d5d-ae7bfa3cd1bf ==============================
[0m04:27:51.034706 [info ] [MainThread]: Running with dbt=1.2.3
[0m04:27:51.035616 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:27:51.036069 [debug] [MainThread]: Tracking: tracking
[0m04:27:51.039444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7012a3d1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7012a04670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7012a06320>]}
[0m04:27:51.136952 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m04:27:51.137489 [debug] [MainThread]: Partial parsing: deleted file: ffd://models/stg copy/test.sql
[0m04:27:51.165731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3681a19f-594c-4a8b-8d5d-ae7bfa3cd1bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70110880d0>]}
[0m04:27:51.181587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3681a19f-594c-4a8b-8d5d-ae7bfa3cd1bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701123f760>]}
[0m04:27:51.182331 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:27:51.182861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3681a19f-594c-4a8b-8d5d-ae7bfa3cd1bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7011228dc0>]}
[0m04:27:51.185649 [info ] [MainThread]: 
[0m04:27:51.186919 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:27:51.189405 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:27:51.226125 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:27:51.226635 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:27:51.226907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:27:51.259739 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.03 seconds
[0m04:27:51.265049 [debug] [ThreadPool]: On list_ffd: Close
[0m04:27:51.267165 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:27:51.272617 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:27:51.273083 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:27:51.273348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:27:51.300100 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.03 seconds
[0m04:27:51.304569 [debug] [ThreadPool]: On list_ffd: Close
[0m04:27:51.308354 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_mrt_stg"
[0m04:27:51.331614 [debug] [ThreadPool]: Using postgres connection "list_ffd_mrt_stg"
[0m04:27:51.332151 [debug] [ThreadPool]: On list_ffd_mrt_stg: BEGIN
[0m04:27:51.332419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:27:51.355512 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m04:27:51.356140 [debug] [ThreadPool]: Using postgres connection "list_ffd_mrt_stg"
[0m04:27:51.356653 [debug] [ThreadPool]: On list_ffd_mrt_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "list_ffd_mrt_stg"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mrt_stg'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mrt_stg'
  
[0m04:27:51.365869 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m04:27:51.370965 [debug] [ThreadPool]: On list_ffd_mrt_stg: ROLLBACK
[0m04:27:51.372072 [debug] [ThreadPool]: On list_ffd_mrt_stg: Close
[0m04:27:51.373738 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_mrt_int"
[0m04:27:51.380363 [debug] [ThreadPool]: Using postgres connection "list_ffd_mrt_int"
[0m04:27:51.380827 [debug] [ThreadPool]: On list_ffd_mrt_int: BEGIN
[0m04:27:51.381089 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:27:51.407721 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m04:27:51.408547 [debug] [ThreadPool]: Using postgres connection "list_ffd_mrt_int"
[0m04:27:51.409180 [debug] [ThreadPool]: On list_ffd_mrt_int: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "list_ffd_mrt_int"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mrt_int'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mrt_int'
  
[0m04:27:51.418311 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m04:27:51.423225 [debug] [ThreadPool]: On list_ffd_mrt_int: ROLLBACK
[0m04:27:51.424272 [debug] [ThreadPool]: On list_ffd_mrt_int: Close
[0m04:27:51.441860 [debug] [MainThread]: Using postgres connection "master"
[0m04:27:51.442469 [debug] [MainThread]: On master: BEGIN
[0m04:27:51.442813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:27:51.465848 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m04:27:51.466529 [debug] [MainThread]: Using postgres connection "master"
[0m04:27:51.467099 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:27:51.482696 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m04:27:51.487509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3681a19f-594c-4a8b-8d5d-ae7bfa3cd1bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7011077a00>]}
[0m04:27:51.488426 [debug] [MainThread]: On master: ROLLBACK
[0m04:27:51.489388 [debug] [MainThread]: Using postgres connection "master"
[0m04:27:51.489779 [debug] [MainThread]: On master: BEGIN
[0m04:27:51.491078 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:27:51.491601 [debug] [MainThread]: On master: COMMIT
[0m04:27:51.492054 [debug] [MainThread]: Using postgres connection "master"
[0m04:27:51.492317 [debug] [MainThread]: On master: COMMIT
[0m04:27:51.492764 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:27:51.493075 [debug] [MainThread]: On master: Close
[0m04:27:51.493918 [info ] [MainThread]: Concurrency: 1 threads (target='mrt')
[0m04:27:51.494646 [info ] [MainThread]: 
[0m04:27:51.501998 [debug] [Thread-1 (]: Began running node model.ffd.int__test
[0m04:27:51.503036 [info ] [Thread-1 (]: 1 of 2 START table model mrt_int.int__test ..................................... [RUN]
[0m04:27:51.504360 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.int__test"
[0m04:27:51.504956 [debug] [Thread-1 (]: Began compiling node model.ffd.int__test
[0m04:27:51.505559 [debug] [Thread-1 (]: Compiling model.ffd.int__test
[0m04:27:51.511587 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.int__test"
[0m04:27:51.512845 [debug] [Thread-1 (]: finished collecting timing info
[0m04:27:51.513376 [debug] [Thread-1 (]: Began executing node model.ffd.int__test
[0m04:27:51.639863 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.int__test"
[0m04:27:51.640901 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:27:51.641200 [debug] [Thread-1 (]: On model.ffd.int__test: BEGIN
[0m04:27:51.641472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:27:51.665446 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m04:27:51.666022 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:27:51.666650 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.int__test"} */


  create  table "ffd"."mrt_int"."int__test__dbt_tmp"
  as (
    SELECT 3
UNION
SELECT 4
  );
[0m04:27:51.672472 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m04:27:51.696056 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:27:51.696556 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.int__test"} */
alter table "ffd"."mrt_int"."int__test" rename to "int__test__dbt_backup"
[0m04:27:51.698312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:27:51.704831 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:27:51.705395 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.int__test"} */
alter table "ffd"."mrt_int"."int__test__dbt_tmp" rename to "int__test"
[0m04:27:51.707104 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:27:51.781464 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m04:27:51.781980 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:27:51.782251 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m04:27:51.790015 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:27:51.808616 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:27:51.809114 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.int__test"} */
drop table if exists "ffd"."mrt_int"."int__test__dbt_backup" cascade
[0m04:27:51.824195 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m04:27:51.827083 [debug] [Thread-1 (]: finished collecting timing info
[0m04:27:51.827527 [debug] [Thread-1 (]: On model.ffd.int__test: Close
[0m04:27:51.829052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3681a19f-594c-4a8b-8d5d-ae7bfa3cd1bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7011125270>]}
[0m04:27:51.830514 [info ] [Thread-1 (]: 1 of 2 OK created table model mrt_int.int__test ................................ [[32mSELECT 2[0m in 0.32s]
[0m04:27:51.832206 [debug] [Thread-1 (]: Finished running node model.ffd.int__test
[0m04:27:51.833110 [debug] [Thread-1 (]: Began running node model.ffd.stg__test
[0m04:27:51.834224 [info ] [Thread-1 (]: 2 of 2 START table model mrt_stg.stg__test ..................................... [RUN]
[0m04:27:51.835749 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.stg__test"
[0m04:27:51.836282 [debug] [Thread-1 (]: Began compiling node model.ffd.stg__test
[0m04:27:51.836581 [debug] [Thread-1 (]: Compiling model.ffd.stg__test
[0m04:27:51.840825 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.stg__test"
[0m04:27:51.841797 [debug] [Thread-1 (]: finished collecting timing info
[0m04:27:51.842136 [debug] [Thread-1 (]: Began executing node model.ffd.stg__test
[0m04:27:51.852341 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.stg__test"
[0m04:27:51.853307 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:27:51.853595 [debug] [Thread-1 (]: On model.ffd.stg__test: BEGIN
[0m04:27:51.853863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:27:51.881362 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:27:51.882051 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:27:51.882506 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.stg__test"} */


  create  table "ffd"."mrt_stg"."stg__test__dbt_tmp"
  as (
    SELECT 1
UNION
SELECT 2
  );
[0m04:27:51.887100 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m04:27:51.897473 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:27:51.898144 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."mrt_stg"."stg__test" rename to "stg__test__dbt_backup"
[0m04:27:51.899576 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:27:51.905735 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:27:51.906195 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."mrt_stg"."stg__test__dbt_tmp" rename to "stg__test"
[0m04:27:51.907547 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:27:51.914251 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m04:27:51.914778 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:27:51.915143 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m04:27:51.923479 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:27:51.933744 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:27:51.934223 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "mrt", "node_id": "model.ffd.stg__test"} */
drop table if exists "ffd"."mrt_stg"."stg__test__dbt_backup" cascade
[0m04:27:51.948944 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m04:27:51.951759 [debug] [Thread-1 (]: finished collecting timing info
[0m04:27:51.952532 [debug] [Thread-1 (]: On model.ffd.stg__test: Close
[0m04:27:51.954081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3681a19f-594c-4a8b-8d5d-ae7bfa3cd1bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f700af1a080>]}
[0m04:27:51.955453 [info ] [Thread-1 (]: 2 of 2 OK created table model mrt_stg.stg__test ................................ [[32mSELECT 2[0m in 0.12s]
[0m04:27:51.957085 [debug] [Thread-1 (]: Finished running node model.ffd.stg__test
[0m04:27:51.960551 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:27:51.961264 [debug] [MainThread]: Using postgres connection "master"
[0m04:27:51.961663 [debug] [MainThread]: On master: BEGIN
[0m04:27:51.962053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:27:51.988053 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:27:51.988954 [debug] [MainThread]: On master: COMMIT
[0m04:27:51.989577 [debug] [MainThread]: Using postgres connection "master"
[0m04:27:51.990194 [debug] [MainThread]: On master: COMMIT
[0m04:27:51.991205 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:27:51.991935 [debug] [MainThread]: On master: Close
[0m04:27:51.993495 [info ] [MainThread]: 
[0m04:27:51.994453 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m04:27:51.995322 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:27:51.995875 [debug] [MainThread]: Connection 'model.ffd.stg__test' was properly closed.
[0m04:27:52.013604 [info ] [MainThread]: 
[0m04:27:52.014240 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:27:52.014868 [info ] [MainThread]: 
[0m04:27:52.015368 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:27:52.016131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f700af1a200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70110e5ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70110e63e0>]}
[0m04:27:52.016734 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 04:34:34.265054 | 357fb4c4-2c3f-4d14-8972-1b1743e1719a ==============================
[0m04:34:34.265096 [info ] [MainThread]: Running with dbt=1.2.3
[0m04:34:34.266004 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:34:34.266409 [debug] [MainThread]: Tracking: tracking
[0m04:34:34.270516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0879b15180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0879aec0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0879aed8d0>]}
[0m04:34:34.327116 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:34:34.327993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '357fb4c4-2c3f-4d14-8972-1b1743e1719a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0879af9750>]}
[0m04:34:34.366406 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:34:34.373937 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:34:34.456778 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:34:34.461111 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:34:34.464810 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:34:34.486796 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:34:34.489047 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:34:34.490516 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:34:34.495129 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:34:34.500387 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:34:34.506103 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:34:34.533590 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:34:34.548258 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:34:34.566749 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:34:34.573373 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:34:34.576331 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:34:34.580261 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:34:34.583845 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:34:34.587883 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:34:34.591236 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:34:34.594506 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:34:34.597353 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:34:34.602963 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:34:34.606247 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:34:34.609773 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:34:34.612715 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:34:34.616044 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:34:34.623440 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:34:34.627102 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:34:34.630029 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:34:34.632884 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:34:34.636667 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:34:34.639075 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:34:34.642682 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:34:34.648086 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:34:34.656416 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:34:34.661218 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:34:34.665587 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:34:34.667601 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:34:34.670087 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:34:34.672714 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:34:34.679968 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:34:34.692616 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:34:34.730471 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:34:34.770199 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:34:34.775475 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:34:34.831657 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:34:34.880124 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:34:34.895062 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:34:34.926874 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:34:34.932027 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:34:34.982834 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:34:34.992226 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:34:35.010874 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:34:35.024008 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:34:35.033879 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:34:35.038952 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:34:35.060779 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:34:35.068454 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:34:35.075350 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:34:35.092905 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:34:35.118569 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:34:35.185982 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:34:35.242380 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:34:35.268029 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:34:35.304950 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:34:35.312788 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:34:35.366532 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:34:35.385633 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:34:35.395841 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:34:35.406985 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:34:36.208938 [debug] [MainThread]: 1699: static parser successfully parsed int/int__test.sql
[0m04:34:36.247993 [debug] [MainThread]: 1699: static parser successfully parsed stg/stg__test.sql
[0m04:34:36.342192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '357fb4c4-2c3f-4d14-8972-1b1743e1719a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0879b14340>]}
[0m04:34:36.359223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '357fb4c4-2c3f-4d14-8972-1b1743e1719a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0879afa3b0>]}
[0m04:34:36.360072 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:34:36.360618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '357fb4c4-2c3f-4d14-8972-1b1743e1719a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0879aec0d0>]}
[0m04:34:36.363331 [info ] [MainThread]: 
[0m04:34:36.364584 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:34:36.366931 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:34:36.401865 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:34:36.402381 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:34:36.402654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:34:36.429681 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.03 seconds
[0m04:34:36.433842 [debug] [ThreadPool]: On list_ffd: Close
[0m04:34:36.435758 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:34:36.442129 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:34:36.442599 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:34:36.442865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:36.466398 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.02 seconds
[0m04:34:36.470259 [debug] [ThreadPool]: On list_ffd: Close
[0m04:34:36.472863 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_stg_int"
[0m04:34:36.474162 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_stg_int"
[0m04:34:36.474955 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='ffd', schema='stg_int', identifier=None)"
[0m04:34:36.490891 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg_int"
[0m04:34:36.491398 [debug] [ThreadPool]: On create_ffd_stg_int: BEGIN
[0m04:34:36.491668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:36.516209 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m04:34:36.516902 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg_int"
[0m04:34:36.517352 [debug] [ThreadPool]: On create_ffd_stg_int: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "create_ffd_stg_int"} */
create schema if not exists "stg_int"
[0m04:34:36.518835 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m04:34:36.521819 [debug] [ThreadPool]: On create_ffd_stg_int: COMMIT
[0m04:34:36.522376 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg_int"
[0m04:34:36.522825 [debug] [ThreadPool]: On create_ffd_stg_int: COMMIT
[0m04:34:36.534361 [debug] [ThreadPool]: SQL status: COMMIT in 0.01 seconds
[0m04:34:36.535179 [debug] [ThreadPool]: On create_ffd_stg_int: Close
[0m04:34:36.537503 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_stg_stg"
[0m04:34:36.539038 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_stg_stg"
[0m04:34:36.539961 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='ffd', schema='stg_stg', identifier=None)"
[0m04:34:36.547467 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg_stg"
[0m04:34:36.547979 [debug] [ThreadPool]: On create_ffd_stg_stg: BEGIN
[0m04:34:36.548252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:36.572916 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m04:34:36.573485 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg_stg"
[0m04:34:36.574023 [debug] [ThreadPool]: On create_ffd_stg_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "create_ffd_stg_stg"} */
create schema if not exists "stg_stg"
[0m04:34:36.575658 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m04:34:36.579667 [debug] [ThreadPool]: On create_ffd_stg_stg: COMMIT
[0m04:34:36.580293 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg_stg"
[0m04:34:36.580907 [debug] [ThreadPool]: On create_ffd_stg_stg: COMMIT
[0m04:34:36.592421 [debug] [ThreadPool]: SQL status: COMMIT in 0.01 seconds
[0m04:34:36.593022 [debug] [ThreadPool]: On create_ffd_stg_stg: Close
[0m04:34:36.596215 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_stg_int"
[0m04:34:36.619675 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_int"
[0m04:34:36.620199 [debug] [ThreadPool]: On list_ffd_stg_int: BEGIN
[0m04:34:36.620469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:36.649132 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m04:34:36.649690 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_int"
[0m04:34:36.650316 [debug] [ThreadPool]: On list_ffd_stg_int: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd_stg_int"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg_int'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg_int'
  
[0m04:34:36.659184 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m04:34:36.664604 [debug] [ThreadPool]: On list_ffd_stg_int: ROLLBACK
[0m04:34:36.665755 [debug] [ThreadPool]: On list_ffd_stg_int: Close
[0m04:34:36.667553 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_stg_stg"
[0m04:34:36.672726 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_stg"
[0m04:34:36.673198 [debug] [ThreadPool]: On list_ffd_stg_stg: BEGIN
[0m04:34:36.673462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:34:36.700103 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m04:34:36.700880 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_stg"
[0m04:34:36.701502 [debug] [ThreadPool]: On list_ffd_stg_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd_stg_stg"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg_stg'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg_stg'
  
[0m04:34:36.711077 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m04:34:36.715761 [debug] [ThreadPool]: On list_ffd_stg_stg: ROLLBACK
[0m04:34:36.716954 [debug] [ThreadPool]: On list_ffd_stg_stg: Close
[0m04:34:36.731474 [debug] [MainThread]: Using postgres connection "master"
[0m04:34:36.732168 [debug] [MainThread]: On master: BEGIN
[0m04:34:36.732485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:34:36.757062 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m04:34:36.757777 [debug] [MainThread]: Using postgres connection "master"
[0m04:34:36.758227 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:34:36.770935 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m04:34:36.775523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '357fb4c4-2c3f-4d14-8972-1b1743e1719a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08782d1390>]}
[0m04:34:36.776662 [debug] [MainThread]: On master: ROLLBACK
[0m04:34:36.777711 [debug] [MainThread]: Using postgres connection "master"
[0m04:34:36.778103 [debug] [MainThread]: On master: BEGIN
[0m04:34:36.778963 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:34:36.779388 [debug] [MainThread]: On master: COMMIT
[0m04:34:36.779735 [debug] [MainThread]: Using postgres connection "master"
[0m04:34:36.780116 [debug] [MainThread]: On master: COMMIT
[0m04:34:36.780710 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:34:36.781109 [debug] [MainThread]: On master: Close
[0m04:34:36.782144 [info ] [MainThread]: Concurrency: 1 threads (target='stg')
[0m04:34:36.782996 [info ] [MainThread]: 
[0m04:34:36.790873 [debug] [Thread-1 (]: Began running node model.ffd.int__test
[0m04:34:36.791862 [info ] [Thread-1 (]: 1 of 2 START table model stg_int.int__test ..................................... [RUN]
[0m04:34:36.793055 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.int__test"
[0m04:34:36.793534 [debug] [Thread-1 (]: Began compiling node model.ffd.int__test
[0m04:34:36.793977 [debug] [Thread-1 (]: Compiling model.ffd.int__test
[0m04:34:36.799251 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.int__test"
[0m04:34:36.800593 [debug] [Thread-1 (]: finished collecting timing info
[0m04:34:36.801231 [debug] [Thread-1 (]: Began executing node model.ffd.int__test
[0m04:34:36.925892 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.int__test"
[0m04:34:36.926928 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:34:36.927221 [debug] [Thread-1 (]: On model.ffd.int__test: BEGIN
[0m04:34:36.927495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:36.953130 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:34:36.953710 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:34:36.954295 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */


  create  table "ffd"."stg_int"."int__test__dbt_tmp"
  as (
    SELECT 3
UNION
SELECT 4
  );
[0m04:34:36.960055 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m04:34:36.984319 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:34:36.984819 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
alter table "ffd"."stg_int"."int__test__dbt_tmp" rename to "int__test"
[0m04:34:36.986346 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:34:37.053934 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m04:34:37.054452 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:34:37.054720 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m04:34:37.059879 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:34:37.081300 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:34:37.081790 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
drop table if exists "ffd"."stg_int"."int__test__dbt_backup" cascade
[0m04:34:37.082869 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m04:34:37.085597 [debug] [Thread-1 (]: finished collecting timing info
[0m04:34:37.086069 [debug] [Thread-1 (]: On model.ffd.int__test: Close
[0m04:34:37.087129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '357fb4c4-2c3f-4d14-8972-1b1743e1719a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0875847c10>]}
[0m04:34:37.088186 [info ] [Thread-1 (]: 1 of 2 OK created table model stg_int.int__test ................................ [[32mSELECT 2[0m in 0.29s]
[0m04:34:37.089359 [debug] [Thread-1 (]: Finished running node model.ffd.int__test
[0m04:34:37.090036 [debug] [Thread-1 (]: Began running node model.ffd.stg__test
[0m04:34:37.090855 [info ] [Thread-1 (]: 2 of 2 START table model stg_stg.stg__test ..................................... [RUN]
[0m04:34:37.092019 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.stg__test"
[0m04:34:37.092505 [debug] [Thread-1 (]: Began compiling node model.ffd.stg__test
[0m04:34:37.092828 [debug] [Thread-1 (]: Compiling model.ffd.stg__test
[0m04:34:37.097358 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.stg__test"
[0m04:34:37.098320 [debug] [Thread-1 (]: finished collecting timing info
[0m04:34:37.098646 [debug] [Thread-1 (]: Began executing node model.ffd.stg__test
[0m04:34:37.108596 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.stg__test"
[0m04:34:37.109570 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:34:37.109859 [debug] [Thread-1 (]: On model.ffd.stg__test: BEGIN
[0m04:34:37.110125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:34:37.137373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:34:37.138164 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:34:37.138792 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */


  create  table "ffd"."stg_stg"."stg__test__dbt_tmp"
  as (
    SELECT 1
UNION
SELECT 2
  );
[0m04:34:37.143619 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m04:34:37.153281 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:34:37.153891 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."stg_stg"."stg__test__dbt_tmp" rename to "stg__test"
[0m04:34:37.155438 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:34:37.161441 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m04:34:37.161975 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:34:37.162328 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m04:34:37.176542 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:34:37.183712 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:34:37.184398 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
drop table if exists "ffd"."stg_stg"."stg__test__dbt_backup" cascade
[0m04:34:37.185659 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m04:34:37.189168 [debug] [Thread-1 (]: finished collecting timing info
[0m04:34:37.189699 [debug] [Thread-1 (]: On model.ffd.stg__test: Close
[0m04:34:37.190757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '357fb4c4-2c3f-4d14-8972-1b1743e1719a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08779c3b80>]}
[0m04:34:37.191728 [info ] [Thread-1 (]: 2 of 2 OK created table model stg_stg.stg__test ................................ [[32mSELECT 2[0m in 0.10s]
[0m04:34:37.192923 [debug] [Thread-1 (]: Finished running node model.ffd.stg__test
[0m04:34:37.195440 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:34:37.196054 [debug] [MainThread]: Using postgres connection "master"
[0m04:34:37.196371 [debug] [MainThread]: On master: BEGIN
[0m04:34:37.196719 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:34:37.222193 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:34:37.222873 [debug] [MainThread]: On master: COMMIT
[0m04:34:37.223507 [debug] [MainThread]: Using postgres connection "master"
[0m04:34:37.224030 [debug] [MainThread]: On master: COMMIT
[0m04:34:37.224618 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:34:37.225101 [debug] [MainThread]: On master: Close
[0m04:34:37.226636 [info ] [MainThread]: 
[0m04:34:37.227582 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m04:34:37.228471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:34:37.228971 [debug] [MainThread]: Connection 'model.ffd.stg__test' was properly closed.
[0m04:34:37.245799 [info ] [MainThread]: 
[0m04:34:37.246435 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:34:37.247062 [info ] [MainThread]: 
[0m04:34:37.247559 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:34:37.248352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0877952da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08782e1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f087796e8c0>]}
[0m04:34:37.248947 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 04:46:51.678113 | bc44bcb7-75a6-4e02-8406-9ad5d1c4e3dd ==============================
[0m04:46:51.678153 [info ] [MainThread]: Running with dbt=1.2.3
[0m04:46:51.679069 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'fail_fast': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:46:51.679506 [debug] [MainThread]: Tracking: tracking
[0m04:46:51.683090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64528d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64526d060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff645262650>]}
[0m04:46:51.740137 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:46:51.741036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc44bcb7-75a6-4e02-8406-9ad5d1c4e3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff645262650>]}
[0m04:46:51.779611 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:46:51.787092 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:46:51.874985 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:46:51.879100 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:46:51.882485 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:46:51.903486 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:46:51.905493 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:46:51.906783 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:46:51.910658 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:46:51.915294 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:46:51.920500 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:46:51.947927 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:46:51.962627 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:46:51.981215 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:46:51.987892 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:46:51.990684 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:46:51.994785 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:46:51.998232 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:46:52.002129 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:46:52.005515 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:46:52.008765 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:46:52.011590 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:46:52.017276 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:46:52.020756 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:46:52.024327 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:46:52.027376 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:46:52.030678 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:46:52.038036 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:46:52.041407 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:46:52.044200 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:46:52.047027 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:46:52.050831 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:46:52.053255 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:46:52.056445 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:46:52.061960 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:46:52.069731 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:46:52.074365 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:46:52.078787 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:46:52.080923 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:46:52.083608 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:46:52.086429 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:46:52.093787 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:46:52.106070 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:46:52.144210 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:46:52.184674 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:46:52.189958 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:46:52.247405 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:46:52.296413 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:46:52.311500 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:46:52.343126 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:46:52.348568 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:46:52.399897 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:46:52.409585 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:46:52.428043 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:46:52.439514 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:46:52.446895 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:46:52.450880 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:46:52.468141 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:46:52.474167 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:46:52.479907 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:46:52.495241 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:46:52.517762 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:46:52.575477 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:46:52.620556 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:46:52.643404 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:46:52.676637 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:46:52.683534 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:46:52.728383 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:46:52.742934 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:46:52.752135 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:46:52.760763 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:46:53.526769 [debug] [MainThread]: 1699: static parser successfully parsed int/int__test.sql
[0m04:46:53.565281 [debug] [MainThread]: 1699: static parser successfully parsed stg/stg__test.sql
[0m04:46:53.666326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc44bcb7-75a6-4e02-8406-9ad5d1c4e3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64516bfa0>]}
[0m04:46:53.682202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc44bcb7-75a6-4e02-8406-9ad5d1c4e3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff645313040>]}
[0m04:46:53.682960 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:46:53.683487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc44bcb7-75a6-4e02-8406-9ad5d1c4e3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64526efe0>]}
[0m04:46:53.686249 [info ] [MainThread]: 
[0m04:46:53.687471 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:46:53.689800 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:46:53.725406 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:46:53.725920 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:46:53.726194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:46:53.755321 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.03 seconds
[0m04:46:53.760436 [debug] [ThreadPool]: On list_ffd: Close
[0m04:46:53.762597 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:46:53.768171 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:46:53.768641 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:46:53.768905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:46:53.797589 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.03 seconds
[0m04:46:53.800856 [debug] [ThreadPool]: On list_ffd: Close
[0m04:46:53.804555 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_stg_int"
[0m04:46:53.827670 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_int"
[0m04:46:53.828219 [debug] [ThreadPool]: On list_ffd_stg_int: BEGIN
[0m04:46:53.828495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:46:53.852103 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m04:46:53.852868 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_int"
[0m04:46:53.853495 [debug] [ThreadPool]: On list_ffd_stg_int: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "connection_name": "list_ffd_stg_int"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg_int'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg_int'
  
[0m04:46:53.862615 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m04:46:53.867662 [debug] [ThreadPool]: On list_ffd_stg_int: ROLLBACK
[0m04:46:53.868774 [debug] [ThreadPool]: On list_ffd_stg_int: Close
[0m04:46:53.870449 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_stg_stg"
[0m04:46:53.877215 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_stg"
[0m04:46:53.877691 [debug] [ThreadPool]: On list_ffd_stg_stg: BEGIN
[0m04:46:53.877958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:46:53.904894 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m04:46:53.905407 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_stg"
[0m04:46:53.905677 [debug] [ThreadPool]: On list_ffd_stg_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "connection_name": "list_ffd_stg_stg"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg_stg'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg_stg'
  
[0m04:46:53.913429 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m04:46:53.918415 [debug] [ThreadPool]: On list_ffd_stg_stg: ROLLBACK
[0m04:46:53.919526 [debug] [ThreadPool]: On list_ffd_stg_stg: Close
[0m04:46:53.937684 [debug] [MainThread]: Using postgres connection "master"
[0m04:46:53.938189 [debug] [MainThread]: On master: BEGIN
[0m04:46:53.938464 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:46:53.966276 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:46:53.966795 [debug] [MainThread]: Using postgres connection "master"
[0m04:46:53.967066 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:46:53.980964 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m04:46:53.985347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc44bcb7-75a6-4e02-8406-9ad5d1c4e3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6451bb1c0>]}
[0m04:46:53.986381 [debug] [MainThread]: On master: ROLLBACK
[0m04:46:53.987404 [debug] [MainThread]: Using postgres connection "master"
[0m04:46:53.987987 [debug] [MainThread]: On master: BEGIN
[0m04:46:53.989186 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:46:53.989729 [debug] [MainThread]: On master: COMMIT
[0m04:46:53.990255 [debug] [MainThread]: Using postgres connection "master"
[0m04:46:53.990770 [debug] [MainThread]: On master: COMMIT
[0m04:46:53.991552 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:46:53.992020 [debug] [MainThread]: On master: Close
[0m04:46:53.992857 [info ] [MainThread]: Concurrency: 1 threads (target='ffd')
[0m04:46:53.993551 [info ] [MainThread]: 
[0m04:46:54.001738 [debug] [Thread-1 (]: Began running node model.ffd.int__test
[0m04:46:54.002695 [info ] [Thread-1 (]: 1 of 2 START table model stg_int.int__test ..................................... [RUN]
[0m04:46:54.004139 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.int__test"
[0m04:46:54.004622 [debug] [Thread-1 (]: Began compiling node model.ffd.int__test
[0m04:46:54.004999 [debug] [Thread-1 (]: Compiling model.ffd.int__test
[0m04:46:54.010767 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.int__test"
[0m04:46:54.012042 [debug] [Thread-1 (]: finished collecting timing info
[0m04:46:54.012618 [debug] [Thread-1 (]: Began executing node model.ffd.int__test
[0m04:46:54.137031 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.int__test"
[0m04:46:54.138054 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:46:54.138386 [debug] [Thread-1 (]: On model.ffd.int__test: BEGIN
[0m04:46:54.138653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:54.163265 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m04:46:54.163851 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:46:54.164256 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.int__test"} */


  create  table "ffd"."stg_int"."int__test__dbt_tmp"
  as (
    SELECT 3
UNION
SELECT 4
  );
[0m04:46:54.169474 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m04:46:54.192287 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:46:54.192787 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.int__test"} */
alter table "ffd"."stg_int"."int__test" rename to "int__test__dbt_backup"
[0m04:46:54.194081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:46:54.200411 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:46:54.200882 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.int__test"} */
alter table "ffd"."stg_int"."int__test__dbt_tmp" rename to "int__test"
[0m04:46:54.202080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:46:54.274267 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m04:46:54.274774 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:46:54.275047 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m04:46:54.286582 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:46:54.306068 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:46:54.306562 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.int__test"} */
drop table if exists "ffd"."stg_int"."int__test__dbt_backup" cascade
[0m04:46:54.320654 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m04:46:54.323574 [debug] [Thread-1 (]: finished collecting timing info
[0m04:46:54.324243 [debug] [Thread-1 (]: On model.ffd.int__test: Close
[0m04:46:54.325849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc44bcb7-75a6-4e02-8406-9ad5d1c4e3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff64486b430>]}
[0m04:46:54.327271 [info ] [Thread-1 (]: 1 of 2 OK created table model stg_int.int__test ................................ [[32mSELECT 2[0m in 0.32s]
[0m04:46:54.329014 [debug] [Thread-1 (]: Finished running node model.ffd.int__test
[0m04:46:54.329980 [debug] [Thread-1 (]: Began running node model.ffd.stg__test
[0m04:46:54.331237 [info ] [Thread-1 (]: 2 of 2 START table model stg_stg.stg__test ..................................... [RUN]
[0m04:46:54.332584 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.stg__test"
[0m04:46:54.333019 [debug] [Thread-1 (]: Began compiling node model.ffd.stg__test
[0m04:46:54.333315 [debug] [Thread-1 (]: Compiling model.ffd.stg__test
[0m04:46:54.337767 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.stg__test"
[0m04:46:54.338733 [debug] [Thread-1 (]: finished collecting timing info
[0m04:46:54.339102 [debug] [Thread-1 (]: Began executing node model.ffd.stg__test
[0m04:46:54.353683 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.stg__test"
[0m04:46:54.354685 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:46:54.355040 [debug] [Thread-1 (]: On model.ffd.stg__test: BEGIN
[0m04:46:54.355307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:46:54.384474 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:46:54.384998 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:46:54.385269 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.stg__test"} */


  create  table "ffd"."stg_stg"."stg__test__dbt_tmp"
  as (
    SELECT 1
UNION
SELECT 2
  );
[0m04:46:54.389999 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m04:46:54.401026 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:46:54.401587 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."stg_stg"."stg__test" rename to "stg__test__dbt_backup"
[0m04:46:54.403130 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:46:54.411042 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:46:54.411603 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."stg_stg"."stg__test__dbt_tmp" rename to "stg__test"
[0m04:46:54.413125 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:46:54.419868 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m04:46:54.420405 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:46:54.420755 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m04:46:54.436797 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m04:46:54.444154 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:46:54.444808 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.stg__test"} */
drop table if exists "ffd"."stg_stg"."stg__test__dbt_backup" cascade
[0m04:46:54.454112 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m04:46:54.458448 [debug] [Thread-1 (]: finished collecting timing info
[0m04:46:54.459128 [debug] [Thread-1 (]: On model.ffd.stg__test: Close
[0m04:46:54.460738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc44bcb7-75a6-4e02-8406-9ad5d1c4e3dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6448765f0>]}
[0m04:46:54.462127 [info ] [Thread-1 (]: 2 of 2 OK created table model stg_stg.stg__test ................................ [[32mSELECT 2[0m in 0.13s]
[0m04:46:54.463720 [debug] [Thread-1 (]: Finished running node model.ffd.stg__test
[0m04:46:54.466449 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:46:54.467149 [debug] [MainThread]: Using postgres connection "master"
[0m04:46:54.467553 [debug] [MainThread]: On master: BEGIN
[0m04:46:54.467856 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:46:54.493784 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:46:54.494564 [debug] [MainThread]: On master: COMMIT
[0m04:46:54.495199 [debug] [MainThread]: Using postgres connection "master"
[0m04:46:54.495895 [debug] [MainThread]: On master: COMMIT
[0m04:46:54.496609 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:46:54.497117 [debug] [MainThread]: On master: Close
[0m04:46:54.498536 [info ] [MainThread]: 
[0m04:46:54.499604 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m04:46:54.500732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:46:54.501276 [debug] [MainThread]: Connection 'model.ffd.stg__test' was properly closed.
[0m04:46:54.519327 [info ] [MainThread]: 
[0m04:46:54.520016 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:46:54.520653 [info ] [MainThread]: 
[0m04:46:54.521144 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:46:54.521879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6448d6110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6448d5c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff644875d50>]}
[0m04:46:54.522455 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 04:49:17.086077 | 9e72c187-a445-4591-ae07-24889ad851b6 ==============================
[0m04:49:17.086115 [info ] [MainThread]: Running with dbt=1.2.3
[0m04:49:17.087013 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'fail_fast': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:49:17.087447 [debug] [MainThread]: Tracking: tracking
[0m04:49:17.092505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec802f9180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec802bbc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec802bbaf0>]}
[0m04:49:17.149853 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:49:17.150634 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:49:17.151202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9e72c187-a445-4591-ae07-24889ad851b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec802ca200>]}
[0m04:49:17.191958 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:49:17.199390 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:49:17.288026 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:49:17.292081 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:49:17.295447 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:49:17.316775 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:49:17.318676 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:49:17.319946 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:49:17.323772 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:49:17.328412 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:49:17.333691 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:49:17.361303 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:49:17.376610 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:49:17.395469 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:49:17.402196 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:49:17.405065 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:49:17.408941 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:49:17.412263 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:49:17.416140 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:49:17.419443 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:49:17.422656 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:49:17.425664 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:49:17.431793 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:49:17.435397 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:49:17.439383 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:49:17.442635 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:49:17.446148 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:49:17.453776 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:49:17.457153 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:49:17.459930 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:49:17.462713 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:49:17.466548 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:49:17.468959 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:49:17.472114 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:49:17.477211 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:49:17.484813 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:49:17.489403 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:49:17.493757 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:49:17.495831 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:49:17.498314 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:49:17.500894 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:49:17.508146 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:49:17.520968 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:49:17.558290 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:49:17.597464 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:49:17.602600 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:49:17.659268 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:49:17.707498 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:49:17.722164 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:49:17.753407 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:49:17.758333 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:49:17.809137 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:49:17.818474 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:49:17.837105 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:49:17.848752 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:49:17.856122 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:49:17.860148 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:49:17.878126 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:49:17.883924 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:49:17.889952 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:49:17.905182 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:49:17.928212 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:49:17.985741 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:49:18.031583 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:49:18.058901 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:49:18.090722 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:49:18.097596 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:49:18.142017 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:49:18.156716 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:49:18.165969 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:49:18.174444 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:49:18.966780 [debug] [MainThread]: 1699: static parser successfully parsed int/int__test.sql
[0m04:49:19.015746 [debug] [MainThread]: 1699: static parser successfully parsed stg/stg__test.sql
[0m04:49:19.126312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e72c187-a445-4591-ae07-24889ad851b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec7ea36e30>]}
[0m04:49:19.143532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e72c187-a445-4591-ae07-24889ad851b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec802d4550>]}
[0m04:49:19.144440 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:49:19.145096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e72c187-a445-4591-ae07-24889ad851b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec7ea36e30>]}
[0m04:49:19.148015 [info ] [MainThread]: 
[0m04:49:19.149435 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:49:19.151877 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:49:19.184835 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:49:19.185348 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:49:19.185621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:49:19.214071 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.03 seconds
[0m04:49:19.218199 [debug] [ThreadPool]: On list_ffd: Close
[0m04:49:19.220387 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:49:19.226751 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:49:19.227218 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:49:19.227481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:49:19.252587 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.03 seconds
[0m04:49:19.255433 [debug] [ThreadPool]: On list_ffd: Close
[0m04:49:19.257699 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_stg"
[0m04:49:19.259013 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_stg"
[0m04:49:19.259875 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='ffd', schema='stg', identifier=None)"
[0m04:49:19.276905 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg"
[0m04:49:19.277401 [debug] [ThreadPool]: On create_ffd_stg: BEGIN
[0m04:49:19.277668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:49:19.306568 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m04:49:19.307071 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg"
[0m04:49:19.307342 [debug] [ThreadPool]: On create_ffd_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "connection_name": "create_ffd_stg"} */
create schema if not exists "stg"
[0m04:49:19.308667 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m04:49:19.310631 [debug] [ThreadPool]: On create_ffd_stg: COMMIT
[0m04:49:19.310963 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg"
[0m04:49:19.311229 [debug] [ThreadPool]: On create_ffd_stg: COMMIT
[0m04:49:19.319735 [debug] [ThreadPool]: SQL status: COMMIT in 0.01 seconds
[0m04:49:19.320929 [debug] [ThreadPool]: On create_ffd_stg: Close
[0m04:49:19.325132 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_stg"
[0m04:49:19.347351 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg"
[0m04:49:19.347880 [debug] [ThreadPool]: On list_ffd_stg: BEGIN
[0m04:49:19.348147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:49:19.371050 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m04:49:19.371696 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg"
[0m04:49:19.372181 [debug] [ThreadPool]: On list_ffd_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "connection_name": "list_ffd_stg"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
  
[0m04:49:19.381444 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m04:49:19.386580 [debug] [ThreadPool]: On list_ffd_stg: ROLLBACK
[0m04:49:19.387648 [debug] [ThreadPool]: On list_ffd_stg: Close
[0m04:49:19.389228 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_stg_int"
[0m04:49:19.394960 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_int"
[0m04:49:19.395427 [debug] [ThreadPool]: On list_ffd_stg_int: BEGIN
[0m04:49:19.395692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:49:19.422219 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m04:49:19.422871 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_int"
[0m04:49:19.423275 [debug] [ThreadPool]: On list_ffd_stg_int: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "connection_name": "list_ffd_stg_int"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg_int'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg_int'
  
[0m04:49:19.432498 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m04:49:19.437395 [debug] [ThreadPool]: On list_ffd_stg_int: ROLLBACK
[0m04:49:19.438470 [debug] [ThreadPool]: On list_ffd_stg_int: Close
[0m04:49:19.455518 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:19.456057 [debug] [MainThread]: On master: BEGIN
[0m04:49:19.456325 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:49:19.484074 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:49:19.484584 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:19.484856 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:49:19.498556 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m04:49:19.503226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e72c187-a445-4591-ae07-24889ad851b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec7ea269b0>]}
[0m04:49:19.504298 [debug] [MainThread]: On master: ROLLBACK
[0m04:49:19.505218 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:19.505637 [debug] [MainThread]: On master: BEGIN
[0m04:49:19.506861 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:49:19.507359 [debug] [MainThread]: On master: COMMIT
[0m04:49:19.507848 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:19.508197 [debug] [MainThread]: On master: COMMIT
[0m04:49:19.508886 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:49:19.509306 [debug] [MainThread]: On master: Close
[0m04:49:19.510452 [info ] [MainThread]: Concurrency: 1 threads (target='ffd')
[0m04:49:19.511330 [info ] [MainThread]: 
[0m04:49:19.518822 [debug] [Thread-1 (]: Began running node model.ffd.int__test
[0m04:49:19.519873 [info ] [Thread-1 (]: 1 of 2 START table model stg_int.int__test ..................................... [RUN]
[0m04:49:19.521327 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.int__test"
[0m04:49:19.521909 [debug] [Thread-1 (]: Began compiling node model.ffd.int__test
[0m04:49:19.522350 [debug] [Thread-1 (]: Compiling model.ffd.int__test
[0m04:49:19.528001 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.int__test"
[0m04:49:19.529288 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:19.529902 [debug] [Thread-1 (]: Began executing node model.ffd.int__test
[0m04:49:19.653600 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.int__test"
[0m04:49:19.654637 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:49:19.654936 [debug] [Thread-1 (]: On model.ffd.int__test: BEGIN
[0m04:49:19.655213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:49:19.684234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:49:19.684834 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:49:19.685464 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.int__test"} */


  create  table "ffd"."stg_int"."int__test__dbt_tmp"
  as (
    SELECT 3
UNION
SELECT 4
  );
[0m04:49:19.690750 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m04:49:19.713888 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:49:19.714384 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.int__test"} */
alter table "ffd"."stg_int"."int__test" rename to "int__test__dbt_backup"
[0m04:49:19.715894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:49:19.723950 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:49:19.724521 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.int__test"} */
alter table "ffd"."stg_int"."int__test__dbt_tmp" rename to "int__test"
[0m04:49:19.725803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:49:19.801434 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m04:49:19.801947 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:49:19.802220 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m04:49:19.812104 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:49:19.833777 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:49:19.834261 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.int__test"} */
drop table if exists "ffd"."stg_int"."int__test__dbt_backup" cascade
[0m04:49:19.845881 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m04:49:19.849361 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:19.850053 [debug] [Thread-1 (]: On model.ffd.int__test: Close
[0m04:49:19.851640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e72c187-a445-4591-ae07-24889ad851b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec7c02be50>]}
[0m04:49:19.853171 [info ] [Thread-1 (]: 1 of 2 OK created table model stg_int.int__test ................................ [[32mSELECT 2[0m in 0.33s]
[0m04:49:19.854848 [debug] [Thread-1 (]: Finished running node model.ffd.int__test
[0m04:49:19.855861 [debug] [Thread-1 (]: Began running node model.ffd.stg__test
[0m04:49:19.857019 [info ] [Thread-1 (]: 2 of 2 START table model stg.stg__test ......................................... [RUN]
[0m04:49:19.858066 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.stg__test"
[0m04:49:19.858505 [debug] [Thread-1 (]: Began compiling node model.ffd.stg__test
[0m04:49:19.858804 [debug] [Thread-1 (]: Compiling model.ffd.stg__test
[0m04:49:19.863232 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.stg__test"
[0m04:49:19.864216 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:19.864573 [debug] [Thread-1 (]: Began executing node model.ffd.stg__test
[0m04:49:19.874456 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.stg__test"
[0m04:49:19.875423 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:49:19.875712 [debug] [Thread-1 (]: On model.ffd.stg__test: BEGIN
[0m04:49:19.876020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:49:19.899270 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m04:49:19.899913 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:49:19.900273 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.stg__test"} */


  create  table "ffd"."stg"."stg__test__dbt_tmp"
  as (
    SELECT 1
UNION
SELECT 2
  );
[0m04:49:19.904718 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m04:49:19.915049 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:49:19.915532 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."stg"."stg__test__dbt_tmp" rename to "stg__test"
[0m04:49:19.916767 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:49:19.921882 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m04:49:19.922360 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:49:19.922623 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m04:49:19.928697 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:49:19.935216 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:49:19.935997 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.stg__test"} */
drop table if exists "ffd"."stg"."stg__test__dbt_backup" cascade
[0m04:49:19.937359 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m04:49:19.941113 [debug] [Thread-1 (]: finished collecting timing info
[0m04:49:19.941635 [debug] [Thread-1 (]: On model.ffd.stg__test: Close
[0m04:49:19.942700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e72c187-a445-4591-ae07-24889ad851b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec7e1f1f60>]}
[0m04:49:19.943674 [info ] [Thread-1 (]: 2 of 2 OK created table model stg.stg__test .................................... [[32mSELECT 2[0m in 0.08s]
[0m04:49:19.944866 [debug] [Thread-1 (]: Finished running node model.ffd.stg__test
[0m04:49:19.947388 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:49:19.948028 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:19.948324 [debug] [MainThread]: On master: BEGIN
[0m04:49:19.948603 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:49:19.974412 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:49:19.975046 [debug] [MainThread]: On master: COMMIT
[0m04:49:19.975556 [debug] [MainThread]: Using postgres connection "master"
[0m04:49:19.975842 [debug] [MainThread]: On master: COMMIT
[0m04:49:19.976334 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:49:19.976679 [debug] [MainThread]: On master: Close
[0m04:49:19.977988 [info ] [MainThread]: 
[0m04:49:19.979149 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m04:49:19.980173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:49:19.980693 [debug] [MainThread]: Connection 'model.ffd.stg__test' was properly closed.
[0m04:49:19.999434 [info ] [MainThread]: 
[0m04:49:20.000157 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:49:20.000793 [info ] [MainThread]: 
[0m04:49:20.001299 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:49:20.002030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec7e1390c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec7ea4d6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec7e18e260>]}
[0m04:49:20.002620 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 04:50:19.657579 | 72b53d77-4cd3-41cb-b498-046f89d76abf ==============================
[0m04:50:19.657619 [info ] [MainThread]: Running with dbt=1.2.3
[0m04:50:19.658507 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'fail_fast': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:50:19.658944 [debug] [MainThread]: Tracking: tracking
[0m04:50:19.662124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d4be0f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d4be1030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d4be0fd0>]}
[0m04:50:19.719880 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:50:19.720754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '72b53d77-4cd3-41cb-b498-046f89d76abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d4bc67a0>]}
[0m04:50:19.759195 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:50:19.766739 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:50:19.854682 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:50:19.859313 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:50:19.863033 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:50:19.885154 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:50:19.887283 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:50:19.888572 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:50:19.892483 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:50:19.897090 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:50:19.902365 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:50:19.930010 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:50:19.944704 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:50:19.962973 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:50:19.969664 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:50:19.972836 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:50:19.976851 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:50:19.980419 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:50:19.984554 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:50:19.988217 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:50:19.991653 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:50:19.994469 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:50:20.000091 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:50:20.003311 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:50:20.006682 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:50:20.009787 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:50:20.013086 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:50:20.020367 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:50:20.023684 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:50:20.026420 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:50:20.029329 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:50:20.033676 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:50:20.036564 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:50:20.039768 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:50:20.045013 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:50:20.052796 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:50:20.057319 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:50:20.061649 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:50:20.063870 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:50:20.066374 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:50:20.069014 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:50:20.076201 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:50:20.088320 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:50:20.127130 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:50:20.166751 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:50:20.171929 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:50:20.228045 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:50:20.275845 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:50:20.291022 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:50:20.322182 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:50:20.327306 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:50:20.378413 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:50:20.387765 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:50:20.405719 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:50:20.417361 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:50:20.425622 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:50:20.430000 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:50:20.447840 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:50:20.453672 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:50:20.459353 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:50:20.474326 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:50:20.496626 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:50:20.553240 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:50:20.598508 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:50:20.621184 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:50:20.652491 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:50:20.659216 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:50:20.704710 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:50:20.718832 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:50:20.728033 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:50:20.736978 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:50:21.496996 [debug] [MainThread]: 1699: static parser successfully parsed int/int__test.sql
[0m04:50:21.534383 [debug] [MainThread]: 1699: static parser successfully parsed stg/stg__test.sql
[0m04:50:21.625566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72b53d77-4cd3-41cb-b498-046f89d76abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d4b1a1a0>]}
[0m04:50:21.640868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72b53d77-4cd3-41cb-b498-046f89d76abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d4be2ef0>]}
[0m04:50:21.641637 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:50:21.642166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72b53d77-4cd3-41cb-b498-046f89d76abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d4be2da0>]}
[0m04:50:21.644836 [info ] [MainThread]: 
[0m04:50:21.646117 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:50:21.648390 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:50:21.682999 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:50:21.683516 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:50:21.683845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:50:21.715309 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.03 seconds
[0m04:50:21.720057 [debug] [ThreadPool]: On list_ffd: Close
[0m04:50:21.722677 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_stg"
[0m04:50:21.723964 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_stg"
[0m04:50:21.724789 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='ffd', schema='stg', identifier=None)"
[0m04:50:21.742847 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg"
[0m04:50:21.743352 [debug] [ThreadPool]: On create_ffd_stg: BEGIN
[0m04:50:21.743625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:50:21.765304 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m04:50:21.766011 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg"
[0m04:50:21.766480 [debug] [ThreadPool]: On create_ffd_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "connection_name": "create_ffd_stg"} */
create schema if not exists "stg"
[0m04:50:21.768303 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m04:50:21.771556 [debug] [ThreadPool]: On create_ffd_stg: COMMIT
[0m04:50:21.772265 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg"
[0m04:50:21.772765 [debug] [ThreadPool]: On create_ffd_stg: COMMIT
[0m04:50:21.781180 [debug] [ThreadPool]: SQL status: COMMIT in 0.01 seconds
[0m04:50:21.781939 [debug] [ThreadPool]: On create_ffd_stg: Close
[0m04:50:21.785627 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_stg"
[0m04:50:21.805011 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg"
[0m04:50:21.805504 [debug] [ThreadPool]: On list_ffd_stg: BEGIN
[0m04:50:21.805774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:50:21.829776 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m04:50:21.830397 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg"
[0m04:50:21.831032 [debug] [ThreadPool]: On list_ffd_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "connection_name": "list_ffd_stg"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
  
[0m04:50:21.840446 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m04:50:21.845167 [debug] [ThreadPool]: On list_ffd_stg: ROLLBACK
[0m04:50:21.846196 [debug] [ThreadPool]: On list_ffd_stg: Close
[0m04:50:21.861225 [debug] [MainThread]: Using postgres connection "master"
[0m04:50:21.861729 [debug] [MainThread]: On master: BEGIN
[0m04:50:21.861996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:50:21.883330 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m04:50:21.883995 [debug] [MainThread]: Using postgres connection "master"
[0m04:50:21.884461 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:50:21.898165 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m04:50:21.902830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72b53d77-4cd3-41cb-b498-046f89d76abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d4b42080>]}
[0m04:50:21.903945 [debug] [MainThread]: On master: ROLLBACK
[0m04:50:21.904948 [debug] [MainThread]: Using postgres connection "master"
[0m04:50:21.905261 [debug] [MainThread]: On master: BEGIN
[0m04:50:21.906305 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:50:21.906874 [debug] [MainThread]: On master: COMMIT
[0m04:50:21.907397 [debug] [MainThread]: Using postgres connection "master"
[0m04:50:21.907935 [debug] [MainThread]: On master: COMMIT
[0m04:50:21.908405 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:50:21.908719 [debug] [MainThread]: On master: Close
[0m04:50:21.909554 [info ] [MainThread]: Concurrency: 1 threads (target='ffd')
[0m04:50:21.910249 [info ] [MainThread]: 
[0m04:50:21.917277 [debug] [Thread-1 (]: Began running node model.ffd.int__test
[0m04:50:21.918395 [info ] [Thread-1 (]: 1 of 2 START table model stg.int__test ......................................... [RUN]
[0m04:50:21.919690 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.int__test"
[0m04:50:21.920193 [debug] [Thread-1 (]: Began compiling node model.ffd.int__test
[0m04:50:21.920758 [debug] [Thread-1 (]: Compiling model.ffd.int__test
[0m04:50:21.929516 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.int__test"
[0m04:50:21.930446 [debug] [Thread-1 (]: finished collecting timing info
[0m04:50:21.930768 [debug] [Thread-1 (]: Began executing node model.ffd.int__test
[0m04:50:22.051997 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.int__test"
[0m04:50:22.053014 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:50:22.053323 [debug] [Thread-1 (]: On model.ffd.int__test: BEGIN
[0m04:50:22.053590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:50:22.082509 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:50:22.083091 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:50:22.083717 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.int__test"} */


  create  table "ffd"."stg"."int__test__dbt_tmp"
  as (
    SELECT 3
UNION
SELECT 4
  );
[0m04:50:22.088357 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m04:50:22.110478 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:50:22.111016 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.int__test"} */
alter table "ffd"."stg"."int__test__dbt_tmp" rename to "int__test"
[0m04:50:22.112621 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:50:22.177716 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m04:50:22.178232 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:50:22.178499 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m04:50:22.223129 [debug] [Thread-1 (]: SQL status: COMMIT in 0.04 seconds
[0m04:50:22.239200 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:50:22.239839 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.int__test"} */
drop table if exists "ffd"."stg"."int__test__dbt_backup" cascade
[0m04:50:22.240706 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m04:50:22.243367 [debug] [Thread-1 (]: finished collecting timing info
[0m04:50:22.243883 [debug] [Thread-1 (]: On model.ffd.int__test: Close
[0m04:50:22.244999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72b53d77-4cd3-41cb-b498-046f89d76abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d4b02800>]}
[0m04:50:22.246033 [info ] [Thread-1 (]: 1 of 2 OK created table model stg.int__test .................................... [[32mSELECT 2[0m in 0.33s]
[0m04:50:22.247265 [debug] [Thread-1 (]: Finished running node model.ffd.int__test
[0m04:50:22.248052 [debug] [Thread-1 (]: Began running node model.ffd.stg__test
[0m04:50:22.249189 [info ] [Thread-1 (]: 2 of 2 START table model stg.stg__test ......................................... [RUN]
[0m04:50:22.250269 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.stg__test"
[0m04:50:22.250703 [debug] [Thread-1 (]: Began compiling node model.ffd.stg__test
[0m04:50:22.251002 [debug] [Thread-1 (]: Compiling model.ffd.stg__test
[0m04:50:22.255461 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.stg__test"
[0m04:50:22.256498 [debug] [Thread-1 (]: finished collecting timing info
[0m04:50:22.256839 [debug] [Thread-1 (]: Began executing node model.ffd.stg__test
[0m04:50:22.266994 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.stg__test"
[0m04:50:22.268007 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:50:22.268313 [debug] [Thread-1 (]: On model.ffd.stg__test: BEGIN
[0m04:50:22.268577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:50:22.296605 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:50:22.297371 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:50:22.297993 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.stg__test"} */


  create  table "ffd"."stg"."stg__test__dbt_tmp"
  as (
    SELECT 1
UNION
SELECT 2
  );
[0m04:50:22.303147 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m04:50:22.313382 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:50:22.313989 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."stg"."stg__test__dbt_tmp" rename to "stg__test"
[0m04:50:22.315372 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:50:22.320074 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m04:50:22.320513 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:50:22.320779 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m04:50:22.331409 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:50:22.339546 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:50:22.340267 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "ffd", "node_id": "model.ffd.stg__test"} */
drop table if exists "ffd"."stg"."stg__test__dbt_backup" cascade
[0m04:50:22.341444 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m04:50:22.344083 [debug] [Thread-1 (]: finished collecting timing info
[0m04:50:22.344565 [debug] [Thread-1 (]: On model.ffd.stg__test: Close
[0m04:50:22.345623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72b53d77-4cd3-41cb-b498-046f89d76abf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d43b9a80>]}
[0m04:50:22.346634 [info ] [Thread-1 (]: 2 of 2 OK created table model stg.stg__test .................................... [[32mSELECT 2[0m in 0.10s]
[0m04:50:22.347808 [debug] [Thread-1 (]: Finished running node model.ffd.stg__test
[0m04:50:22.350582 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:50:22.351608 [debug] [MainThread]: Using postgres connection "master"
[0m04:50:22.352092 [debug] [MainThread]: On master: BEGIN
[0m04:50:22.352419 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:50:22.377774 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:50:22.378375 [debug] [MainThread]: On master: COMMIT
[0m04:50:22.378927 [debug] [MainThread]: Using postgres connection "master"
[0m04:50:22.379545 [debug] [MainThread]: On master: COMMIT
[0m04:50:22.380226 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:50:22.380726 [debug] [MainThread]: On master: Close
[0m04:50:22.382342 [info ] [MainThread]: 
[0m04:50:22.383386 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m04:50:22.384366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:50:22.384922 [debug] [MainThread]: Connection 'model.ffd.stg__test' was properly closed.
[0m04:50:22.406994 [info ] [MainThread]: 
[0m04:50:22.407630 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:50:22.408314 [info ] [MainThread]: 
[0m04:50:22.408825 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:50:22.409571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d4456ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d4457bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d44560b0>]}
[0m04:50:22.410150 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 04:52:04.403249 | a5db81f0-cb60-4dc9-8822-8c0589852e4a ==============================
[0m04:52:04.403288 [info ] [MainThread]: Running with dbt=1.2.3
[0m04:52:04.404250 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'fail_fast': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:52:04.404684 [debug] [MainThread]: Tracking: tracking
[0m04:52:04.408127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f171a394e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f171a394f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f171a394ee0>]}
[0m04:52:04.464686 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:52:04.465521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a5db81f0-cb60-4dc9-8822-8c0589852e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f171a369de0>]}
[0m04:52:04.504028 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:52:04.511499 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:52:04.598433 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:52:04.602816 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:52:04.606477 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:52:04.627667 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:52:04.629723 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:52:04.631004 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:52:04.634854 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:52:04.639435 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:52:04.644543 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:52:04.671197 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:52:04.685949 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:52:04.704398 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:52:04.710941 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:52:04.714048 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:52:04.718207 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:52:04.721866 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:52:04.725711 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:52:04.729110 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:52:04.732321 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:52:04.735127 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:52:04.740733 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:52:04.744274 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:52:04.747729 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:52:04.750644 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:52:04.753930 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:52:04.761292 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:52:04.764674 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:52:04.767682 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:52:04.770687 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:52:04.774547 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:52:04.777193 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:52:04.780518 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:52:04.785643 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:52:04.793275 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:52:04.797761 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:52:04.802092 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:52:04.804167 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:52:04.806618 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:52:04.809508 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:52:04.817041 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:52:04.829235 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:52:04.866698 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:52:04.906292 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:52:04.912005 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:52:04.967962 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:52:05.016567 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:52:05.031770 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:52:05.063101 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:52:05.068057 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:52:05.118702 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:52:05.127923 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:52:05.146462 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:52:05.158190 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:52:05.165487 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:52:05.169506 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:52:05.187161 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:52:05.192890 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:52:05.198573 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:52:05.214163 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:52:05.236614 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:52:05.293189 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:52:05.338579 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:52:05.361727 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:52:05.394004 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:52:05.400777 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:52:05.446159 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:52:05.460235 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:52:05.469317 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:52:05.477778 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:52:06.234793 [debug] [MainThread]: 1699: static parser successfully parsed int/int__test.sql
[0m04:52:06.272471 [debug] [MainThread]: 1699: static parser successfully parsed stg/stg__test.sql
[0m04:52:06.364346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5db81f0-cb60-4dc9-8822-8c0589852e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17183ca0b0>]}
[0m04:52:06.379759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5db81f0-cb60-4dc9-8822-8c0589852e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f171a396bf0>]}
[0m04:52:06.380595 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:52:06.381109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5db81f0-cb60-4dc9-8822-8c0589852e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f171a373e50>]}
[0m04:52:06.383670 [info ] [MainThread]: 
[0m04:52:06.384931 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:52:06.387109 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:52:06.417781 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:52:06.418373 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:52:06.418670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:52:06.448041 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.03 seconds
[0m04:52:06.451191 [debug] [ThreadPool]: On list_ffd: Close
[0m04:52:06.453252 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_stg"
[0m04:52:06.454411 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_stg"
[0m04:52:06.455156 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='ffd', schema='stg', identifier=None)"
[0m04:52:06.473039 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg"
[0m04:52:06.473581 [debug] [ThreadPool]: On create_ffd_stg: BEGIN
[0m04:52:06.473876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:52:06.498222 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m04:52:06.498781 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg"
[0m04:52:06.499407 [debug] [ThreadPool]: On create_ffd_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "create_ffd_stg"} */
create schema if not exists "stg"
[0m04:52:06.501004 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m04:52:06.504980 [debug] [ThreadPool]: On create_ffd_stg: COMMIT
[0m04:52:06.505733 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg"
[0m04:52:06.506358 [debug] [ThreadPool]: On create_ffd_stg: COMMIT
[0m04:52:06.515873 [debug] [ThreadPool]: SQL status: COMMIT in 0.01 seconds
[0m04:52:06.516579 [debug] [ThreadPool]: On create_ffd_stg: Close
[0m04:52:06.520657 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_stg"
[0m04:52:06.541950 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg"
[0m04:52:06.542431 [debug] [ThreadPool]: On list_ffd_stg: BEGIN
[0m04:52:06.542692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:52:06.566868 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m04:52:06.567444 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg"
[0m04:52:06.568002 [debug] [ThreadPool]: On list_ffd_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd_stg"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
  
[0m04:52:06.576280 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m04:52:06.581002 [debug] [ThreadPool]: On list_ffd_stg: ROLLBACK
[0m04:52:06.581991 [debug] [ThreadPool]: On list_ffd_stg: Close
[0m04:52:06.600615 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:06.601101 [debug] [MainThread]: On master: BEGIN
[0m04:52:06.601360 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:52:06.630822 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:52:06.631323 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:06.631591 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:52:06.644653 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m04:52:06.649836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5db81f0-cb60-4dc9-8822-8c0589852e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17183f0160>]}
[0m04:52:06.651028 [debug] [MainThread]: On master: ROLLBACK
[0m04:52:06.652136 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:06.652457 [debug] [MainThread]: On master: BEGIN
[0m04:52:06.653097 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:52:06.653429 [debug] [MainThread]: On master: COMMIT
[0m04:52:06.653689 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:06.653941 [debug] [MainThread]: On master: COMMIT
[0m04:52:06.654379 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:52:06.654685 [debug] [MainThread]: On master: Close
[0m04:52:06.655516 [info ] [MainThread]: Concurrency: 1 threads (target='stg')
[0m04:52:06.656287 [info ] [MainThread]: 
[0m04:52:06.663221 [debug] [Thread-1 (]: Began running node model.ffd.int__test
[0m04:52:06.664089 [info ] [Thread-1 (]: 1 of 2 START table model stg.int__test ......................................... [RUN]
[0m04:52:06.665326 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.int__test"
[0m04:52:06.665857 [debug] [Thread-1 (]: Began compiling node model.ffd.int__test
[0m04:52:06.666438 [debug] [Thread-1 (]: Compiling model.ffd.int__test
[0m04:52:06.674153 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.int__test"
[0m04:52:06.675257 [debug] [Thread-1 (]: finished collecting timing info
[0m04:52:06.675686 [debug] [Thread-1 (]: Began executing node model.ffd.int__test
[0m04:52:06.805869 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.int__test"
[0m04:52:06.806877 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:52:06.807186 [debug] [Thread-1 (]: On model.ffd.int__test: BEGIN
[0m04:52:06.807452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:52:06.833786 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:52:06.834369 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:52:06.834939 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */


  create  table "ffd"."stg"."int__test__dbt_tmp"
  as (
    SELECT 3
UNION
SELECT 4
  );
[0m04:52:06.840206 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m04:52:06.864276 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:52:06.864768 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
alter table "ffd"."stg"."int__test__dbt_tmp" rename to "int__test"
[0m04:52:06.865983 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:52:06.931120 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m04:52:06.931633 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:52:06.931961 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m04:52:06.941004 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:52:06.959530 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:52:06.960041 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
drop table if exists "ffd"."stg"."int__test__dbt_backup" cascade
[0m04:52:06.961097 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m04:52:06.963854 [debug] [Thread-1 (]: finished collecting timing info
[0m04:52:06.964350 [debug] [Thread-1 (]: On model.ffd.int__test: Close
[0m04:52:06.965438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5db81f0-cb60-4dc9-8822-8c0589852e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1718bb3550>]}
[0m04:52:06.966458 [info ] [Thread-1 (]: 1 of 2 OK created table model stg.int__test .................................... [[32mSELECT 2[0m in 0.30s]
[0m04:52:06.967615 [debug] [Thread-1 (]: Finished running node model.ffd.int__test
[0m04:52:06.968372 [debug] [Thread-1 (]: Began running node model.ffd.stg__test
[0m04:52:06.969404 [info ] [Thread-1 (]: 2 of 2 START table model stg.stg__test ......................................... [RUN]
[0m04:52:06.970514 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.stg__test"
[0m04:52:06.970952 [debug] [Thread-1 (]: Began compiling node model.ffd.stg__test
[0m04:52:06.971279 [debug] [Thread-1 (]: Compiling model.ffd.stg__test
[0m04:52:06.975652 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.stg__test"
[0m04:52:06.976636 [debug] [Thread-1 (]: finished collecting timing info
[0m04:52:06.976993 [debug] [Thread-1 (]: Began executing node model.ffd.stg__test
[0m04:52:06.987181 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.stg__test"
[0m04:52:06.988248 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:52:06.988549 [debug] [Thread-1 (]: On model.ffd.stg__test: BEGIN
[0m04:52:06.988808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:52:07.017454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:52:07.018152 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:52:07.018601 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */


  create  table "ffd"."stg"."stg__test__dbt_tmp"
  as (
    SELECT 1
UNION
SELECT 2
  );
[0m04:52:07.023058 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m04:52:07.032423 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:52:07.033020 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."stg"."stg__test__dbt_tmp" rename to "stg__test"
[0m04:52:07.034455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:52:07.039421 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m04:52:07.039879 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:52:07.040147 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m04:52:07.049368 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:52:07.056019 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:52:07.056659 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
drop table if exists "ffd"."stg"."stg__test__dbt_backup" cascade
[0m04:52:07.057954 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m04:52:07.061315 [debug] [Thread-1 (]: finished collecting timing info
[0m04:52:07.061778 [debug] [Thread-1 (]: On model.ffd.stg__test: Close
[0m04:52:07.062817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5db81f0-cb60-4dc9-8822-8c0589852e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1718465a80>]}
[0m04:52:07.063775 [info ] [Thread-1 (]: 2 of 2 OK created table model stg.stg__test .................................... [[32mSELECT 2[0m in 0.09s]
[0m04:52:07.064979 [debug] [Thread-1 (]: Finished running node model.ffd.stg__test
[0m04:52:07.067956 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:52:07.068706 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:07.069348 [debug] [MainThread]: On master: BEGIN
[0m04:52:07.069954 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:52:07.096449 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:52:07.097012 [debug] [MainThread]: On master: COMMIT
[0m04:52:07.097364 [debug] [MainThread]: Using postgres connection "master"
[0m04:52:07.097711 [debug] [MainThread]: On master: COMMIT
[0m04:52:07.098315 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:52:07.098722 [debug] [MainThread]: On master: Close
[0m04:52:07.100015 [info ] [MainThread]: 
[0m04:52:07.100978 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m04:52:07.101767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:52:07.102266 [debug] [MainThread]: Connection 'model.ffd.stg__test' was properly closed.
[0m04:52:07.123852 [info ] [MainThread]: 
[0m04:52:07.124495 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:52:07.125115 [info ] [MainThread]: 
[0m04:52:07.125647 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:52:07.126413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17182eee00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17182ef700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17182efa00>]}
[0m04:52:07.127004 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 04:53:11.990363 | bf5bec57-e4ed-4d54-808b-287929abc2a6 ==============================
[0m04:53:11.990402 [info ] [MainThread]: Running with dbt=1.2.3
[0m04:53:11.991302 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'fail_fast': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:53:11.991741 [debug] [MainThread]: Tracking: tracking
[0m04:53:11.995576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915c11cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915c11d000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915c11cfa0>]}
[0m04:53:12.053132 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:53:12.053994 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:53:12.054612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf5bec57-e4ed-4d54-808b-287929abc2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915c0ec280>]}
[0m04:53:12.093247 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:53:12.100701 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:53:12.182677 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:53:12.187084 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:53:12.191010 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:53:12.214863 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:53:12.217081 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:53:12.218374 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:53:12.222275 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:53:12.226923 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:53:12.232149 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:53:12.259242 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:53:12.274497 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:53:12.292891 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:53:12.299631 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:53:12.302756 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:53:12.306746 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:53:12.310354 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:53:12.314534 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:53:12.318163 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:53:12.321349 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:53:12.324119 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:53:12.329723 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:53:12.333024 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:53:12.336480 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:53:12.339336 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:53:12.342582 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:53:12.349960 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:53:12.353517 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:53:12.356518 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:53:12.359582 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:53:12.363472 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:53:12.365920 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:53:12.369116 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:53:12.374208 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:53:12.381863 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:53:12.386406 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:53:12.390864 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:53:12.393075 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:53:12.395602 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:53:12.398171 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:53:12.405358 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:53:12.417561 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:53:12.455859 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:53:12.496858 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:53:12.502120 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:53:12.558829 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:53:12.608314 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:53:12.622779 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:53:12.654664 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:53:12.659925 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:53:12.712321 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:53:12.721982 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:53:12.740759 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:53:12.751882 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:53:12.759461 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:53:12.763515 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:53:12.781021 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:53:12.786711 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:53:12.792978 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:53:12.808257 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:53:12.831587 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:53:12.894925 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:53:12.940330 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:53:12.962894 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:53:12.994975 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:53:13.001859 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:53:13.047140 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:53:13.061746 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:53:13.071147 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:53:13.080227 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:53:13.837043 [debug] [MainThread]: 1699: static parser successfully parsed int/int__test.sql
[0m04:53:13.874047 [debug] [MainThread]: 1699: static parser successfully parsed stg/stg__test.sql
[0m04:53:13.950655 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.int.int
- models.stg.stg

[0m04:53:13.966256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf5bec57-e4ed-4d54-808b-287929abc2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9159f521d0>]}
[0m04:53:13.981603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf5bec57-e4ed-4d54-808b-287929abc2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915c11eec0>]}
[0m04:53:13.982350 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:53:13.982877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf5bec57-e4ed-4d54-808b-287929abc2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915c11eda0>]}
[0m04:53:13.985503 [info ] [MainThread]: 
[0m04:53:13.986806 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:53:13.989000 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:53:14.022428 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:53:14.022947 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:53:14.023220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:53:14.049410 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
[0m04:53:14.053190 [debug] [ThreadPool]: On list_ffd: Close
[0m04:53:14.056774 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_stg"
[0m04:53:14.078091 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg"
[0m04:53:14.078587 [debug] [ThreadPool]: On list_ffd_stg: BEGIN
[0m04:53:14.078854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:53:14.106292 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m04:53:14.106859 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg"
[0m04:53:14.107389 [debug] [ThreadPool]: On list_ffd_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd_stg"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
  
[0m04:53:14.118290 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m04:53:14.122924 [debug] [ThreadPool]: On list_ffd_stg: ROLLBACK
[0m04:53:14.123997 [debug] [ThreadPool]: On list_ffd_stg: Close
[0m04:53:14.142252 [debug] [MainThread]: Using postgres connection "master"
[0m04:53:14.142749 [debug] [MainThread]: On master: BEGIN
[0m04:53:14.143017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:53:14.172159 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:53:14.172673 [debug] [MainThread]: Using postgres connection "master"
[0m04:53:14.172945 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:53:14.186505 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m04:53:14.191251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf5bec57-e4ed-4d54-808b-287929abc2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9159fc0790>]}
[0m04:53:14.192406 [debug] [MainThread]: On master: ROLLBACK
[0m04:53:14.193433 [debug] [MainThread]: Using postgres connection "master"
[0m04:53:14.194001 [debug] [MainThread]: On master: BEGIN
[0m04:53:14.195237 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:53:14.195764 [debug] [MainThread]: On master: COMMIT
[0m04:53:14.196122 [debug] [MainThread]: Using postgres connection "master"
[0m04:53:14.196382 [debug] [MainThread]: On master: COMMIT
[0m04:53:14.196839 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:53:14.197149 [debug] [MainThread]: On master: Close
[0m04:53:14.197985 [info ] [MainThread]: Concurrency: 1 threads (target='stg')
[0m04:53:14.198696 [info ] [MainThread]: 
[0m04:53:14.206084 [debug] [Thread-1 (]: Began running node model.ffd.int__test
[0m04:53:14.207085 [info ] [Thread-1 (]: 1 of 2 START view model stg.int__test .......................................... [RUN]
[0m04:53:14.208473 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.int__test"
[0m04:53:14.209017 [debug] [Thread-1 (]: Began compiling node model.ffd.int__test
[0m04:53:14.209459 [debug] [Thread-1 (]: Compiling model.ffd.int__test
[0m04:53:14.214812 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.int__test"
[0m04:53:14.216089 [debug] [Thread-1 (]: finished collecting timing info
[0m04:53:14.216717 [debug] [Thread-1 (]: Began executing node model.ffd.int__test
[0m04:53:14.345093 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.int__test"
[0m04:53:14.346138 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:53:14.346435 [debug] [Thread-1 (]: On model.ffd.int__test: BEGIN
[0m04:53:14.346702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:53:14.370694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m04:53:14.371212 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:53:14.371484 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */

  create view "ffd"."stg"."int__test__dbt_tmp" as (
    SELECT 3
UNION
SELECT 4
  );
[0m04:53:14.375555 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:53:14.398271 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:53:14.398765 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
alter table "ffd"."stg"."int__test" rename to "int__test__dbt_backup"
[0m04:53:14.400026 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:53:14.406308 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:53:14.406777 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
alter table "ffd"."stg"."int__test__dbt_tmp" rename to "int__test"
[0m04:53:14.408111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:53:14.471020 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m04:53:14.471527 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:53:14.471826 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m04:53:14.486317 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:53:14.505008 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:53:14.505494 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
drop table if exists "ffd"."stg"."int__test__dbt_backup" cascade
[0m04:53:14.520410 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m04:53:14.523311 [debug] [Thread-1 (]: finished collecting timing info
[0m04:53:14.523893 [debug] [Thread-1 (]: On model.ffd.int__test: Close
[0m04:53:14.525514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5bec57-e4ed-4d54-808b-287929abc2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915a8d8490>]}
[0m04:53:14.526964 [info ] [Thread-1 (]: 1 of 2 OK created view model stg.int__test ..................................... [[32mCREATE VIEW[0m in 0.32s]
[0m04:53:14.528729 [debug] [Thread-1 (]: Finished running node model.ffd.int__test
[0m04:53:14.529731 [debug] [Thread-1 (]: Began running node model.ffd.stg__test
[0m04:53:14.531061 [info ] [Thread-1 (]: 2 of 2 START view model stg.stg__test .......................................... [RUN]
[0m04:53:14.532467 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.stg__test"
[0m04:53:14.532924 [debug] [Thread-1 (]: Began compiling node model.ffd.stg__test
[0m04:53:14.533227 [debug] [Thread-1 (]: Compiling model.ffd.stg__test
[0m04:53:14.537583 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.stg__test"
[0m04:53:14.538505 [debug] [Thread-1 (]: finished collecting timing info
[0m04:53:14.538852 [debug] [Thread-1 (]: Began executing node model.ffd.stg__test
[0m04:53:14.549058 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.stg__test"
[0m04:53:14.550003 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:53:14.550298 [debug] [Thread-1 (]: On model.ffd.stg__test: BEGIN
[0m04:53:14.550562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:53:14.578527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:53:14.579184 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:53:14.579912 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */

  create view "ffd"."stg"."stg__test__dbt_tmp" as (
    SELECT 1
UNION
SELECT 2
  );
[0m04:53:14.584935 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:53:14.594867 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:53:14.595479 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."stg"."stg__test" rename to "stg__test__dbt_backup"
[0m04:53:14.597069 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:53:14.605218 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:53:14.605771 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."stg"."stg__test__dbt_tmp" rename to "stg__test"
[0m04:53:14.607285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:53:14.613209 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m04:53:14.613731 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:53:14.614085 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m04:53:14.619882 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:53:14.630353 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:53:14.630977 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
drop table if exists "ffd"."stg"."stg__test__dbt_backup" cascade
[0m04:53:14.645703 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m04:53:14.649121 [debug] [Thread-1 (]: finished collecting timing info
[0m04:53:14.649883 [debug] [Thread-1 (]: On model.ffd.stg__test: Close
[0m04:53:14.651646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf5bec57-e4ed-4d54-808b-287929abc2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915867d660>]}
[0m04:53:14.653315 [info ] [Thread-1 (]: 2 of 2 OK created view model stg.stg__test ..................................... [[32mCREATE VIEW[0m in 0.12s]
[0m04:53:14.655108 [debug] [Thread-1 (]: Finished running node model.ffd.stg__test
[0m04:53:14.658009 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:53:14.658722 [debug] [MainThread]: Using postgres connection "master"
[0m04:53:14.659120 [debug] [MainThread]: On master: BEGIN
[0m04:53:14.659505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:53:14.685135 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:53:14.685813 [debug] [MainThread]: On master: COMMIT
[0m04:53:14.686211 [debug] [MainThread]: Using postgres connection "master"
[0m04:53:14.686604 [debug] [MainThread]: On master: COMMIT
[0m04:53:14.687297 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:53:14.687827 [debug] [MainThread]: On master: Close
[0m04:53:14.689245 [info ] [MainThread]: 
[0m04:53:14.690237 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m04:53:14.691128 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:53:14.691624 [debug] [MainThread]: Connection 'model.ffd.stg__test' was properly closed.
[0m04:53:14.710703 [info ] [MainThread]: 
[0m04:53:14.711335 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:53:14.711987 [info ] [MainThread]: 
[0m04:53:14.712496 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:53:14.713292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915867d7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915866b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915866bfa0>]}
[0m04:53:14.713872 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 04:58:40.865913 | 604cd3e3-3d86-40fe-9236-f9e31bb858cf ==============================
[0m04:58:40.865953 [info ] [MainThread]: Running with dbt=1.2.3
[0m04:58:40.866845 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'fail_fast': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:58:40.867312 [debug] [MainThread]: Tracking: tracking
[0m04:58:40.870474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb01e761180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb02001fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb02001fb50>]}
[0m04:58:40.927221 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:58:40.928193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '604cd3e3-3d86-40fe-9236-f9e31bb858cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb01e746260>]}
[0m04:58:40.966679 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:58:40.974185 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:58:41.060037 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:58:41.064012 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:58:41.067313 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:58:41.088877 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:58:41.091010 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:58:41.092312 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:58:41.096204 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:58:41.100919 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:58:41.106158 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:58:41.133804 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:58:41.148710 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:58:41.167625 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:58:41.174239 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:58:41.177076 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:58:41.180920 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:58:41.184447 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:58:41.188569 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:58:41.191926 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:58:41.195094 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:58:41.197920 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:58:41.203599 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:58:41.206796 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:58:41.210368 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:58:41.213288 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:58:41.216920 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:58:41.224472 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:58:41.227936 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:58:41.230916 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:58:41.233877 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:58:41.237597 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:58:41.240006 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:58:41.243173 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:58:41.248349 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:58:41.256019 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:58:41.260485 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:58:41.264933 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:58:41.267109 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:58:41.269610 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:58:41.272196 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:58:41.279383 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:58:41.292241 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:58:41.330205 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:58:41.370071 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:58:41.375261 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:58:41.431114 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:58:41.478928 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:58:41.493437 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:58:41.524592 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:58:41.529743 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:58:41.580193 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:58:41.589834 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:58:41.608070 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:58:41.619290 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:58:41.626670 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:58:41.630537 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:58:41.648490 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:58:41.654135 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:58:41.659786 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:58:41.674825 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:58:41.697364 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:58:41.754665 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:58:41.800017 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:58:41.822858 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:58:41.854784 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:58:41.861781 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:58:41.912778 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:58:41.930047 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:58:41.940682 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:58:41.949309 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:58:42.712413 [debug] [MainThread]: 1699: static parser successfully parsed int/int__test.sql
[0m04:58:42.748879 [debug] [MainThread]: 1699: static parser successfully parsed stg/stg__test.sql
[0m04:58:42.824848 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.stg
- models.int

[0m04:58:42.840787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '604cd3e3-3d86-40fe-9236-f9e31bb858cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb01e669120>]}
[0m04:58:42.856322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '604cd3e3-3d86-40fe-9236-f9e31bb858cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb01e746110>]}
[0m04:58:42.857089 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:58:42.857611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '604cd3e3-3d86-40fe-9236-f9e31bb858cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb02001fc40>]}
[0m04:58:42.860239 [info ] [MainThread]: 
[0m04:58:42.861538 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:58:42.863952 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:58:42.898273 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:58:42.898779 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:58:42.899053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:58:42.928451 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.03 seconds
[0m04:58:42.932617 [debug] [ThreadPool]: On list_ffd: Close
[0m04:58:42.934844 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_stg"
[0m04:58:42.936128 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_stg"
[0m04:58:42.936946 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='ffd', schema='stg', identifier=None)"
[0m04:58:42.956174 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg"
[0m04:58:42.956684 [debug] [ThreadPool]: On create_ffd_stg: BEGIN
[0m04:58:42.956951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:58:42.978637 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m04:58:42.979357 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg"
[0m04:58:42.980045 [debug] [ThreadPool]: On create_ffd_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "create_ffd_stg"} */
create schema if not exists "stg"
[0m04:58:42.981472 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m04:58:42.984833 [debug] [ThreadPool]: On create_ffd_stg: COMMIT
[0m04:58:42.985473 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg"
[0m04:58:42.986000 [debug] [ThreadPool]: On create_ffd_stg: COMMIT
[0m04:58:43.000937 [debug] [ThreadPool]: SQL status: COMMIT in 0.01 seconds
[0m04:58:43.002008 [debug] [ThreadPool]: On create_ffd_stg: Close
[0m04:58:43.006744 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_stg"
[0m04:58:43.031393 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg"
[0m04:58:43.031933 [debug] [ThreadPool]: On list_ffd_stg: BEGIN
[0m04:58:43.032203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:58:43.060902 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m04:58:43.061483 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg"
[0m04:58:43.062109 [debug] [ThreadPool]: On list_ffd_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd_stg"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
  
[0m04:58:43.069049 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m04:58:43.074071 [debug] [ThreadPool]: On list_ffd_stg: ROLLBACK
[0m04:58:43.075033 [debug] [ThreadPool]: On list_ffd_stg: Close
[0m04:58:43.092583 [debug] [MainThread]: Using postgres connection "master"
[0m04:58:43.093239 [debug] [MainThread]: On master: BEGIN
[0m04:58:43.093631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:58:43.119072 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:58:43.119584 [debug] [MainThread]: Using postgres connection "master"
[0m04:58:43.119873 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:58:43.132368 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m04:58:43.137110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '604cd3e3-3d86-40fe-9236-f9e31bb858cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb01e717ac0>]}
[0m04:58:43.138056 [debug] [MainThread]: On master: ROLLBACK
[0m04:58:43.139040 [debug] [MainThread]: Using postgres connection "master"
[0m04:58:43.139537 [debug] [MainThread]: On master: BEGIN
[0m04:58:43.140589 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:58:43.141064 [debug] [MainThread]: On master: COMMIT
[0m04:58:43.141508 [debug] [MainThread]: Using postgres connection "master"
[0m04:58:43.141943 [debug] [MainThread]: On master: COMMIT
[0m04:58:43.142664 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:58:43.143122 [debug] [MainThread]: On master: Close
[0m04:58:43.144284 [info ] [MainThread]: Concurrency: 1 threads (target='stg')
[0m04:58:43.145029 [info ] [MainThread]: 
[0m04:58:43.153749 [debug] [Thread-1 (]: Began running node model.ffd.int__test
[0m04:58:43.154807 [info ] [Thread-1 (]: 1 of 2 START view model stg.int__test .......................................... [RUN]
[0m04:58:43.156249 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.int__test"
[0m04:58:43.156696 [debug] [Thread-1 (]: Began compiling node model.ffd.int__test
[0m04:58:43.157190 [debug] [Thread-1 (]: Compiling model.ffd.int__test
[0m04:58:43.163384 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.int__test"
[0m04:58:43.164577 [debug] [Thread-1 (]: finished collecting timing info
[0m04:58:43.164949 [debug] [Thread-1 (]: Began executing node model.ffd.int__test
[0m04:58:43.282249 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.int__test"
[0m04:58:43.283262 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:58:43.283556 [debug] [Thread-1 (]: On model.ffd.int__test: BEGIN
[0m04:58:43.283899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:58:43.311587 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:58:43.312131 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:58:43.312402 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */

  create view "ffd"."stg"."int__test__dbt_tmp" as (
    SELECT 3
UNION
SELECT 4
  );
[0m04:58:43.317560 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:58:43.341127 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:58:43.341624 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
alter table "ffd"."stg"."int__test__dbt_tmp" rename to "int__test"
[0m04:58:43.343000 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:58:43.398963 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m04:58:43.399474 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:58:43.399747 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m04:58:43.409968 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:58:43.429602 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:58:43.430126 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
drop view if exists "ffd"."stg"."int__test__dbt_backup" cascade
[0m04:58:43.431198 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:58:43.433932 [debug] [Thread-1 (]: finished collecting timing info
[0m04:58:43.434407 [debug] [Thread-1 (]: On model.ffd.int__test: Close
[0m04:58:43.435487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '604cd3e3-3d86-40fe-9236-f9e31bb858cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb01e700e20>]}
[0m04:58:43.436568 [info ] [Thread-1 (]: 1 of 2 OK created view model stg.int__test ..................................... [[32mCREATE VIEW[0m in 0.28s]
[0m04:58:43.437755 [debug] [Thread-1 (]: Finished running node model.ffd.int__test
[0m04:58:43.438480 [debug] [Thread-1 (]: Began running node model.ffd.stg__test
[0m04:58:43.439396 [info ] [Thread-1 (]: 2 of 2 START view model stg.stg__test .......................................... [RUN]
[0m04:58:43.440576 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.stg__test"
[0m04:58:43.441033 [debug] [Thread-1 (]: Began compiling node model.ffd.stg__test
[0m04:58:43.441357 [debug] [Thread-1 (]: Compiling model.ffd.stg__test
[0m04:58:43.445688 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.stg__test"
[0m04:58:43.446684 [debug] [Thread-1 (]: finished collecting timing info
[0m04:58:43.447013 [debug] [Thread-1 (]: Began executing node model.ffd.stg__test
[0m04:58:43.457270 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.stg__test"
[0m04:58:43.458230 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:58:43.458521 [debug] [Thread-1 (]: On model.ffd.stg__test: BEGIN
[0m04:58:43.458789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:58:43.481319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m04:58:43.482142 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:58:43.482768 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */

  create view "ffd"."stg"."stg__test__dbt_tmp" as (
    SELECT 1
UNION
SELECT 2
  );
[0m04:58:43.487644 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:58:43.497945 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:58:43.498541 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."stg"."stg__test__dbt_tmp" rename to "stg__test"
[0m04:58:43.500106 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:58:43.504126 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m04:58:43.504536 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:58:43.504802 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m04:58:43.518162 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:58:43.530908 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:58:43.531523 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
drop view if exists "ffd"."stg"."stg__test__dbt_backup" cascade
[0m04:58:43.532646 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:58:43.535272 [debug] [Thread-1 (]: finished collecting timing info
[0m04:58:43.535728 [debug] [Thread-1 (]: On model.ffd.stg__test: Close
[0m04:58:43.536829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '604cd3e3-3d86-40fe-9236-f9e31bb858cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb01ddc86d0>]}
[0m04:58:43.537834 [info ] [Thread-1 (]: 2 of 2 OK created view model stg.stg__test ..................................... [[32mCREATE VIEW[0m in 0.10s]
[0m04:58:43.538955 [debug] [Thread-1 (]: Finished running node model.ffd.stg__test
[0m04:58:43.541782 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:58:43.542651 [debug] [MainThread]: Using postgres connection "master"
[0m04:58:43.543180 [debug] [MainThread]: On master: BEGIN
[0m04:58:43.543683 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:58:43.568792 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:58:43.569505 [debug] [MainThread]: On master: COMMIT
[0m04:58:43.569955 [debug] [MainThread]: Using postgres connection "master"
[0m04:58:43.570400 [debug] [MainThread]: On master: COMMIT
[0m04:58:43.571124 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:58:43.571574 [debug] [MainThread]: On master: Close
[0m04:58:43.572973 [info ] [MainThread]: 
[0m04:58:43.573910 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m04:58:43.574940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:58:43.575421 [debug] [MainThread]: Connection 'model.ffd.stg__test' was properly closed.
[0m04:58:43.592252 [info ] [MainThread]: 
[0m04:58:43.592897 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:58:43.593515 [info ] [MainThread]: 
[0m04:58:43.594021 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:58:43.594763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb01ddc8250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb01ddc80a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb01ddafa90>]}
[0m04:58:43.595344 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 04:59:32.058446 | 632e13b6-65c4-412d-ad86-50687dffc194 ==============================
[0m04:59:32.058485 [info ] [MainThread]: Running with dbt=1.2.3
[0m04:59:32.059400 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'fail_fast': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:59:32.059902 [debug] [MainThread]: Tracking: tracking
[0m04:59:32.065333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0409bb5210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0409b7e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0409b7fe20>]}
[0m04:59:32.121465 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:59:32.122356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '632e13b6-65c4-412d-ad86-50687dffc194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0409b86380>]}
[0m04:59:32.160999 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:59:32.168581 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:59:32.252930 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:59:32.258124 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:59:32.262127 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:59:32.285042 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:59:32.287038 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:59:32.288356 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:59:32.292230 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:59:32.296811 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:59:32.302056 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:59:32.329116 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:59:32.343628 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:59:32.361734 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:59:32.368325 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:59:32.371109 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:59:32.375019 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:59:32.378354 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:59:32.382316 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:59:32.386113 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:59:32.389492 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:59:32.392334 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:59:32.397999 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:59:32.401245 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:59:32.404634 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:59:32.407654 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:59:32.411078 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:59:32.418352 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:59:32.421718 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:59:32.424476 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:59:32.427280 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:59:32.431062 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:59:32.433490 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:59:32.436716 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:59:32.442285 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:59:32.449935 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:59:32.454402 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:59:32.458719 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:59:32.460784 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:59:32.463319 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:59:32.465953 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:59:32.473567 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:59:32.485895 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:59:32.523553 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:59:32.563296 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:59:32.568500 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:59:32.624321 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:59:32.672018 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:59:32.686513 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:59:32.717319 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:59:32.722430 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:59:32.772413 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:59:32.781694 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:59:32.800385 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:59:32.811210 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:59:32.818298 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:59:32.822673 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:59:32.839991 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:59:32.846163 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:59:32.851949 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:59:32.866994 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:59:32.889498 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:59:32.946578 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:59:32.991818 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:59:33.014471 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:59:33.047487 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:59:33.054360 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:59:33.099455 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:59:33.114100 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:59:33.123278 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:59:33.131821 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:59:33.892096 [debug] [MainThread]: 1699: static parser successfully parsed int/int__test.sql
[0m04:59:33.928987 [debug] [MainThread]: 1699: static parser successfully parsed stg/stg__test.sql
[0m04:59:34.005062 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.int
- models.stg

[0m04:59:34.021069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '632e13b6-65c4-412d-ad86-50687dffc194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0409abd2d0>]}
[0m04:59:34.038097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '632e13b6-65c4-412d-ad86-50687dffc194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0409b7e590>]}
[0m04:59:34.039027 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m04:59:34.039861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '632e13b6-65c4-412d-ad86-50687dffc194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0409b94550>]}
[0m04:59:34.043049 [info ] [MainThread]: 
[0m04:59:34.044605 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:59:34.047081 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m04:59:34.082340 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m04:59:34.082925 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m04:59:34.083217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:59:34.110828 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
[0m04:59:34.114975 [debug] [ThreadPool]: On list_ffd: Close
[0m04:59:34.118928 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_stg"
[0m04:59:34.141170 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg"
[0m04:59:34.141661 [debug] [ThreadPool]: On list_ffd_stg: BEGIN
[0m04:59:34.141929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:59:34.164116 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m04:59:34.164726 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg"
[0m04:59:34.165079 [debug] [ThreadPool]: On list_ffd_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd_stg"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
  
[0m04:59:34.173516 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.01 seconds
[0m04:59:34.178237 [debug] [ThreadPool]: On list_ffd_stg: ROLLBACK
[0m04:59:34.179373 [debug] [ThreadPool]: On list_ffd_stg: Close
[0m04:59:34.196023 [debug] [MainThread]: Using postgres connection "master"
[0m04:59:34.196632 [debug] [MainThread]: On master: BEGIN
[0m04:59:34.196988 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:59:34.221296 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m04:59:34.221964 [debug] [MainThread]: Using postgres connection "master"
[0m04:59:34.222363 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:59:34.236873 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m04:59:34.241242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '632e13b6-65c4-412d-ad86-50687dffc194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0409abd780>]}
[0m04:59:34.242283 [debug] [MainThread]: On master: ROLLBACK
[0m04:59:34.243253 [debug] [MainThread]: Using postgres connection "master"
[0m04:59:34.243566 [debug] [MainThread]: On master: BEGIN
[0m04:59:34.244437 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:59:34.244787 [debug] [MainThread]: On master: COMMIT
[0m04:59:34.245107 [debug] [MainThread]: Using postgres connection "master"
[0m04:59:34.245452 [debug] [MainThread]: On master: COMMIT
[0m04:59:34.246010 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:59:34.246359 [debug] [MainThread]: On master: Close
[0m04:59:34.247306 [info ] [MainThread]: Concurrency: 1 threads (target='stg')
[0m04:59:34.248160 [info ] [MainThread]: 
[0m04:59:34.256412 [debug] [Thread-1 (]: Began running node model.ffd.int__test
[0m04:59:34.257719 [info ] [Thread-1 (]: 1 of 2 START view model stg.int__test .......................................... [RUN]
[0m04:59:34.259506 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.int__test"
[0m04:59:34.259991 [debug] [Thread-1 (]: Began compiling node model.ffd.int__test
[0m04:59:34.260339 [debug] [Thread-1 (]: Compiling model.ffd.int__test
[0m04:59:34.268554 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.int__test"
[0m04:59:34.269493 [debug] [Thread-1 (]: finished collecting timing info
[0m04:59:34.269861 [debug] [Thread-1 (]: Began executing node model.ffd.int__test
[0m04:59:34.387856 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.int__test"
[0m04:59:34.388875 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:59:34.389211 [debug] [Thread-1 (]: On model.ffd.int__test: BEGIN
[0m04:59:34.389487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:59:34.416358 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:59:34.416955 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:59:34.417562 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */

  create view "ffd"."stg"."int__test__dbt_tmp" as (
    SELECT 3
UNION
SELECT 4
  );
[0m04:59:34.423305 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m04:59:34.446717 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:59:34.447209 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
alter table "ffd"."stg"."int__test" rename to "int__test__dbt_backup"
[0m04:59:34.448720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:59:34.455070 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:59:34.455534 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
alter table "ffd"."stg"."int__test__dbt_tmp" rename to "int__test"
[0m04:59:34.457280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:59:34.521418 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m04:59:34.521926 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:59:34.522197 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m04:59:34.527192 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:59:34.545634 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m04:59:34.546126 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
drop view if exists "ffd"."stg"."int__test__dbt_backup" cascade
[0m04:59:34.560844 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m04:59:34.564839 [debug] [Thread-1 (]: finished collecting timing info
[0m04:59:34.565640 [debug] [Thread-1 (]: On model.ffd.int__test: Close
[0m04:59:34.567433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '632e13b6-65c4-412d-ad86-50687dffc194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04091b1570>]}
[0m04:59:34.569111 [info ] [Thread-1 (]: 1 of 2 OK created view model stg.int__test ..................................... [[32mCREATE VIEW[0m in 0.31s]
[0m04:59:34.571019 [debug] [Thread-1 (]: Finished running node model.ffd.int__test
[0m04:59:34.572147 [debug] [Thread-1 (]: Began running node model.ffd.stg__test
[0m04:59:34.573694 [info ] [Thread-1 (]: 2 of 2 START view model stg.stg__test .......................................... [RUN]
[0m04:59:34.575535 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.stg__test"
[0m04:59:34.576206 [debug] [Thread-1 (]: Began compiling node model.ffd.stg__test
[0m04:59:34.576513 [debug] [Thread-1 (]: Compiling model.ffd.stg__test
[0m04:59:34.580843 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.stg__test"
[0m04:59:34.581745 [debug] [Thread-1 (]: finished collecting timing info
[0m04:59:34.582119 [debug] [Thread-1 (]: Began executing node model.ffd.stg__test
[0m04:59:34.592387 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.stg__test"
[0m04:59:34.593344 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:59:34.593678 [debug] [Thread-1 (]: On model.ffd.stg__test: BEGIN
[0m04:59:34.593942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:59:34.621101 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:59:34.621707 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:59:34.622344 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */

  create view "ffd"."stg"."stg__test__dbt_tmp" as (
    SELECT 1
UNION
SELECT 2
  );
[0m04:59:34.626979 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:59:34.636917 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:59:34.637534 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."stg"."stg__test" rename to "stg__test__dbt_backup"
[0m04:59:34.639275 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:59:34.650231 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:59:34.650709 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."stg"."stg__test__dbt_tmp" rename to "stg__test"
[0m04:59:34.652081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:59:34.656675 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m04:59:34.657111 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:59:34.657380 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m04:59:34.669138 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:59:34.675626 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m04:59:34.676305 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
drop view if exists "ffd"."stg"."stg__test__dbt_backup" cascade
[0m04:59:34.685773 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.01 seconds
[0m04:59:34.690104 [debug] [Thread-1 (]: finished collecting timing info
[0m04:59:34.690764 [debug] [Thread-1 (]: On model.ffd.stg__test: Close
[0m04:59:34.692377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '632e13b6-65c4-412d-ad86-50687dffc194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0409b6d240>]}
[0m04:59:34.693775 [info ] [Thread-1 (]: 2 of 2 OK created view model stg.stg__test ..................................... [[32mCREATE VIEW[0m in 0.12s]
[0m04:59:34.695385 [debug] [Thread-1 (]: Finished running node model.ffd.stg__test
[0m04:59:34.698004 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:59:34.698543 [debug] [MainThread]: Using postgres connection "master"
[0m04:59:34.698816 [debug] [MainThread]: On master: BEGIN
[0m04:59:34.699078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:59:34.725687 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:59:34.726490 [debug] [MainThread]: On master: COMMIT
[0m04:59:34.727133 [debug] [MainThread]: Using postgres connection "master"
[0m04:59:34.727744 [debug] [MainThread]: On master: COMMIT
[0m04:59:34.728555 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:59:34.729039 [debug] [MainThread]: On master: Close
[0m04:59:34.730359 [info ] [MainThread]: 
[0m04:59:34.731316 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m04:59:34.732226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:59:34.732734 [debug] [MainThread]: Connection 'model.ffd.stg__test' was properly closed.
[0m04:59:34.750536 [info ] [MainThread]: 
[0m04:59:34.751183 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:59:34.751866 [info ] [MainThread]: 
[0m04:59:34.752395 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:59:34.753126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0409b6dcf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0409b6dc60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0409b6e200>]}
[0m04:59:34.753690 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 05:00:04.117510 | e28168c6-4baa-4387-8fd8-2fc02e56d406 ==============================
[0m05:00:04.117553 [info ] [MainThread]: Running with dbt=1.2.3
[0m05:00:04.118435 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'fail_fast': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:00:04.118860 [debug] [MainThread]: Tracking: tracking
[0m05:00:04.122481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e31ae1180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3339fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3339d750>]}
[0m05:00:04.178547 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m05:00:04.179392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e28168c6-4baa-4387-8fd8-2fc02e56d406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e31ac6380>]}
[0m05:00:04.217735 [debug] [MainThread]: Parsing macros/catalog.sql
[0m05:00:04.225308 [debug] [MainThread]: Parsing macros/adapters.sql
[0m05:00:04.312581 [debug] [MainThread]: Parsing macros/relations.sql
[0m05:00:04.317375 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:00:04.321043 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:00:04.343219 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:00:04.345208 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:00:04.346472 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:00:04.350273 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:00:04.354830 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m05:00:04.359988 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m05:00:04.387522 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m05:00:04.402159 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m05:00:04.420260 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:00:04.427147 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m05:00:04.430198 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:00:04.434318 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m05:00:04.437701 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:00:04.441697 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m05:00:04.445080 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m05:00:04.448399 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:00:04.451244 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:00:04.456839 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m05:00:04.460134 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m05:00:04.463849 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m05:00:04.467001 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m05:00:04.470247 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:00:04.477556 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m05:00:04.480879 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m05:00:04.483645 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m05:00:04.486593 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m05:00:04.490565 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m05:00:04.493211 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m05:00:04.496665 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m05:00:04.501858 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m05:00:04.509587 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m05:00:04.514086 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m05:00:04.518394 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m05:00:04.520410 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m05:00:04.522872 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m05:00:04.525460 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:00:04.533031 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:00:04.545167 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:00:04.582864 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m05:00:04.622519 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:00:04.627654 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:00:04.683550 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m05:00:04.732045 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m05:00:04.747157 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:00:04.778232 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m05:00:04.783653 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:00:04.834658 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:00:04.844238 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:00:04.862510 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:00:04.873461 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:00:04.880621 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m05:00:04.884574 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:00:04.902096 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m05:00:04.907841 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m05:00:04.913616 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m05:00:04.929050 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:00:04.951302 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:00:05.008712 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:00:05.054106 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:00:05.076954 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:00:05.108875 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:00:05.115646 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m05:00:05.160721 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:00:05.174771 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:00:05.184004 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:00:05.192683 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m05:00:05.948493 [debug] [MainThread]: 1699: static parser successfully parsed int/int__test.sql
[0m05:00:05.986482 [debug] [MainThread]: 1699: static parser successfully parsed stg/stg__test.sql
[0m05:00:06.081790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e28168c6-4baa-4387-8fd8-2fc02e56d406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e31ac6cb0>]}
[0m05:00:06.098759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e28168c6-4baa-4387-8fd8-2fc02e56d406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e319bff70>]}
[0m05:00:06.099547 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:00:06.100207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e28168c6-4baa-4387-8fd8-2fc02e56d406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3339fc40>]}
[0m05:00:06.103196 [info ] [MainThread]: 
[0m05:00:06.104650 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:00:06.107089 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m05:00:06.141364 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m05:00:06.141875 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m05:00:06.142151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:00:06.173518 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
[0m05:00:06.176961 [debug] [ThreadPool]: On list_ffd: Close
[0m05:00:06.178893 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m05:00:06.185427 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m05:00:06.185897 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m05:00:06.186157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:00:06.210870 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
[0m05:00:06.215419 [debug] [ThreadPool]: On list_ffd: Close
[0m05:00:06.218132 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_stg_int"
[0m05:00:06.219427 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_stg_int"
[0m05:00:06.220241 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='ffd', schema='stg_int', identifier=None)"
[0m05:00:06.235688 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg_int"
[0m05:00:06.236223 [debug] [ThreadPool]: On create_ffd_stg_int: BEGIN
[0m05:00:06.236491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:00:06.263099 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m05:00:06.263715 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg_int"
[0m05:00:06.264082 [debug] [ThreadPool]: On create_ffd_stg_int: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "create_ffd_stg_int"} */
create schema if not exists "stg_int"
[0m05:00:06.265745 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m05:00:06.269785 [debug] [ThreadPool]: On create_ffd_stg_int: COMMIT
[0m05:00:06.270551 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg_int"
[0m05:00:06.271173 [debug] [ThreadPool]: On create_ffd_stg_int: COMMIT
[0m05:00:06.282867 [debug] [ThreadPool]: SQL status: COMMIT in 0.01 seconds
[0m05:00:06.283584 [debug] [ThreadPool]: On create_ffd_stg_int: Close
[0m05:00:06.286143 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_stg_stg"
[0m05:00:06.287736 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_stg_stg"
[0m05:00:06.288736 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='ffd', schema='stg_stg', identifier=None)"
[0m05:00:06.296063 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg_stg"
[0m05:00:06.296543 [debug] [ThreadPool]: On create_ffd_stg_stg: BEGIN
[0m05:00:06.296808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:00:06.321866 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m05:00:06.322514 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg_stg"
[0m05:00:06.322910 [debug] [ThreadPool]: On create_ffd_stg_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "create_ffd_stg_stg"} */
create schema if not exists "stg_stg"
[0m05:00:06.324429 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m05:00:06.327113 [debug] [ThreadPool]: On create_ffd_stg_stg: COMMIT
[0m05:00:06.327572 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg_stg"
[0m05:00:06.328005 [debug] [ThreadPool]: On create_ffd_stg_stg: COMMIT
[0m05:00:06.332709 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m05:00:06.333455 [debug] [ThreadPool]: On create_ffd_stg_stg: Close
[0m05:00:06.337278 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_stg_int"
[0m05:00:06.358091 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_int"
[0m05:00:06.358582 [debug] [ThreadPool]: On list_ffd_stg_int: BEGIN
[0m05:00:06.358842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:00:06.381054 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m05:00:06.381692 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_int"
[0m05:00:06.382085 [debug] [ThreadPool]: On list_ffd_stg_int: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd_stg_int"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg_int'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg_int'
  
[0m05:00:06.390504 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m05:00:06.395917 [debug] [ThreadPool]: On list_ffd_stg_int: ROLLBACK
[0m05:00:06.397035 [debug] [ThreadPool]: On list_ffd_stg_int: Close
[0m05:00:06.398693 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_stg_stg"
[0m05:00:06.403910 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_stg"
[0m05:00:06.404413 [debug] [ThreadPool]: On list_ffd_stg_stg: BEGIN
[0m05:00:06.404696 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:00:06.430959 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m05:00:06.431464 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_stg"
[0m05:00:06.431731 [debug] [ThreadPool]: On list_ffd_stg_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd_stg_stg"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg_stg'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg_stg'
  
[0m05:00:06.440584 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m05:00:06.445329 [debug] [ThreadPool]: On list_ffd_stg_stg: ROLLBACK
[0m05:00:06.446422 [debug] [ThreadPool]: On list_ffd_stg_stg: Close
[0m05:00:06.464630 [debug] [MainThread]: Using postgres connection "master"
[0m05:00:06.465136 [debug] [MainThread]: On master: BEGIN
[0m05:00:06.465398 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:00:06.494093 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m05:00:06.494639 [debug] [MainThread]: Using postgres connection "master"
[0m05:00:06.495275 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:00:06.509195 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m05:00:06.513986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e28168c6-4baa-4387-8fd8-2fc02e56d406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e319b7a90>]}
[0m05:00:06.515040 [debug] [MainThread]: On master: ROLLBACK
[0m05:00:06.516007 [debug] [MainThread]: Using postgres connection "master"
[0m05:00:06.516314 [debug] [MainThread]: On master: BEGIN
[0m05:00:06.517137 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:00:06.517478 [debug] [MainThread]: On master: COMMIT
[0m05:00:06.517775 [debug] [MainThread]: Using postgres connection "master"
[0m05:00:06.518157 [debug] [MainThread]: On master: COMMIT
[0m05:00:06.518787 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:00:06.519230 [debug] [MainThread]: On master: Close
[0m05:00:06.520345 [info ] [MainThread]: Concurrency: 1 threads (target='stg')
[0m05:00:06.521216 [info ] [MainThread]: 
[0m05:00:06.528151 [debug] [Thread-1 (]: Began running node model.ffd.int__test
[0m05:00:06.529213 [info ] [Thread-1 (]: 1 of 2 START table model stg_int.int__test ..................................... [RUN]
[0m05:00:06.530383 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.int__test"
[0m05:00:06.530959 [debug] [Thread-1 (]: Began compiling node model.ffd.int__test
[0m05:00:06.531533 [debug] [Thread-1 (]: Compiling model.ffd.int__test
[0m05:00:06.537475 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.int__test"
[0m05:00:06.538444 [debug] [Thread-1 (]: finished collecting timing info
[0m05:00:06.538798 [debug] [Thread-1 (]: Began executing node model.ffd.int__test
[0m05:00:06.661165 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.int__test"
[0m05:00:06.662190 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:00:06.662482 [debug] [Thread-1 (]: On model.ffd.int__test: BEGIN
[0m05:00:06.662750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:00:06.687174 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m05:00:06.687685 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:00:06.687981 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */


  create  table "ffd"."stg_int"."int__test__dbt_tmp"
  as (
    SELECT 3
UNION
SELECT 4
  );
[0m05:00:06.692823 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m05:00:06.714964 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:00:06.715472 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
alter table "ffd"."stg_int"."int__test__dbt_tmp" rename to "int__test"
[0m05:00:06.716929 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:00:06.788372 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m05:00:06.788957 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:00:06.789300 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m05:00:06.799856 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m05:00:06.820739 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:00:06.821252 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
drop table if exists "ffd"."stg_int"."int__test__dbt_backup" cascade
[0m05:00:06.822143 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m05:00:06.824831 [debug] [Thread-1 (]: finished collecting timing info
[0m05:00:06.825312 [debug] [Thread-1 (]: On model.ffd.int__test: Close
[0m05:00:06.826381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e28168c6-4baa-4387-8fd8-2fc02e56d406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3113bc10>]}
[0m05:00:06.827373 [info ] [Thread-1 (]: 1 of 2 OK created table model stg_int.int__test ................................ [[32mSELECT 2[0m in 0.30s]
[0m05:00:06.828681 [debug] [Thread-1 (]: Finished running node model.ffd.int__test
[0m05:00:06.829416 [debug] [Thread-1 (]: Began running node model.ffd.stg__test
[0m05:00:06.830333 [info ] [Thread-1 (]: 2 of 2 START table model stg_stg.stg__test ..................................... [RUN]
[0m05:00:06.831435 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.stg__test"
[0m05:00:06.831927 [debug] [Thread-1 (]: Began compiling node model.ffd.stg__test
[0m05:00:06.832232 [debug] [Thread-1 (]: Compiling model.ffd.stg__test
[0m05:00:06.836593 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.stg__test"
[0m05:00:06.837559 [debug] [Thread-1 (]: finished collecting timing info
[0m05:00:06.837897 [debug] [Thread-1 (]: Began executing node model.ffd.stg__test
[0m05:00:06.847935 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.stg__test"
[0m05:00:06.848888 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:00:06.849177 [debug] [Thread-1 (]: On model.ffd.stg__test: BEGIN
[0m05:00:06.849441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:00:06.872908 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m05:00:06.873420 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:00:06.873692 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */


  create  table "ffd"."stg_stg"."stg__test__dbt_tmp"
  as (
    SELECT 1
UNION
SELECT 2
  );
[0m05:00:06.878088 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m05:00:06.887108 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:00:06.887771 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."stg_stg"."stg__test__dbt_tmp" rename to "stg__test"
[0m05:00:06.889056 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:00:06.893708 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m05:00:06.894147 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:00:06.894412 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m05:00:06.908119 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m05:00:06.914017 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:00:06.914669 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
drop table if exists "ffd"."stg_stg"."stg__test__dbt_backup" cascade
[0m05:00:06.915992 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m05:00:06.920054 [debug] [Thread-1 (]: finished collecting timing info
[0m05:00:06.920547 [debug] [Thread-1 (]: On model.ffd.stg__test: Close
[0m05:00:06.921600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e28168c6-4baa-4387-8fd8-2fc02e56d406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e31a0be80>]}
[0m05:00:06.922615 [info ] [Thread-1 (]: 2 of 2 OK created table model stg_stg.stg__test ................................ [[32mSELECT 2[0m in 0.09s]
[0m05:00:06.923909 [debug] [Thread-1 (]: Finished running node model.ffd.stg__test
[0m05:00:06.926547 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:00:06.927121 [debug] [MainThread]: Using postgres connection "master"
[0m05:00:06.927412 [debug] [MainThread]: On master: BEGIN
[0m05:00:06.927695 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:00:06.954059 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m05:00:06.954590 [debug] [MainThread]: On master: COMMIT
[0m05:00:06.954864 [debug] [MainThread]: Using postgres connection "master"
[0m05:00:06.955129 [debug] [MainThread]: On master: COMMIT
[0m05:00:06.955599 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:00:06.955920 [debug] [MainThread]: On master: Close
[0m05:00:06.956875 [info ] [MainThread]: 
[0m05:00:06.957593 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m05:00:06.958233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:00:06.958612 [debug] [MainThread]: Connection 'model.ffd.stg__test' was properly closed.
[0m05:00:06.976769 [info ] [MainThread]: 
[0m05:00:06.977414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:00:06.978034 [info ] [MainThread]: 
[0m05:00:06.978541 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:00:06.979285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e31a2ada0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e319cd660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e31a42cb0>]}
[0m05:00:06.979877 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 05:01:53.096443 | e189112c-8882-41f6-ba08-58b3415a41db ==============================
[0m05:01:53.096483 [info ] [MainThread]: Running with dbt=1.2.3
[0m05:01:53.097396 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'fail_fast': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:01:53.097851 [debug] [MainThread]: Tracking: tracking
[0m05:01:53.101679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9571f51180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f957380d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f957380faf0>]}
[0m05:01:53.157748 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m05:01:53.158603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e189112c-8882-41f6-ba08-58b3415a41db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9571f36200>]}
[0m05:01:53.197155 [debug] [MainThread]: Parsing macros/catalog.sql
[0m05:01:53.204634 [debug] [MainThread]: Parsing macros/adapters.sql
[0m05:01:53.292549 [debug] [MainThread]: Parsing macros/relations.sql
[0m05:01:53.296547 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:01:53.299912 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:01:53.320872 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:01:53.322886 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:01:53.324209 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:01:53.328089 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:01:53.332749 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m05:01:53.337884 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m05:01:53.365049 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m05:01:53.379485 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m05:01:53.397878 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:01:53.404533 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m05:01:53.407438 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:01:53.411438 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m05:01:53.415070 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:01:53.419166 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m05:01:53.422762 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m05:01:53.426073 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:01:53.428867 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:01:53.434483 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m05:01:53.437659 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m05:01:53.440966 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m05:01:53.444118 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m05:01:53.447716 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:01:53.455362 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m05:01:53.458812 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m05:01:53.461682 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m05:01:53.464517 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m05:01:53.468374 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m05:01:53.470842 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m05:01:53.474333 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m05:01:53.480086 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m05:01:53.488062 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m05:01:53.492660 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m05:01:53.497018 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m05:01:53.499041 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m05:01:53.501498 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m05:01:53.504110 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:01:53.511579 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:01:53.523978 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:01:53.562672 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m05:01:53.602359 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:01:53.607480 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:01:53.664426 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m05:01:53.713281 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m05:01:53.728072 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:01:53.759448 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m05:01:53.764446 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:01:53.815154 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:01:53.824948 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:01:53.842877 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:01:53.854512 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:01:53.861903 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m05:01:53.865938 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:01:53.883642 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m05:01:53.889357 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m05:01:53.895105 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m05:01:53.910531 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:01:53.932669 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:01:53.989815 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:01:54.035597 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:01:54.059262 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:01:54.091994 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:01:54.098891 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m05:01:54.144205 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:01:54.158320 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:01:54.167504 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:01:54.176474 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m05:01:54.944888 [debug] [MainThread]: 1699: static parser successfully parsed int/int__test.sql
[0m05:01:54.983521 [debug] [MainThread]: 1699: static parser successfully parsed stg/stg__test.sql
[0m05:01:55.076933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e189112c-8882-41f6-ba08-58b3415a41db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9571f500a0>]}
[0m05:01:55.093125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e189112c-8882-41f6-ba08-58b3415a41db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9571e2ff70>]}
[0m05:01:55.093901 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:01:55.094436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e189112c-8882-41f6-ba08-58b3415a41db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f957380d750>]}
[0m05:01:55.097087 [info ] [MainThread]: 
[0m05:01:55.098320 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:01:55.100600 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m05:01:55.135339 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m05:01:55.135933 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m05:01:55.136232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:01:55.162202 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.03 seconds
[0m05:01:55.166538 [debug] [ThreadPool]: On list_ffd: Close
[0m05:01:55.168764 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m05:01:55.175040 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m05:01:55.175513 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m05:01:55.175818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:01:55.200110 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.02 seconds
[0m05:01:55.202979 [debug] [ThreadPool]: On list_ffd: Close
[0m05:01:55.206412 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_stg_int"
[0m05:01:55.227552 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_int"
[0m05:01:55.228113 [debug] [ThreadPool]: On list_ffd_stg_int: BEGIN
[0m05:01:55.228384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:01:55.255473 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m05:01:55.256160 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_int"
[0m05:01:55.256585 [debug] [ThreadPool]: On list_ffd_stg_int: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd_stg_int"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg_int'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg_int'
  
[0m05:01:55.265443 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m05:01:55.269139 [debug] [ThreadPool]: On list_ffd_stg_int: ROLLBACK
[0m05:01:55.269995 [debug] [ThreadPool]: On list_ffd_stg_int: Close
[0m05:01:55.271375 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_stg_stg"
[0m05:01:55.278523 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_stg"
[0m05:01:55.279041 [debug] [ThreadPool]: On list_ffd_stg_stg: BEGIN
[0m05:01:55.279348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:01:55.301027 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m05:01:55.301704 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_stg"
[0m05:01:55.302127 [debug] [ThreadPool]: On list_ffd_stg_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd_stg_stg"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg_stg'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg_stg'
  
[0m05:01:55.310151 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m05:01:55.314646 [debug] [ThreadPool]: On list_ffd_stg_stg: ROLLBACK
[0m05:01:55.315752 [debug] [ThreadPool]: On list_ffd_stg_stg: Close
[0m05:01:55.331466 [debug] [MainThread]: Using postgres connection "master"
[0m05:01:55.332031 [debug] [MainThread]: On master: BEGIN
[0m05:01:55.332309 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:01:55.360092 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m05:01:55.360934 [debug] [MainThread]: Using postgres connection "master"
[0m05:01:55.361576 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:01:55.377824 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
[0m05:01:55.383521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e189112c-8882-41f6-ba08-58b3415a41db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9571e7e290>]}
[0m05:01:55.384448 [debug] [MainThread]: On master: ROLLBACK
[0m05:01:55.385556 [debug] [MainThread]: Using postgres connection "master"
[0m05:01:55.385945 [debug] [MainThread]: On master: BEGIN
[0m05:01:55.386736 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:01:55.387174 [debug] [MainThread]: On master: COMMIT
[0m05:01:55.387571 [debug] [MainThread]: Using postgres connection "master"
[0m05:01:55.387947 [debug] [MainThread]: On master: COMMIT
[0m05:01:55.388577 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:01:55.388987 [debug] [MainThread]: On master: Close
[0m05:01:55.390028 [info ] [MainThread]: Concurrency: 1 threads (target='stg')
[0m05:01:55.390897 [info ] [MainThread]: 
[0m05:01:55.398778 [debug] [Thread-1 (]: Began running node model.ffd.int__test
[0m05:01:55.399764 [info ] [Thread-1 (]: 1 of 2 START table model stg_int.int__test ..................................... [RUN]
[0m05:01:55.400907 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.int__test"
[0m05:01:55.401440 [debug] [Thread-1 (]: Began compiling node model.ffd.int__test
[0m05:01:55.401888 [debug] [Thread-1 (]: Compiling model.ffd.int__test
[0m05:01:55.407217 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.int__test"
[0m05:01:55.408510 [debug] [Thread-1 (]: finished collecting timing info
[0m05:01:55.409130 [debug] [Thread-1 (]: Began executing node model.ffd.int__test
[0m05:01:55.534633 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.int__test"
[0m05:01:55.535665 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:01:55.536054 [debug] [Thread-1 (]: On model.ffd.int__test: BEGIN
[0m05:01:55.536330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:01:55.561297 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m05:01:55.561820 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:01:55.562095 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */


  create  table "ffd"."stg_int"."int__test__dbt_tmp"
  as (
    SELECT 3
UNION
SELECT 4
  );
[0m05:01:55.567896 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m05:01:55.590010 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:01:55.590512 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
alter table "ffd"."stg_int"."int__test" rename to "int__test__dbt_backup"
[0m05:01:55.592210 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:01:55.600215 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:01:55.600781 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
alter table "ffd"."stg_int"."int__test__dbt_tmp" rename to "int__test"
[0m05:01:55.602152 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:01:55.676400 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m05:01:55.676920 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:01:55.677201 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m05:01:55.693336 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m05:01:55.711984 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:01:55.712479 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
drop table if exists "ffd"."stg_int"."int__test__dbt_backup" cascade
[0m05:01:55.727285 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m05:01:55.733328 [debug] [Thread-1 (]: finished collecting timing info
[0m05:01:55.734254 [debug] [Thread-1 (]: On model.ffd.int__test: Close
[0m05:01:55.736320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e189112c-8882-41f6-ba08-58b3415a41db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9571733460>]}
[0m05:01:55.737579 [info ] [Thread-1 (]: 1 of 2 OK created table model stg_int.int__test ................................ [[32mSELECT 2[0m in 0.34s]
[0m05:01:55.739212 [debug] [Thread-1 (]: Finished running node model.ffd.int__test
[0m05:01:55.740127 [debug] [Thread-1 (]: Began running node model.ffd.stg__test
[0m05:01:55.741262 [info ] [Thread-1 (]: 2 of 2 START table model stg_stg.stg__test ..................................... [RUN]
[0m05:01:55.742584 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.stg__test"
[0m05:01:55.743135 [debug] [Thread-1 (]: Began compiling node model.ffd.stg__test
[0m05:01:55.743523 [debug] [Thread-1 (]: Compiling model.ffd.stg__test
[0m05:01:55.747999 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.stg__test"
[0m05:01:55.748925 [debug] [Thread-1 (]: finished collecting timing info
[0m05:01:55.749257 [debug] [Thread-1 (]: Began executing node model.ffd.stg__test
[0m05:01:55.762579 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.stg__test"
[0m05:01:55.763538 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:01:55.763873 [debug] [Thread-1 (]: On model.ffd.stg__test: BEGIN
[0m05:01:55.764142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:01:55.792218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:01:55.792732 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:01:55.793004 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */


  create  table "ffd"."stg_stg"."stg__test__dbt_tmp"
  as (
    SELECT 1
UNION
SELECT 2
  );
[0m05:01:55.797610 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m05:01:55.808866 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:01:55.809433 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."stg_stg"."stg__test" rename to "stg__test__dbt_backup"
[0m05:01:55.810781 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:01:55.818599 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:01:55.819179 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."stg_stg"."stg__test__dbt_tmp" rename to "stg__test"
[0m05:01:55.820502 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:01:55.825701 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m05:01:55.826145 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:01:55.826416 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m05:01:55.834920 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m05:01:55.841932 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:01:55.842599 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
drop table if exists "ffd"."stg_stg"."stg__test__dbt_backup" cascade
[0m05:01:55.852102 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m05:01:55.856398 [debug] [Thread-1 (]: finished collecting timing info
[0m05:01:55.857096 [debug] [Thread-1 (]: On model.ffd.stg__test: Close
[0m05:01:55.858640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e189112c-8882-41f6-ba08-58b3415a41db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f957173a620>]}
[0m05:01:55.860095 [info ] [Thread-1 (]: 2 of 2 OK created table model stg_stg.stg__test ................................ [[32mSELECT 2[0m in 0.12s]
[0m05:01:55.861480 [debug] [Thread-1 (]: Finished running node model.ffd.stg__test
[0m05:01:55.864395 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:01:55.865062 [debug] [MainThread]: Using postgres connection "master"
[0m05:01:55.865462 [debug] [MainThread]: On master: BEGIN
[0m05:01:55.865813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:01:55.892142 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m05:01:55.892893 [debug] [MainThread]: On master: COMMIT
[0m05:01:55.893355 [debug] [MainThread]: Using postgres connection "master"
[0m05:01:55.893804 [debug] [MainThread]: On master: COMMIT
[0m05:01:55.894648 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:01:55.895181 [debug] [MainThread]: On master: Close
[0m05:01:55.896604 [info ] [MainThread]: 
[0m05:01:55.897576 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m05:01:55.898520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:01:55.899027 [debug] [MainThread]: Connection 'model.ffd.stg__test' was properly closed.
[0m05:01:55.916458 [info ] [MainThread]: 
[0m05:01:55.917096 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:01:55.917730 [info ] [MainThread]: 
[0m05:01:55.918245 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:01:55.918969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f957179be20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f957179a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9571739db0>]}
[0m05:01:55.919542 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 05:02:40.320356 | e059774b-c9ac-4d51-8eac-79b315ed397a ==============================
[0m05:02:40.320394 [info ] [MainThread]: Running with dbt=1.2.3
[0m05:02:40.321302 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'fail_fast': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:02:40.321747 [debug] [MainThread]: Tracking: tracking
[0m05:02:40.325103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28efe191b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28efde2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28efde2470>]}
[0m05:02:40.380976 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m05:02:40.381873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e059774b-c9ac-4d51-8eac-79b315ed397a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28efdea200>]}
[0m05:02:40.419910 [debug] [MainThread]: Parsing macros/catalog.sql
[0m05:02:40.427377 [debug] [MainThread]: Parsing macros/adapters.sql
[0m05:02:40.511342 [debug] [MainThread]: Parsing macros/relations.sql
[0m05:02:40.516564 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:02:40.520569 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:02:40.543731 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:02:40.545865 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:02:40.547131 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:02:40.551004 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:02:40.555595 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m05:02:40.560727 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m05:02:40.587857 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m05:02:40.602349 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m05:02:40.620311 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:02:40.626918 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m05:02:40.629690 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:02:40.633561 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m05:02:40.636871 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:02:40.640975 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m05:02:40.644513 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m05:02:40.647694 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:02:40.650485 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:02:40.656106 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m05:02:40.659237 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m05:02:40.662451 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m05:02:40.665243 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m05:02:40.668679 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:02:40.676466 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m05:02:40.679826 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m05:02:40.682564 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m05:02:40.685448 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m05:02:40.689331 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m05:02:40.692005 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m05:02:40.695360 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m05:02:40.700714 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m05:02:40.708468 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m05:02:40.713378 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m05:02:40.717817 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m05:02:40.719826 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m05:02:40.722237 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m05:02:40.724809 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:02:40.732116 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:02:40.744888 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:02:40.782346 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m05:02:40.822160 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:02:40.827264 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:02:40.886636 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m05:02:40.937718 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m05:02:40.953386 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:02:40.987369 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m05:02:40.993026 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:02:41.047421 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:02:41.059365 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:02:41.078123 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:02:41.089140 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:02:41.096299 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m05:02:41.100334 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:02:41.117792 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m05:02:41.124722 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m05:02:41.130729 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m05:02:41.146014 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:02:41.168109 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:02:41.232331 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:02:41.276857 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:02:41.299084 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:02:41.331432 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:02:41.338388 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m05:02:41.382043 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:02:41.396414 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:02:41.405431 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:02:41.413780 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m05:02:42.175401 [debug] [MainThread]: 1699: static parser successfully parsed int/int__test.sql
[0m05:02:42.214191 [debug] [MainThread]: 1699: static parser successfully parsed stg/stg__test.sql
[0m05:02:42.307106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e059774b-c9ac-4d51-8eac-79b315ed397a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28efdeabf0>]}
[0m05:02:42.323170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e059774b-c9ac-4d51-8eac-79b315ed397a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28efe18100>]}
[0m05:02:42.323982 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:02:42.324520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e059774b-c9ac-4d51-8eac-79b315ed397a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28efdf9840>]}
[0m05:02:42.327103 [info ] [MainThread]: 
[0m05:02:42.328391 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:02:42.330726 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m05:02:42.365599 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m05:02:42.366114 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m05:02:42.366391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:02:42.399479 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.03 seconds
[0m05:02:42.404407 [debug] [ThreadPool]: On list_ffd: Close
[0m05:02:42.406121 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m05:02:42.411365 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m05:02:42.411888 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m05:02:42.412158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:02:42.442495 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.03 seconds
[0m05:02:42.446755 [debug] [ThreadPool]: On list_ffd: Close
[0m05:02:42.450845 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_stg_int"
[0m05:02:42.474768 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_int"
[0m05:02:42.475265 [debug] [ThreadPool]: On list_ffd_stg_int: BEGIN
[0m05:02:42.475536 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:02:42.497494 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m05:02:42.498242 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_int"
[0m05:02:42.498880 [debug] [ThreadPool]: On list_ffd_stg_int: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd_stg_int"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg_int'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg_int'
  
[0m05:02:42.507979 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m05:02:42.512910 [debug] [ThreadPool]: On list_ffd_stg_int: ROLLBACK
[0m05:02:42.513825 [debug] [ThreadPool]: On list_ffd_stg_int: Close
[0m05:02:42.515364 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_stg_stg"
[0m05:02:42.524193 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_stg"
[0m05:02:42.524666 [debug] [ThreadPool]: On list_ffd_stg_stg: BEGIN
[0m05:02:42.524931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:02:42.552887 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m05:02:42.553399 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_stg"
[0m05:02:42.553673 [debug] [ThreadPool]: On list_ffd_stg_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd_stg_stg"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg_stg'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg_stg'
  
[0m05:02:42.561648 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m05:02:42.566582 [debug] [ThreadPool]: On list_ffd_stg_stg: ROLLBACK
[0m05:02:42.567627 [debug] [ThreadPool]: On list_ffd_stg_stg: Close
[0m05:02:42.584130 [debug] [MainThread]: Using postgres connection "master"
[0m05:02:42.584640 [debug] [MainThread]: On master: BEGIN
[0m05:02:42.584912 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:02:42.610196 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m05:02:42.610917 [debug] [MainThread]: Using postgres connection "master"
[0m05:02:42.611339 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:02:42.626932 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
[0m05:02:42.631591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e059774b-c9ac-4d51-8eac-79b315ed397a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28efd476d0>]}
[0m05:02:42.632812 [debug] [MainThread]: On master: ROLLBACK
[0m05:02:42.633829 [debug] [MainThread]: Using postgres connection "master"
[0m05:02:42.634269 [debug] [MainThread]: On master: BEGIN
[0m05:02:42.635497 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:02:42.636020 [debug] [MainThread]: On master: COMMIT
[0m05:02:42.636303 [debug] [MainThread]: Using postgres connection "master"
[0m05:02:42.636575 [debug] [MainThread]: On master: COMMIT
[0m05:02:42.637138 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:02:42.637554 [debug] [MainThread]: On master: Close
[0m05:02:42.638494 [info ] [MainThread]: Concurrency: 1 threads (target='stg')
[0m05:02:42.639267 [info ] [MainThread]: 
[0m05:02:42.646973 [debug] [Thread-1 (]: Began running node model.ffd.int__test
[0m05:02:42.647879 [info ] [Thread-1 (]: 1 of 2 START table model stg_int.int__test ..................................... [RUN]
[0m05:02:42.649241 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.int__test"
[0m05:02:42.649773 [debug] [Thread-1 (]: Began compiling node model.ffd.int__test
[0m05:02:42.650118 [debug] [Thread-1 (]: Compiling model.ffd.int__test
[0m05:02:42.654942 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.int__test"
[0m05:02:42.656194 [debug] [Thread-1 (]: finished collecting timing info
[0m05:02:42.656889 [debug] [Thread-1 (]: Began executing node model.ffd.int__test
[0m05:02:42.818834 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.int__test"
[0m05:02:42.820036 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:02:42.820491 [debug] [Thread-1 (]: On model.ffd.int__test: BEGIN
[0m05:02:42.820785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:42.852266 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:02:42.852871 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:02:42.853257 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */


  create  table "ffd"."stg_int"."int__test__dbt_tmp"
  as (
    SELECT 3
UNION
SELECT 4
  );
[0m05:02:42.858251 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m05:02:42.880563 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:02:42.881181 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
alter table "ffd"."stg_int"."int__test" rename to "int__test__dbt_backup"
[0m05:02:42.882873 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:02:42.891956 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:02:42.892896 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
alter table "ffd"."stg_int"."int__test__dbt_tmp" rename to "int__test"
[0m05:02:42.894485 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:02:42.992370 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m05:02:42.992998 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:02:42.993327 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m05:02:43.001751 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m05:02:43.018466 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:02:43.018959 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
drop table if exists "ffd"."stg_int"."int__test__dbt_backup" cascade
[0m05:02:43.027489 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m05:02:43.030453 [debug] [Thread-1 (]: finished collecting timing info
[0m05:02:43.030908 [debug] [Thread-1 (]: On model.ffd.int__test: Close
[0m05:02:43.032166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e059774b-c9ac-4d51-8eac-79b315ed397a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28ef3f7490>]}
[0m05:02:43.033634 [info ] [Thread-1 (]: 1 of 2 OK created table model stg_int.int__test ................................ [[32mSELECT 2[0m in 0.38s]
[0m05:02:43.035310 [debug] [Thread-1 (]: Finished running node model.ffd.int__test
[0m05:02:43.036324 [debug] [Thread-1 (]: Began running node model.ffd.stg__test
[0m05:02:43.037652 [info ] [Thread-1 (]: 2 of 2 START table model stg_stg.stg__test ..................................... [RUN]
[0m05:02:43.039362 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.stg__test"
[0m05:02:43.040085 [debug] [Thread-1 (]: Began compiling node model.ffd.stg__test
[0m05:02:43.040423 [debug] [Thread-1 (]: Compiling model.ffd.stg__test
[0m05:02:43.045114 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.stg__test"
[0m05:02:43.046059 [debug] [Thread-1 (]: finished collecting timing info
[0m05:02:43.046410 [debug] [Thread-1 (]: Began executing node model.ffd.stg__test
[0m05:02:43.059916 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.stg__test"
[0m05:02:43.060889 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:02:43.061185 [debug] [Thread-1 (]: On model.ffd.stg__test: BEGIN
[0m05:02:43.061449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:43.084914 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m05:02:43.085667 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:02:43.086297 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */


  create  table "ffd"."stg_stg"."stg__test__dbt_tmp"
  as (
    SELECT 1
UNION
SELECT 2
  );
[0m05:02:43.091135 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m05:02:43.101675 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:02:43.102297 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."stg_stg"."stg__test" rename to "stg__test__dbt_backup"
[0m05:02:43.104067 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:02:43.112040 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:02:43.112597 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."stg_stg"."stg__test__dbt_tmp" rename to "stg__test"
[0m05:02:43.113879 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:02:43.119051 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m05:02:43.119486 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:02:43.119755 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m05:02:43.135435 [debug] [Thread-1 (]: SQL status: COMMIT in 0.02 seconds
[0m05:02:43.143112 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:02:43.143801 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
drop table if exists "ffd"."stg_stg"."stg__test__dbt_backup" cascade
[0m05:02:43.152831 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m05:02:43.156849 [debug] [Thread-1 (]: finished collecting timing info
[0m05:02:43.157527 [debug] [Thread-1 (]: On model.ffd.stg__test: Close
[0m05:02:43.159061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e059774b-c9ac-4d51-8eac-79b315ed397a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28ef406650>]}
[0m05:02:43.160499 [info ] [Thread-1 (]: 2 of 2 OK created table model stg_stg.stg__test ................................ [[32mSELECT 2[0m in 0.12s]
[0m05:02:43.162065 [debug] [Thread-1 (]: Finished running node model.ffd.stg__test
[0m05:02:43.165235 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:02:43.165954 [debug] [MainThread]: Using postgres connection "master"
[0m05:02:43.166360 [debug] [MainThread]: On master: BEGIN
[0m05:02:43.166747 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:02:43.190007 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m05:02:43.190615 [debug] [MainThread]: On master: COMMIT
[0m05:02:43.191139 [debug] [MainThread]: Using postgres connection "master"
[0m05:02:43.191655 [debug] [MainThread]: On master: COMMIT
[0m05:02:43.192249 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:02:43.192823 [debug] [MainThread]: On master: Close
[0m05:02:43.194387 [info ] [MainThread]: 
[0m05:02:43.195566 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m05:02:43.196432 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:02:43.196796 [debug] [MainThread]: Connection 'model.ffd.stg__test' was properly closed.
[0m05:02:43.212771 [info ] [MainThread]: 
[0m05:02:43.213407 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:02:43.214031 [info ] [MainThread]: 
[0m05:02:43.214540 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:02:43.215302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28ef4610c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28ef461000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28ef405bd0>]}
[0m05:02:43.215928 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 05:03:30.515059 | 055250f3-86c4-4647-b86d-65d7001e64d2 ==============================
[0m05:03:30.515099 [info ] [MainThread]: Running with dbt=1.2.3
[0m05:03:30.516087 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'fail_fast': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:03:30.516545 [debug] [MainThread]: Tracking: tracking
[0m05:03:30.519681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c67329120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c68be7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c68be6aa0>]}
[0m05:03:30.575714 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m05:03:30.576671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '055250f3-86c4-4647-b86d-65d7001e64d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c6730e200>]}
[0m05:03:30.615021 [debug] [MainThread]: Parsing macros/catalog.sql
[0m05:03:30.622530 [debug] [MainThread]: Parsing macros/adapters.sql
[0m05:03:30.710518 [debug] [MainThread]: Parsing macros/relations.sql
[0m05:03:30.714593 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:03:30.718042 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:03:30.739028 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:03:30.741097 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:03:30.742809 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:03:30.747537 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:03:30.752526 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m05:03:30.757724 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m05:03:30.785398 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m05:03:30.799818 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m05:03:30.818149 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:03:30.824700 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m05:03:30.827474 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:03:30.831536 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m05:03:30.835049 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:03:30.839230 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m05:03:30.842681 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m05:03:30.846043 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:03:30.848924 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:03:30.854756 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m05:03:30.858187 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m05:03:30.861557 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m05:03:30.864493 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m05:03:30.867835 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:03:30.875364 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m05:03:30.879060 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m05:03:30.881883 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m05:03:30.884701 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m05:03:30.888468 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m05:03:30.890870 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m05:03:30.894045 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m05:03:30.899418 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m05:03:30.907837 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m05:03:30.912462 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m05:03:30.916840 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m05:03:30.918891 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m05:03:30.921364 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m05:03:30.923994 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:03:30.931643 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:03:30.943819 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:03:30.981645 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m05:03:31.021844 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:03:31.027037 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:03:31.083742 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m05:03:31.132895 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m05:03:31.148190 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:03:31.179543 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m05:03:31.184536 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:03:31.236077 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:03:31.245448 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:03:31.263522 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:03:31.275325 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:03:31.282993 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m05:03:31.287004 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:03:31.304285 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m05:03:31.310375 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m05:03:31.316093 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m05:03:31.331301 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:03:31.354109 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:03:31.411318 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:03:31.456904 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:03:31.480363 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:03:31.512655 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:03:31.519553 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m05:03:31.564751 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:03:31.579426 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:03:31.588663 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:03:31.597163 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m05:03:32.383053 [debug] [MainThread]: 1699: static parser successfully parsed int/int__test.sql
[0m05:03:32.421401 [debug] [MainThread]: 1699: static parser successfully parsed stg/stg__test.sql
[0m05:03:32.515306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '055250f3-86c4-4647-b86d-65d7001e64d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c67207f10>]}
[0m05:03:32.531059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '055250f3-86c4-4647-b86d-65d7001e64d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c672f4520>]}
[0m05:03:32.531860 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 256 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:03:32.532403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '055250f3-86c4-4647-b86d-65d7001e64d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c673298d0>]}
[0m05:03:32.535087 [info ] [MainThread]: 
[0m05:03:32.536376 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:03:32.538574 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m05:03:32.573887 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m05:03:32.574395 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m05:03:32.574670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:03:32.605653 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.03 seconds
[0m05:03:32.609251 [debug] [ThreadPool]: On list_ffd: Close
[0m05:03:32.611186 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m05:03:32.617656 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m05:03:32.618155 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m05:03:32.618420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:03:32.644547 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.03 seconds
[0m05:03:32.647410 [debug] [ThreadPool]: On list_ffd: Close
[0m05:03:32.651244 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_stg_stg"
[0m05:03:32.675030 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_stg"
[0m05:03:32.675601 [debug] [ThreadPool]: On list_ffd_stg_stg: BEGIN
[0m05:03:32.676007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:03:32.699087 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m05:03:32.699653 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_stg"
[0m05:03:32.700011 [debug] [ThreadPool]: On list_ffd_stg_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd_stg_stg"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg_stg'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg_stg'
  
[0m05:03:32.706499 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m05:03:32.710745 [debug] [ThreadPool]: On list_ffd_stg_stg: ROLLBACK
[0m05:03:32.711972 [debug] [ThreadPool]: On list_ffd_stg_stg: Close
[0m05:03:32.713705 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_stg_int"
[0m05:03:32.722309 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_int"
[0m05:03:32.722884 [debug] [ThreadPool]: On list_ffd_stg_int: BEGIN
[0m05:03:32.723207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:03:32.749010 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m05:03:32.749617 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg_int"
[0m05:03:32.750248 [debug] [ThreadPool]: On list_ffd_stg_int: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd_stg_int"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg_int'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg_int'
  
[0m05:03:32.759049 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m05:03:32.764684 [debug] [ThreadPool]: On list_ffd_stg_int: ROLLBACK
[0m05:03:32.765872 [debug] [ThreadPool]: On list_ffd_stg_int: Close
[0m05:03:32.783382 [debug] [MainThread]: Using postgres connection "master"
[0m05:03:32.784111 [debug] [MainThread]: On master: BEGIN
[0m05:03:32.784384 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:03:32.807099 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m05:03:32.807931 [debug] [MainThread]: Using postgres connection "master"
[0m05:03:32.808292 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:03:32.825704 [debug] [MainThread]: SQL status: SELECT 0 in 0.02 seconds
[0m05:03:32.830456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '055250f3-86c4-4647-b86d-65d7001e64d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c672573a0>]}
[0m05:03:32.831315 [debug] [MainThread]: On master: ROLLBACK
[0m05:03:32.832309 [debug] [MainThread]: Using postgres connection "master"
[0m05:03:32.832623 [debug] [MainThread]: On master: BEGIN
[0m05:03:32.833652 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:03:32.834093 [debug] [MainThread]: On master: COMMIT
[0m05:03:32.834627 [debug] [MainThread]: Using postgres connection "master"
[0m05:03:32.835136 [debug] [MainThread]: On master: COMMIT
[0m05:03:32.836015 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:03:32.836605 [debug] [MainThread]: On master: Close
[0m05:03:32.838027 [info ] [MainThread]: Concurrency: 1 threads (target='stg')
[0m05:03:32.839207 [info ] [MainThread]: 
[0m05:03:32.846320 [debug] [Thread-1 (]: Began running node model.ffd.int__test
[0m05:03:32.847246 [info ] [Thread-1 (]: 1 of 2 START table model stg_int.int__test ..................................... [RUN]
[0m05:03:32.848706 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.int__test"
[0m05:03:32.849311 [debug] [Thread-1 (]: Began compiling node model.ffd.int__test
[0m05:03:32.849756 [debug] [Thread-1 (]: Compiling model.ffd.int__test
[0m05:03:32.855319 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.int__test"
[0m05:03:32.856582 [debug] [Thread-1 (]: finished collecting timing info
[0m05:03:32.857191 [debug] [Thread-1 (]: Began executing node model.ffd.int__test
[0m05:03:32.980929 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.int__test"
[0m05:03:32.981959 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:03:32.982287 [debug] [Thread-1 (]: On model.ffd.int__test: BEGIN
[0m05:03:32.982558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:03:33.010829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:03:33.011397 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:03:33.011998 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */


  create  table "ffd"."stg_int"."int__test__dbt_tmp"
  as (
    SELECT 3
UNION
SELECT 4
  );
[0m05:03:33.016775 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m05:03:33.038886 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:03:33.039375 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
alter table "ffd"."stg_int"."int__test" rename to "int__test__dbt_backup"
[0m05:03:33.041095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:03:33.047499 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:03:33.048008 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
alter table "ffd"."stg_int"."int__test__dbt_tmp" rename to "int__test"
[0m05:03:33.049405 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:03:33.124281 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m05:03:33.124801 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:03:33.125077 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m05:03:33.136006 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m05:03:33.154604 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:03:33.155098 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
drop table if exists "ffd"."stg_int"."int__test__dbt_backup" cascade
[0m05:03:33.170014 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m05:03:33.173782 [debug] [Thread-1 (]: finished collecting timing info
[0m05:03:33.174562 [debug] [Thread-1 (]: On model.ffd.int__test: Close
[0m05:03:33.176389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '055250f3-86c4-4647-b86d-65d7001e64d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c66907400>]}
[0m05:03:33.177972 [info ] [Thread-1 (]: 1 of 2 OK created table model stg_int.int__test ................................ [[32mSELECT 2[0m in 0.33s]
[0m05:03:33.179904 [debug] [Thread-1 (]: Finished running node model.ffd.int__test
[0m05:03:33.180873 [debug] [Thread-1 (]: Began running node model.ffd.stg__test
[0m05:03:33.181959 [info ] [Thread-1 (]: 2 of 2 START table model stg_stg.stg__test ..................................... [RUN]
[0m05:03:33.182994 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.stg__test"
[0m05:03:33.183430 [debug] [Thread-1 (]: Began compiling node model.ffd.stg__test
[0m05:03:33.183725 [debug] [Thread-1 (]: Compiling model.ffd.stg__test
[0m05:03:33.188026 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.stg__test"
[0m05:03:33.188956 [debug] [Thread-1 (]: finished collecting timing info
[0m05:03:33.189316 [debug] [Thread-1 (]: Began executing node model.ffd.stg__test
[0m05:03:33.202831 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.stg__test"
[0m05:03:33.203844 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:03:33.204171 [debug] [Thread-1 (]: On model.ffd.stg__test: BEGIN
[0m05:03:33.204435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:03:33.227725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m05:03:33.228378 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:03:33.228732 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */


  create  table "ffd"."stg_stg"."stg__test__dbt_tmp"
  as (
    SELECT 1
UNION
SELECT 2
  );
[0m05:03:33.233650 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m05:03:33.244855 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:03:33.245449 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."stg_stg"."stg__test" rename to "stg__test__dbt_backup"
[0m05:03:33.246930 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:03:33.254775 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:03:33.255333 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."stg_stg"."stg__test__dbt_tmp" rename to "stg__test"
[0m05:03:33.257017 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:03:33.262180 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m05:03:33.262587 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:03:33.262848 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m05:03:33.277581 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m05:03:33.284507 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:03:33.285152 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
drop table if exists "ffd"."stg_stg"."stg__test__dbt_backup" cascade
[0m05:03:33.294858 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m05:03:33.299180 [debug] [Thread-1 (]: finished collecting timing info
[0m05:03:33.299889 [debug] [Thread-1 (]: On model.ffd.stg__test: Close
[0m05:03:33.301447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '055250f3-86c4-4647-b86d-65d7001e64d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c669125c0>]}
[0m05:03:33.302793 [info ] [Thread-1 (]: 2 of 2 OK created table model stg_stg.stg__test ................................ [[32mSELECT 2[0m in 0.12s]
[0m05:03:33.304314 [debug] [Thread-1 (]: Finished running node model.ffd.stg__test
[0m05:03:33.306955 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:03:33.307945 [debug] [MainThread]: Using postgres connection "master"
[0m05:03:33.308218 [debug] [MainThread]: On master: BEGIN
[0m05:03:33.308756 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:03:33.336905 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m05:03:33.337492 [debug] [MainThread]: On master: COMMIT
[0m05:03:33.338016 [debug] [MainThread]: Using postgres connection "master"
[0m05:03:33.338633 [debug] [MainThread]: On master: COMMIT
[0m05:03:33.339593 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:03:33.340202 [debug] [MainThread]: On master: Close
[0m05:03:33.341810 [info ] [MainThread]: 
[0m05:03:33.342858 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m05:03:33.343876 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:03:33.344457 [debug] [MainThread]: Connection 'model.ffd.stg__test' was properly closed.
[0m05:03:33.361367 [info ] [MainThread]: 
[0m05:03:33.362009 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:03:33.362630 [info ] [MainThread]: 
[0m05:03:33.363145 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:03:33.363935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c672c58d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c672c5d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c66973910>]}
[0m05:03:33.364549 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 05:08:50.733356 | 27ae7747-4ad3-40d9-b69a-5b846b64714f ==============================
[0m05:08:50.733404 [info ] [MainThread]: Running with dbt=1.2.3
[0m05:08:50.734377 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'fail_fast': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:08:50.734822 [debug] [MainThread]: Tracking: tracking
[0m05:08:50.738462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f330d1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f4bcba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f4bc9ed0>]}
[0m05:08:50.794827 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m05:08:50.795690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '27ae7747-4ad3-40d9-b69a-5b846b64714f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f32f2260>]}
[0m05:08:50.834459 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
[0m05:08:50.837823 [debug] [MainThread]: Parsing macros/catalog.sql
[0m05:08:50.844888 [debug] [MainThread]: Parsing macros/adapters.sql
[0m05:08:50.933316 [debug] [MainThread]: Parsing macros/relations.sql
[0m05:08:50.937328 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:08:50.940667 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:08:50.961950 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:08:50.964108 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:08:50.965484 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:08:50.969426 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:08:50.973963 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m05:08:50.979013 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m05:08:51.006219 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m05:08:51.021201 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m05:08:51.039609 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:08:51.046231 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m05:08:51.049034 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:08:51.052962 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m05:08:51.056669 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:08:51.060831 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m05:08:51.064194 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m05:08:51.067362 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:08:51.070182 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:08:51.075926 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m05:08:51.079153 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m05:08:51.082440 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m05:08:51.085456 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m05:08:51.089090 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:08:51.096510 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m05:08:51.099869 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m05:08:51.102686 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m05:08:51.105469 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m05:08:51.109228 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m05:08:51.111618 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m05:08:51.114820 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m05:08:51.120409 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m05:08:51.128170 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m05:08:51.132846 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m05:08:51.137497 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m05:08:51.139531 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m05:08:51.141934 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m05:08:51.144494 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:08:51.151539 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:08:51.164142 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:08:51.202284 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m05:08:51.242923 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:08:51.248167 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:08:51.304637 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m05:08:51.353581 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m05:08:51.368880 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:08:51.400356 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m05:08:51.405684 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:08:51.457309 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:08:51.466772 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:08:51.484795 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:08:51.496504 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:08:51.503822 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m05:08:51.507848 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:08:51.525536 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m05:08:51.531142 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m05:08:51.536812 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m05:08:51.552427 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:08:51.575980 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:08:51.644813 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:08:51.705780 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:08:51.735200 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:08:51.779622 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:08:51.789517 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m05:08:51.857761 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:08:51.875076 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:08:51.886813 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:08:51.898371 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m05:08:52.636800 [debug] [MainThread]: 1699: static parser successfully parsed int/int__test.sql
[0m05:08:52.669163 [debug] [MainThread]: 1699: static parser successfully parsed stg/stg__test.sql
[0m05:08:52.761406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27ae7747-4ad3-40d9-b69a-5b846b64714f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f3363d00>]}
[0m05:08:52.776997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27ae7747-4ad3-40d9-b69a-5b846b64714f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f3361e70>]}
[0m05:08:52.777761 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 257 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:08:52.778301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27ae7747-4ad3-40d9-b69a-5b846b64714f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f31f3f10>]}
[0m05:08:52.780900 [info ] [MainThread]: 
[0m05:08:52.782122 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:08:52.784316 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m05:08:52.818829 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m05:08:52.819353 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m05:08:52.819630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:08:52.851294 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.03 seconds
[0m05:08:52.857075 [debug] [ThreadPool]: On list_ffd: Close
[0m05:08:52.859188 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m05:08:52.865231 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m05:08:52.865909 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m05:08:52.866226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:08:52.891003 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.02 seconds
[0m05:08:52.894575 [debug] [ThreadPool]: On list_ffd: Close
[0m05:08:52.896725 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_int"
[0m05:08:52.897694 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_int"
[0m05:08:52.898268 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='ffd', schema='int', identifier=None)"
[0m05:08:52.915631 [debug] [ThreadPool]: Using postgres connection "create_ffd_int"
[0m05:08:52.916240 [debug] [ThreadPool]: On create_ffd_int: BEGIN
[0m05:08:52.916539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:08:52.938035 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m05:08:52.938572 [debug] [ThreadPool]: Using postgres connection "create_ffd_int"
[0m05:08:52.938872 [debug] [ThreadPool]: On create_ffd_int: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "create_ffd_int"} */
create schema if not exists "int"
[0m05:08:52.940145 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m05:08:52.942190 [debug] [ThreadPool]: On create_ffd_int: COMMIT
[0m05:08:52.942547 [debug] [ThreadPool]: Using postgres connection "create_ffd_int"
[0m05:08:52.942838 [debug] [ThreadPool]: On create_ffd_int: COMMIT
[0m05:08:52.957907 [debug] [ThreadPool]: SQL status: COMMIT in 0.01 seconds
[0m05:08:52.958614 [debug] [ThreadPool]: On create_ffd_int: Close
[0m05:08:52.960898 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_stg"
[0m05:08:52.962023 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_stg"
[0m05:08:52.962724 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='ffd', schema='stg', identifier=None)"
[0m05:08:52.969695 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg"
[0m05:08:52.970240 [debug] [ThreadPool]: On create_ffd_stg: BEGIN
[0m05:08:52.970534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:08:52.990224 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m05:08:52.990776 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg"
[0m05:08:52.991076 [debug] [ThreadPool]: On create_ffd_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "create_ffd_stg"} */
create schema if not exists "stg"
[0m05:08:52.992438 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m05:08:52.994642 [debug] [ThreadPool]: On create_ffd_stg: COMMIT
[0m05:08:52.995077 [debug] [ThreadPool]: Using postgres connection "create_ffd_stg"
[0m05:08:52.995344 [debug] [ThreadPool]: On create_ffd_stg: COMMIT
[0m05:08:52.998953 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m05:08:52.999547 [debug] [ThreadPool]: On create_ffd_stg: Close
[0m05:08:53.002615 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_int"
[0m05:08:53.021325 [debug] [ThreadPool]: Using postgres connection "list_ffd_int"
[0m05:08:53.021872 [debug] [ThreadPool]: On list_ffd_int: BEGIN
[0m05:08:53.022140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:08:53.041939 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m05:08:53.042483 [debug] [ThreadPool]: Using postgres connection "list_ffd_int"
[0m05:08:53.042774 [debug] [ThreadPool]: On list_ffd_int: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd_int"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'int'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'int'
  
[0m05:08:53.049388 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m05:08:53.053043 [debug] [ThreadPool]: On list_ffd_int: ROLLBACK
[0m05:08:53.053989 [debug] [ThreadPool]: On list_ffd_int: Close
[0m05:08:53.055460 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_stg"
[0m05:08:53.061001 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg"
[0m05:08:53.061553 [debug] [ThreadPool]: On list_ffd_stg: BEGIN
[0m05:08:53.061844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:08:53.081921 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m05:08:53.082522 [debug] [ThreadPool]: Using postgres connection "list_ffd_stg"
[0m05:08:53.082930 [debug] [ThreadPool]: On list_ffd_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd_stg"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'stg'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'stg'
  
[0m05:08:53.089452 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m05:08:53.092597 [debug] [ThreadPool]: On list_ffd_stg: ROLLBACK
[0m05:08:53.093539 [debug] [ThreadPool]: On list_ffd_stg: Close
[0m05:08:53.106593 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:53.107134 [debug] [MainThread]: On master: BEGIN
[0m05:08:53.107408 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:08:53.127458 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m05:08:53.128051 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:53.128370 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:08:53.138715 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m05:08:53.141818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27ae7747-4ad3-40d9-b69a-5b846b64714f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f31dd930>]}
[0m05:08:53.142659 [debug] [MainThread]: On master: ROLLBACK
[0m05:08:53.143420 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:53.143888 [debug] [MainThread]: On master: BEGIN
[0m05:08:53.144758 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:08:53.145272 [debug] [MainThread]: On master: COMMIT
[0m05:08:53.145574 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:53.145871 [debug] [MainThread]: On master: COMMIT
[0m05:08:53.146549 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:08:53.147002 [debug] [MainThread]: On master: Close
[0m05:08:53.148053 [info ] [MainThread]: Concurrency: 1 threads (target='stg')
[0m05:08:53.148986 [info ] [MainThread]: 
[0m05:08:53.157036 [debug] [Thread-1 (]: Began running node model.ffd.int__test
[0m05:08:53.157907 [info ] [Thread-1 (]: 1 of 2 START table model int.int__test ......................................... [RUN]
[0m05:08:53.159147 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.int__test"
[0m05:08:53.159723 [debug] [Thread-1 (]: Began compiling node model.ffd.int__test
[0m05:08:53.160148 [debug] [Thread-1 (]: Compiling model.ffd.int__test
[0m05:08:53.164775 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.int__test"
[0m05:08:53.165852 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:53.166422 [debug] [Thread-1 (]: Began executing node model.ffd.int__test
[0m05:08:53.296066 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.int__test"
[0m05:08:53.297115 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:08:53.297414 [debug] [Thread-1 (]: On model.ffd.int__test: BEGIN
[0m05:08:53.297683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:53.319412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m05:08:53.320054 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:08:53.320559 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */


  create  table "ffd"."int"."int__test__dbt_tmp"
  as (
    SELECT 3
UNION
SELECT 4
  );
[0m05:08:53.325836 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m05:08:53.346588 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:08:53.347088 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
alter table "ffd"."int"."int__test__dbt_tmp" rename to "int__test"
[0m05:08:53.348358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:08:53.413394 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m05:08:53.413943 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:08:53.414242 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m05:08:53.424831 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m05:08:53.446456 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:08:53.446958 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
drop table if exists "ffd"."int"."int__test__dbt_backup" cascade
[0m05:08:53.447887 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m05:08:53.450610 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:53.451090 [debug] [Thread-1 (]: On model.ffd.int__test: Close
[0m05:08:53.452235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27ae7747-4ad3-40d9-b69a-5b846b64714f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f2969f30>]}
[0m05:08:53.453271 [info ] [Thread-1 (]: 1 of 2 OK created table model int.int__test .................................... [[32mSELECT 2[0m in 0.29s]
[0m05:08:53.454419 [debug] [Thread-1 (]: Finished running node model.ffd.int__test
[0m05:08:53.455120 [debug] [Thread-1 (]: Began running node model.ffd.stg__test
[0m05:08:53.456124 [info ] [Thread-1 (]: 2 of 2 START table model stg.stg__test ......................................... [RUN]
[0m05:08:53.457264 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.stg__test"
[0m05:08:53.457737 [debug] [Thread-1 (]: Began compiling node model.ffd.stg__test
[0m05:08:53.458059 [debug] [Thread-1 (]: Compiling model.ffd.stg__test
[0m05:08:53.462518 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.stg__test"
[0m05:08:53.463505 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:53.463898 [debug] [Thread-1 (]: Began executing node model.ffd.stg__test
[0m05:08:53.473089 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.stg__test"
[0m05:08:53.474065 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:08:53.474360 [debug] [Thread-1 (]: On model.ffd.stg__test: BEGIN
[0m05:08:53.474627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:08:53.499716 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:08:53.500247 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:08:53.500523 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */


  create  table "ffd"."stg"."stg__test__dbt_tmp"
  as (
    SELECT 1
UNION
SELECT 2
  );
[0m05:08:53.504438 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m05:08:53.515239 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:08:53.516037 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."stg"."stg__test__dbt_tmp" rename to "stg__test"
[0m05:08:53.517197 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:08:53.521088 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m05:08:53.521529 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:08:53.521794 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m05:08:53.533301 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m05:08:53.541054 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:08:53.541798 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
drop table if exists "ffd"."stg"."stg__test__dbt_backup" cascade
[0m05:08:53.543220 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m05:08:53.546207 [debug] [Thread-1 (]: finished collecting timing info
[0m05:08:53.546707 [debug] [Thread-1 (]: On model.ffd.stg__test: Close
[0m05:08:53.547859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27ae7747-4ad3-40d9-b69a-5b846b64714f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f325f310>]}
[0m05:08:53.548901 [info ] [Thread-1 (]: 2 of 2 OK created table model stg.stg__test .................................... [[32mSELECT 2[0m in 0.09s]
[0m05:08:53.550020 [debug] [Thread-1 (]: Finished running node model.ffd.stg__test
[0m05:08:53.552591 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:08:53.553243 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:53.553607 [debug] [MainThread]: On master: BEGIN
[0m05:08:53.553958 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:08:53.579283 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m05:08:53.579980 [debug] [MainThread]: On master: COMMIT
[0m05:08:53.580409 [debug] [MainThread]: Using postgres connection "master"
[0m05:08:53.581035 [debug] [MainThread]: On master: COMMIT
[0m05:08:53.582070 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:08:53.582760 [debug] [MainThread]: On master: Close
[0m05:08:53.584213 [info ] [MainThread]: 
[0m05:08:53.585299 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m05:08:53.586216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:08:53.586773 [debug] [MainThread]: Connection 'model.ffd.stg__test' was properly closed.
[0m05:08:53.605182 [info ] [MainThread]: 
[0m05:08:53.605832 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:08:53.606463 [info ] [MainThread]: 
[0m05:08:53.606998 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:08:53.607809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f325ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f325cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61f325f010>]}
[0m05:08:53.608432 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 05:12:04.850165 | 1c58e912-dfd9-4e61-a1a4-a683deec165a ==============================
[0m05:12:04.850203 [info ] [MainThread]: Running with dbt=1.2.3
[0m05:12:04.851109 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'fail_fast': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:12:04.851554 [debug] [MainThread]: Tracking: tracking
[0m05:12:04.854850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7db95150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7db75030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7db666e0>]}
[0m05:12:04.911920 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m05:12:04.912748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1c58e912-dfd9-4e61-a1a4-a683deec165a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7db666e0>]}
[0m05:12:04.952207 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
[0m05:12:04.955520 [debug] [MainThread]: Parsing macros/catalog.sql
[0m05:12:04.962844 [debug] [MainThread]: Parsing macros/adapters.sql
[0m05:12:05.050767 [debug] [MainThread]: Parsing macros/relations.sql
[0m05:12:05.054723 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:12:05.058076 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:12:05.078885 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:12:05.080919 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:12:05.082186 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:12:05.086021 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:12:05.090582 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m05:12:05.095823 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m05:12:05.122895 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m05:12:05.137547 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m05:12:05.156092 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:12:05.162739 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m05:12:05.165799 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:12:05.169981 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m05:12:05.173436 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:12:05.177315 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m05:12:05.180877 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m05:12:05.184096 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:12:05.186874 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:12:05.192581 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m05:12:05.195830 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m05:12:05.199090 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m05:12:05.201890 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m05:12:05.205159 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:12:05.212380 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m05:12:05.215688 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m05:12:05.218585 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m05:12:05.221571 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m05:12:05.225688 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m05:12:05.228331 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m05:12:05.231501 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m05:12:05.236605 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m05:12:05.244159 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m05:12:05.248646 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m05:12:05.252986 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m05:12:05.255004 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m05:12:05.257453 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m05:12:05.260005 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:12:05.267549 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:12:05.279655 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:12:05.317242 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m05:12:05.356717 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:12:05.361806 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:12:05.417526 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m05:12:05.465026 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m05:12:05.479925 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:12:05.510552 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m05:12:05.515728 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:12:05.567269 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:12:05.576408 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:12:05.594238 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:12:05.605010 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:12:05.612099 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m05:12:05.616062 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:12:05.633517 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m05:12:05.639026 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m05:12:05.644702 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m05:12:05.660119 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:12:05.682457 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:12:05.738787 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:12:05.783541 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:12:05.806893 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:12:05.839436 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:12:05.846217 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m05:12:05.891021 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:12:05.904896 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:12:05.914225 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:12:05.922426 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m05:12:06.748287 [debug] [MainThread]: 1699: static parser successfully parsed 03_mrt/mrt__test.sql
[0m05:12:06.781013 [debug] [MainThread]: 1699: static parser successfully parsed 01_stg/stg__test.sql
[0m05:12:06.789962 [debug] [MainThread]: 1699: static parser successfully parsed 02_int/int__test.sql
[0m05:12:06.887513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c58e912-dfd9-4e61-a1a4-a683deec165a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7dbe3e50>]}
[0m05:12:06.903466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c58e912-dfd9-4e61-a1a4-a683deec165a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7dbe3910>]}
[0m05:12:06.904308 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 257 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:12:06.904847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c58e912-dfd9-4e61-a1a4-a683deec165a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7dbe3e50>]}
[0m05:12:06.907621 [info ] [MainThread]: 
[0m05:12:06.908927 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:12:06.911574 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m05:12:06.945051 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m05:12:06.945573 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m05:12:06.945851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:12:06.977192 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.03 seconds
[0m05:12:06.980418 [debug] [ThreadPool]: On list_ffd: Close
[0m05:12:06.982337 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m05:12:06.988947 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m05:12:06.989442 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m05:12:06.989709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:12:07.019677 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.03 seconds
[0m05:12:07.022580 [debug] [ThreadPool]: On list_ffd: Close
[0m05:12:07.024087 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m05:12:07.031212 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m05:12:07.031975 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m05:12:07.032248 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:12:07.056367 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.02 seconds
[0m05:12:07.060290 [debug] [ThreadPool]: On list_ffd: Close
[0m05:12:07.062462 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_01_stg"
[0m05:12:07.063554 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_01_stg"
[0m05:12:07.064295 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='ffd', schema='01_stg', identifier=None)"
[0m05:12:07.082786 [debug] [ThreadPool]: Using postgres connection "create_ffd_01_stg"
[0m05:12:07.083289 [debug] [ThreadPool]: On create_ffd_01_stg: BEGIN
[0m05:12:07.083554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:12:07.107694 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m05:12:07.108328 [debug] [ThreadPool]: Using postgres connection "create_ffd_01_stg"
[0m05:12:07.108687 [debug] [ThreadPool]: On create_ffd_01_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "create_ffd_01_stg"} */
create schema if not exists "01_stg"
[0m05:12:07.110129 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m05:12:07.112761 [debug] [ThreadPool]: On create_ffd_01_stg: COMMIT
[0m05:12:07.113273 [debug] [ThreadPool]: Using postgres connection "create_ffd_01_stg"
[0m05:12:07.113671 [debug] [ThreadPool]: On create_ffd_01_stg: COMMIT
[0m05:12:07.174881 [debug] [ThreadPool]: SQL status: COMMIT in 0.06 seconds
[0m05:12:07.176005 [debug] [ThreadPool]: On create_ffd_01_stg: Close
[0m05:12:07.179057 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_02_int"
[0m05:12:07.181028 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_02_int"
[0m05:12:07.182116 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='ffd', schema='02_int', identifier=None)"
[0m05:12:07.188862 [debug] [ThreadPool]: Using postgres connection "create_ffd_02_int"
[0m05:12:07.189456 [debug] [ThreadPool]: On create_ffd_02_int: BEGIN
[0m05:12:07.189802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:12:07.211684 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m05:12:07.212326 [debug] [ThreadPool]: Using postgres connection "create_ffd_02_int"
[0m05:12:07.212684 [debug] [ThreadPool]: On create_ffd_02_int: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "create_ffd_02_int"} */
create schema if not exists "02_int"
[0m05:12:07.214172 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m05:12:07.216900 [debug] [ThreadPool]: On create_ffd_02_int: COMMIT
[0m05:12:07.217404 [debug] [ThreadPool]: Using postgres connection "create_ffd_02_int"
[0m05:12:07.217792 [debug] [ThreadPool]: On create_ffd_02_int: COMMIT
[0m05:12:07.224690 [debug] [ThreadPool]: SQL status: COMMIT in 0.01 seconds
[0m05:12:07.225481 [debug] [ThreadPool]: On create_ffd_02_int: Close
[0m05:12:07.227451 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_03_mrt"
[0m05:12:07.228849 [debug] [ThreadPool]: Acquiring new postgres connection "create_ffd_03_mrt"
[0m05:12:07.229569 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='ffd', schema='03_mrt', identifier=None)"
[0m05:12:07.236131 [debug] [ThreadPool]: Using postgres connection "create_ffd_03_mrt"
[0m05:12:07.236760 [debug] [ThreadPool]: On create_ffd_03_mrt: BEGIN
[0m05:12:07.237149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:12:07.262012 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m05:12:07.262543 [debug] [ThreadPool]: Using postgres connection "create_ffd_03_mrt"
[0m05:12:07.262816 [debug] [ThreadPool]: On create_ffd_03_mrt: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "create_ffd_03_mrt"} */
create schema if not exists "03_mrt"
[0m05:12:07.264010 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m05:12:07.265942 [debug] [ThreadPool]: On create_ffd_03_mrt: COMMIT
[0m05:12:07.266276 [debug] [ThreadPool]: Using postgres connection "create_ffd_03_mrt"
[0m05:12:07.266539 [debug] [ThreadPool]: On create_ffd_03_mrt: COMMIT
[0m05:12:07.274778 [debug] [ThreadPool]: SQL status: COMMIT in 0.01 seconds
[0m05:12:07.275538 [debug] [ThreadPool]: On create_ffd_03_mrt: Close
[0m05:12:07.280826 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_01_stg"
[0m05:12:07.303729 [debug] [ThreadPool]: Using postgres connection "list_ffd_01_stg"
[0m05:12:07.304300 [debug] [ThreadPool]: On list_ffd_01_stg: BEGIN
[0m05:12:07.304571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:12:07.328482 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m05:12:07.329003 [debug] [ThreadPool]: Using postgres connection "list_ffd_01_stg"
[0m05:12:07.329271 [debug] [ThreadPool]: On list_ffd_01_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd_01_stg"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '01_stg'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '01_stg'
  
[0m05:12:07.338051 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m05:12:07.341640 [debug] [ThreadPool]: On list_ffd_01_stg: ROLLBACK
[0m05:12:07.342671 [debug] [ThreadPool]: On list_ffd_01_stg: Close
[0m05:12:07.344335 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_02_int"
[0m05:12:07.350380 [debug] [ThreadPool]: Using postgres connection "list_ffd_02_int"
[0m05:12:07.350878 [debug] [ThreadPool]: On list_ffd_02_int: BEGIN
[0m05:12:07.351139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:12:07.375101 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m05:12:07.375616 [debug] [ThreadPool]: Using postgres connection "list_ffd_02_int"
[0m05:12:07.376015 [debug] [ThreadPool]: On list_ffd_02_int: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd_02_int"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '02_int'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '02_int'
  
[0m05:12:07.384488 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m05:12:07.388375 [debug] [ThreadPool]: On list_ffd_02_int: ROLLBACK
[0m05:12:07.389299 [debug] [ThreadPool]: On list_ffd_02_int: Close
[0m05:12:07.390474 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_03_mrt"
[0m05:12:07.396321 [debug] [ThreadPool]: Using postgres connection "list_ffd_03_mrt"
[0m05:12:07.396818 [debug] [ThreadPool]: On list_ffd_03_mrt: BEGIN
[0m05:12:07.397082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:12:07.419703 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m05:12:07.420357 [debug] [ThreadPool]: Using postgres connection "list_ffd_03_mrt"
[0m05:12:07.420713 [debug] [ThreadPool]: On list_ffd_03_mrt: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "list_ffd_03_mrt"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '03_mrt'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '03_mrt'
  
[0m05:12:07.429828 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.01 seconds
[0m05:12:07.434607 [debug] [ThreadPool]: On list_ffd_03_mrt: ROLLBACK
[0m05:12:07.435657 [debug] [ThreadPool]: On list_ffd_03_mrt: Close
[0m05:12:07.452318 [debug] [MainThread]: Using postgres connection "master"
[0m05:12:07.452828 [debug] [MainThread]: On master: BEGIN
[0m05:12:07.453097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:12:07.477571 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m05:12:07.478345 [debug] [MainThread]: Using postgres connection "master"
[0m05:12:07.478988 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:12:07.492421 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m05:12:07.497200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c58e912-dfd9-4e61-a1a4-a683deec165a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7db3d3c0>]}
[0m05:12:07.498277 [debug] [MainThread]: On master: ROLLBACK
[0m05:12:07.499214 [debug] [MainThread]: Using postgres connection "master"
[0m05:12:07.499510 [debug] [MainThread]: On master: BEGIN
[0m05:12:07.500566 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:12:07.501028 [debug] [MainThread]: On master: COMMIT
[0m05:12:07.501376 [debug] [MainThread]: Using postgres connection "master"
[0m05:12:07.501719 [debug] [MainThread]: On master: COMMIT
[0m05:12:07.502288 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:12:07.502692 [debug] [MainThread]: On master: Close
[0m05:12:07.503733 [info ] [MainThread]: Concurrency: 1 threads (target='stg')
[0m05:12:07.504666 [info ] [MainThread]: 
[0m05:12:07.512676 [debug] [Thread-1 (]: Began running node model.ffd.int__test
[0m05:12:07.513579 [info ] [Thread-1 (]: 1 of 3 START table model 02_int.int__test ...................................... [RUN]
[0m05:12:07.514914 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.int__test"
[0m05:12:07.515447 [debug] [Thread-1 (]: Began compiling node model.ffd.int__test
[0m05:12:07.515949 [debug] [Thread-1 (]: Compiling model.ffd.int__test
[0m05:12:07.521459 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.int__test"
[0m05:12:07.522687 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:07.523210 [debug] [Thread-1 (]: Began executing node model.ffd.int__test
[0m05:12:07.651723 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.int__test"
[0m05:12:07.652801 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:12:07.653094 [debug] [Thread-1 (]: On model.ffd.int__test: BEGIN
[0m05:12:07.653363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:07.679090 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:12:07.679686 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:12:07.680096 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */


  create  table "ffd"."02_int"."int__test__dbt_tmp"
  as (
    SELECT 3
UNION
SELECT 4
  );
[0m05:12:07.684145 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m05:12:07.708723 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:12:07.709225 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
alter table "ffd"."02_int"."int__test__dbt_tmp" rename to "int__test"
[0m05:12:07.710459 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:12:07.774876 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m05:12:07.775404 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:12:07.775674 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m05:12:07.783317 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m05:12:07.801071 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:12:07.801565 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.int__test"} */
drop table if exists "ffd"."02_int"."int__test__dbt_backup" cascade
[0m05:12:07.802425 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m05:12:07.805160 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:07.805642 [debug] [Thread-1 (]: On model.ffd.int__test: Close
[0m05:12:07.806735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c58e912-dfd9-4e61-a1a4-a683deec165a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7d1721a0>]}
[0m05:12:07.807758 [info ] [Thread-1 (]: 1 of 3 OK created table model 02_int.int__test ................................. [[32mSELECT 2[0m in 0.29s]
[0m05:12:07.809072 [debug] [Thread-1 (]: Finished running node model.ffd.int__test
[0m05:12:07.809808 [debug] [Thread-1 (]: Began running node model.ffd.mrt__test
[0m05:12:07.810729 [info ] [Thread-1 (]: 2 of 3 START table model 03_mrt.mrt__test ...................................... [RUN]
[0m05:12:07.811869 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.mrt__test"
[0m05:12:07.812371 [debug] [Thread-1 (]: Began compiling node model.ffd.mrt__test
[0m05:12:07.812697 [debug] [Thread-1 (]: Compiling model.ffd.mrt__test
[0m05:12:07.817182 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.mrt__test"
[0m05:12:07.818153 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:07.818500 [debug] [Thread-1 (]: Began executing node model.ffd.mrt__test
[0m05:12:07.827641 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.mrt__test"
[0m05:12:07.828706 [debug] [Thread-1 (]: Using postgres connection "model.ffd.mrt__test"
[0m05:12:07.829008 [debug] [Thread-1 (]: On model.ffd.mrt__test: BEGIN
[0m05:12:07.829279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:07.854723 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:12:07.855241 [debug] [Thread-1 (]: Using postgres connection "model.ffd.mrt__test"
[0m05:12:07.855514 [debug] [Thread-1 (]: On model.ffd.mrt__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.mrt__test"} */


  create  table "ffd"."03_mrt"."mrt__test__dbt_tmp"
  as (
    SELECT 5
UNION
SELECT 6
  );
[0m05:12:07.860272 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m05:12:07.867974 [debug] [Thread-1 (]: Using postgres connection "model.ffd.mrt__test"
[0m05:12:07.868664 [debug] [Thread-1 (]: On model.ffd.mrt__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.mrt__test"} */
alter table "ffd"."03_mrt"."mrt__test__dbt_tmp" rename to "mrt__test"
[0m05:12:07.870308 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:12:07.875682 [debug] [Thread-1 (]: On model.ffd.mrt__test: COMMIT
[0m05:12:07.876269 [debug] [Thread-1 (]: Using postgres connection "model.ffd.mrt__test"
[0m05:12:07.876622 [debug] [Thread-1 (]: On model.ffd.mrt__test: COMMIT
[0m05:12:07.883240 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m05:12:07.890111 [debug] [Thread-1 (]: Using postgres connection "model.ffd.mrt__test"
[0m05:12:07.890706 [debug] [Thread-1 (]: On model.ffd.mrt__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.mrt__test"} */
drop table if exists "ffd"."03_mrt"."mrt__test__dbt_backup" cascade
[0m05:12:07.891899 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m05:12:07.895183 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:07.895754 [debug] [Thread-1 (]: On model.ffd.mrt__test: Close
[0m05:12:07.897077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c58e912-dfd9-4e61-a1a4-a683deec165a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7d185450>]}
[0m05:12:07.898247 [info ] [Thread-1 (]: 2 of 3 OK created table model 03_mrt.mrt__test ................................. [[32mSELECT 2[0m in 0.09s]
[0m05:12:07.899603 [debug] [Thread-1 (]: Finished running node model.ffd.mrt__test
[0m05:12:07.900419 [debug] [Thread-1 (]: Began running node model.ffd.stg__test
[0m05:12:07.901310 [info ] [Thread-1 (]: 3 of 3 START table model 01_stg.stg__test ...................................... [RUN]
[0m05:12:07.902366 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.stg__test"
[0m05:12:07.902806 [debug] [Thread-1 (]: Began compiling node model.ffd.stg__test
[0m05:12:07.903105 [debug] [Thread-1 (]: Compiling model.ffd.stg__test
[0m05:12:07.907517 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.stg__test"
[0m05:12:07.908581 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:07.908946 [debug] [Thread-1 (]: Began executing node model.ffd.stg__test
[0m05:12:07.917704 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.stg__test"
[0m05:12:07.918684 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:12:07.918961 [debug] [Thread-1 (]: On model.ffd.stg__test: BEGIN
[0m05:12:07.919222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:12:07.942298 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m05:12:07.942957 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:12:07.943356 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */


  create  table "ffd"."01_stg"."stg__test__dbt_tmp"
  as (
    SELECT 1
UNION
SELECT 2
  );
[0m05:12:07.949468 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m05:12:07.959428 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:12:07.960149 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."01_stg"."stg__test__dbt_tmp" rename to "stg__test"
[0m05:12:07.961473 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:12:07.970295 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m05:12:07.970805 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:12:07.971070 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m05:12:07.975283 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:12:08.075096 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:12:08.075626 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "stg", "node_id": "model.ffd.stg__test"} */
drop table if exists "ffd"."01_stg"."stg__test__dbt_backup" cascade
[0m05:12:08.076615 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m05:12:08.079375 [debug] [Thread-1 (]: finished collecting timing info
[0m05:12:08.079945 [debug] [Thread-1 (]: On model.ffd.stg__test: Close
[0m05:12:08.081063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c58e912-dfd9-4e61-a1a4-a683deec165a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7d228460>]}
[0m05:12:08.082099 [info ] [Thread-1 (]: 3 of 3 OK created table model 01_stg.stg__test ................................. [[32mSELECT 2[0m in 0.18s]
[0m05:12:08.083272 [debug] [Thread-1 (]: Finished running node model.ffd.stg__test
[0m05:12:08.085993 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:12:08.086859 [debug] [MainThread]: Using postgres connection "master"
[0m05:12:08.087394 [debug] [MainThread]: On master: BEGIN
[0m05:12:08.087948 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:12:08.113313 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m05:12:08.114114 [debug] [MainThread]: On master: COMMIT
[0m05:12:08.114746 [debug] [MainThread]: Using postgres connection "master"
[0m05:12:08.115370 [debug] [MainThread]: On master: COMMIT
[0m05:12:08.116275 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:12:08.116836 [debug] [MainThread]: On master: Close
[0m05:12:08.118407 [info ] [MainThread]: 
[0m05:12:08.119413 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m05:12:08.120413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:12:08.120931 [debug] [MainThread]: Connection 'model.ffd.stg__test' was properly closed.
[0m05:12:08.140449 [info ] [MainThread]: 
[0m05:12:08.141103 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:12:08.141768 [info ] [MainThread]: 
[0m05:12:08.142277 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:12:08.143009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7d2284c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7f3927d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7f392d40>]}
[0m05:12:08.143597 [debug] [MainThread]: Flushing usage events


============================== 2024-02-03 05:14:47.158696 | 2a6ae745-9e91-41b1-a3fd-ee8afb5ef600 ==============================
[0m05:14:47.158742 [info ] [MainThread]: Running with dbt=1.2.3
[0m05:14:47.159624 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': True, 'fail_fast': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:14:47.160292 [debug] [MainThread]: Tracking: tracking
[0m05:14:47.163354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d5a7d5180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d5a7a0280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d5a7a1990>]}
[0m05:14:47.220576 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m05:14:47.221409 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m05:14:47.222081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2a6ae745-9e91-41b1-a3fd-ee8afb5ef600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d5a7bdc60>]}
[0m05:14:47.269945 [debug] [MainThread]: Parsing macros/generate_schema_name.sql
[0m05:14:47.273396 [debug] [MainThread]: Parsing macros/catalog.sql
[0m05:14:47.280403 [debug] [MainThread]: Parsing macros/adapters.sql
[0m05:14:47.365140 [debug] [MainThread]: Parsing macros/relations.sql
[0m05:14:47.369217 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:14:47.372541 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:14:47.394048 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:14:47.396008 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:14:47.397288 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:14:47.401362 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:14:47.406049 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m05:14:47.411197 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m05:14:47.439109 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m05:14:47.453718 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m05:14:47.472022 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m05:14:47.478786 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m05:14:47.481894 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m05:14:47.485916 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m05:14:47.489254 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m05:14:47.493091 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m05:14:47.496426 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m05:14:47.499571 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m05:14:47.502319 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m05:14:47.507898 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m05:14:47.511049 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m05:14:47.514564 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m05:14:47.517493 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m05:14:47.520763 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m05:14:47.528130 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m05:14:47.531415 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m05:14:47.534146 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m05:14:47.536936 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m05:14:47.540677 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m05:14:47.543068 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m05:14:47.546268 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m05:14:47.551806 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m05:14:47.559565 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m05:14:47.564094 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m05:14:47.568446 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m05:14:47.570459 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m05:14:47.572883 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m05:14:47.575435 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m05:14:47.582655 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m05:14:47.595335 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m05:14:47.633848 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m05:14:47.674758 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m05:14:47.680012 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m05:14:47.736875 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m05:14:47.785961 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m05:14:47.801169 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m05:14:47.832794 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m05:14:47.837773 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m05:14:47.890299 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m05:14:47.899529 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m05:14:47.918050 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m05:14:47.929233 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m05:14:47.936444 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m05:14:47.940394 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m05:14:47.958178 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m05:14:47.963827 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m05:14:47.969488 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m05:14:47.985372 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m05:14:48.007749 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m05:14:48.065846 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m05:14:48.112308 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m05:14:48.135283 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m05:14:48.168188 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m05:14:48.175325 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m05:14:48.220302 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m05:14:48.234576 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m05:14:48.244139 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m05:14:48.252829 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m05:14:48.994537 [debug] [MainThread]: 1699: static parser successfully parsed 03_mrt/mrt__test.sql
[0m05:14:49.026624 [debug] [MainThread]: 1699: static parser successfully parsed 01_stg/stg__test.sql
[0m05:14:49.035819 [debug] [MainThread]: 1699: static parser successfully parsed 02_int/int__test.sql
[0m05:14:49.132962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a6ae745-9e91-41b1-a3fd-ee8afb5ef600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d5a725240>]}
[0m05:14:49.149908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a6ae745-9e91-41b1-a3fd-ee8afb5ef600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d5a7254b0>]}
[0m05:14:49.150676 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 257 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m05:14:49.151212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a6ae745-9e91-41b1-a3fd-ee8afb5ef600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d5a8631f0>]}
[0m05:14:49.154079 [info ] [MainThread]: 
[0m05:14:49.155307 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:14:49.157982 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m05:14:49.193525 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m05:14:49.194040 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "public", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m05:14:49.194316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:14:49.226775 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.03 seconds
[0m05:14:49.231534 [debug] [ThreadPool]: On list_ffd: Close
[0m05:14:49.233732 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m05:14:49.239336 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m05:14:49.239861 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "public", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m05:14:49.240136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:14:49.267492 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.03 seconds
[0m05:14:49.271503 [debug] [ThreadPool]: On list_ffd: Close
[0m05:14:49.273399 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd"
[0m05:14:49.279505 [debug] [ThreadPool]: Using postgres connection "list_ffd"
[0m05:14:49.280140 [debug] [ThreadPool]: On list_ffd: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "public", "connection_name": "list_ffd"} */

    select distinct nspname from pg_namespace
  
[0m05:14:49.280488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:14:49.306261 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.03 seconds
[0m05:14:49.309157 [debug] [ThreadPool]: On list_ffd: Close
[0m05:14:49.312655 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_03_mrt"
[0m05:14:49.335193 [debug] [ThreadPool]: Using postgres connection "list_ffd_03_mrt"
[0m05:14:49.335692 [debug] [ThreadPool]: On list_ffd_03_mrt: BEGIN
[0m05:14:49.335997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:14:49.363707 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m05:14:49.364244 [debug] [ThreadPool]: Using postgres connection "list_ffd_03_mrt"
[0m05:14:49.364514 [debug] [ThreadPool]: On list_ffd_03_mrt: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "public", "connection_name": "list_ffd_03_mrt"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '03_mrt'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '03_mrt'
  
[0m05:14:49.373507 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m05:14:49.378416 [debug] [ThreadPool]: On list_ffd_03_mrt: ROLLBACK
[0m05:14:49.379487 [debug] [ThreadPool]: On list_ffd_03_mrt: Close
[0m05:14:49.381076 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_02_int"
[0m05:14:49.387688 [debug] [ThreadPool]: Using postgres connection "list_ffd_02_int"
[0m05:14:49.388296 [debug] [ThreadPool]: On list_ffd_02_int: BEGIN
[0m05:14:49.388567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:14:49.416756 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m05:14:49.417269 [debug] [ThreadPool]: Using postgres connection "list_ffd_02_int"
[0m05:14:49.417542 [debug] [ThreadPool]: On list_ffd_02_int: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "public", "connection_name": "list_ffd_02_int"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '02_int'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '02_int'
  
[0m05:14:49.425879 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m05:14:49.430409 [debug] [ThreadPool]: On list_ffd_02_int: ROLLBACK
[0m05:14:49.431266 [debug] [ThreadPool]: On list_ffd_02_int: Close
[0m05:14:49.432838 [debug] [ThreadPool]: Acquiring new postgres connection "list_ffd_01_stg"
[0m05:14:49.440138 [debug] [ThreadPool]: Using postgres connection "list_ffd_01_stg"
[0m05:14:49.440633 [debug] [ThreadPool]: On list_ffd_01_stg: BEGIN
[0m05:14:49.440899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:14:49.468385 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m05:14:49.468903 [debug] [ThreadPool]: Using postgres connection "list_ffd_01_stg"
[0m05:14:49.469188 [debug] [ThreadPool]: On list_ffd_01_stg: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "public", "connection_name": "list_ffd_01_stg"} */
select
      'ffd' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '01_stg'
    union all
    select
      'ffd' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '01_stg'
  
[0m05:14:49.477650 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.01 seconds
[0m05:14:49.482070 [debug] [ThreadPool]: On list_ffd_01_stg: ROLLBACK
[0m05:14:49.483156 [debug] [ThreadPool]: On list_ffd_01_stg: Close
[0m05:14:49.500655 [debug] [MainThread]: Using postgres connection "master"
[0m05:14:49.501162 [debug] [MainThread]: On master: BEGIN
[0m05:14:49.501428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:14:49.526590 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m05:14:49.527177 [debug] [MainThread]: Using postgres connection "master"
[0m05:14:49.527845 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "public", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:14:49.541835 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
[0m05:14:49.546631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a6ae745-9e91-41b1-a3fd-ee8afb5ef600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d5a731c00>]}
[0m05:14:49.547661 [debug] [MainThread]: On master: ROLLBACK
[0m05:14:49.548410 [debug] [MainThread]: Using postgres connection "master"
[0m05:14:49.548973 [debug] [MainThread]: On master: BEGIN
[0m05:14:49.550143 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:14:49.550778 [debug] [MainThread]: On master: COMMIT
[0m05:14:49.551300 [debug] [MainThread]: Using postgres connection "master"
[0m05:14:49.551881 [debug] [MainThread]: On master: COMMIT
[0m05:14:49.552333 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:14:49.552644 [debug] [MainThread]: On master: Close
[0m05:14:49.553490 [info ] [MainThread]: Concurrency: 1 threads (target='public')
[0m05:14:49.554201 [info ] [MainThread]: 
[0m05:14:49.561284 [debug] [Thread-1 (]: Began running node model.ffd.int__test
[0m05:14:49.562172 [info ] [Thread-1 (]: 1 of 3 START table model 02_int.int__test ...................................... [RUN]
[0m05:14:49.564023 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.int__test"
[0m05:14:49.564562 [debug] [Thread-1 (]: Began compiling node model.ffd.int__test
[0m05:14:49.565000 [debug] [Thread-1 (]: Compiling model.ffd.int__test
[0m05:14:49.570413 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.int__test"
[0m05:14:49.571666 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:49.572239 [debug] [Thread-1 (]: Began executing node model.ffd.int__test
[0m05:14:49.694189 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.int__test"
[0m05:14:49.695211 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:14:49.695502 [debug] [Thread-1 (]: On model.ffd.int__test: BEGIN
[0m05:14:49.695769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:14:49.722999 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:14:49.723579 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:14:49.724142 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "public", "node_id": "model.ffd.int__test"} */


  create  table "ffd"."02_int"."int__test__dbt_tmp"
  as (
    SELECT 3
UNION
SELECT 4
  );
[0m05:14:49.729621 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m05:14:49.752468 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:14:49.752966 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "public", "node_id": "model.ffd.int__test"} */
alter table "ffd"."02_int"."int__test" rename to "int__test__dbt_backup"
[0m05:14:49.754573 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:14:49.760615 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:14:49.761096 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "public", "node_id": "model.ffd.int__test"} */
alter table "ffd"."02_int"."int__test__dbt_tmp" rename to "int__test"
[0m05:14:49.762340 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:14:49.835590 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m05:14:49.836130 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:14:49.836403 [debug] [Thread-1 (]: On model.ffd.int__test: COMMIT
[0m05:14:49.845448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m05:14:49.866930 [debug] [Thread-1 (]: Using postgres connection "model.ffd.int__test"
[0m05:14:49.867417 [debug] [Thread-1 (]: On model.ffd.int__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "public", "node_id": "model.ffd.int__test"} */
drop table if exists "ffd"."02_int"."int__test__dbt_backup" cascade
[0m05:14:49.879522 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m05:14:49.885322 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:49.886299 [debug] [Thread-1 (]: On model.ffd.int__test: Close
[0m05:14:49.888175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a6ae745-9e91-41b1-a3fd-ee8afb5ef600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d59e0ac50>]}
[0m05:14:49.889230 [info ] [Thread-1 (]: 1 of 3 OK created table model 02_int.int__test ................................. [[32mSELECT 2[0m in 0.32s]
[0m05:14:49.890362 [debug] [Thread-1 (]: Finished running node model.ffd.int__test
[0m05:14:49.891053 [debug] [Thread-1 (]: Began running node model.ffd.mrt__test
[0m05:14:49.892011 [info ] [Thread-1 (]: 2 of 3 START table model 03_mrt.mrt__test ...................................... [RUN]
[0m05:14:49.893122 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.mrt__test"
[0m05:14:49.893586 [debug] [Thread-1 (]: Began compiling node model.ffd.mrt__test
[0m05:14:49.893904 [debug] [Thread-1 (]: Compiling model.ffd.mrt__test
[0m05:14:49.898415 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.mrt__test"
[0m05:14:49.899388 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:49.899711 [debug] [Thread-1 (]: Began executing node model.ffd.mrt__test
[0m05:14:49.909245 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.mrt__test"
[0m05:14:49.910238 [debug] [Thread-1 (]: Using postgres connection "model.ffd.mrt__test"
[0m05:14:49.910540 [debug] [Thread-1 (]: On model.ffd.mrt__test: BEGIN
[0m05:14:49.910807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:14:49.934307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.02 seconds
[0m05:14:49.934894 [debug] [Thread-1 (]: Using postgres connection "model.ffd.mrt__test"
[0m05:14:49.935204 [debug] [Thread-1 (]: On model.ffd.mrt__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "public", "node_id": "model.ffd.mrt__test"} */


  create  table "ffd"."03_mrt"."mrt__test__dbt_tmp"
  as (
    SELECT 5
UNION
SELECT 6
  );
[0m05:14:49.939601 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m05:14:49.949186 [debug] [Thread-1 (]: Using postgres connection "model.ffd.mrt__test"
[0m05:14:49.949818 [debug] [Thread-1 (]: On model.ffd.mrt__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "public", "node_id": "model.ffd.mrt__test"} */
alter table "ffd"."03_mrt"."mrt__test" rename to "mrt__test__dbt_backup"
[0m05:14:49.951560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:14:49.958712 [debug] [Thread-1 (]: Using postgres connection "model.ffd.mrt__test"
[0m05:14:49.959239 [debug] [Thread-1 (]: On model.ffd.mrt__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "public", "node_id": "model.ffd.mrt__test"} */
alter table "ffd"."03_mrt"."mrt__test__dbt_tmp" rename to "mrt__test"
[0m05:14:49.960308 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:14:49.964653 [debug] [Thread-1 (]: On model.ffd.mrt__test: COMMIT
[0m05:14:49.965100 [debug] [Thread-1 (]: Using postgres connection "model.ffd.mrt__test"
[0m05:14:49.965367 [debug] [Thread-1 (]: On model.ffd.mrt__test: COMMIT
[0m05:14:49.970281 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:14:49.978748 [debug] [Thread-1 (]: Using postgres connection "model.ffd.mrt__test"
[0m05:14:49.979467 [debug] [Thread-1 (]: On model.ffd.mrt__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "public", "node_id": "model.ffd.mrt__test"} */
drop table if exists "ffd"."03_mrt"."mrt__test__dbt_backup" cascade
[0m05:14:49.987437 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m05:14:49.993478 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:49.994167 [debug] [Thread-1 (]: On model.ffd.mrt__test: Close
[0m05:14:49.995622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a6ae745-9e91-41b1-a3fd-ee8afb5ef600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d5a7399f0>]}
[0m05:14:49.997140 [info ] [Thread-1 (]: 2 of 3 OK created table model 03_mrt.mrt__test ................................. [[32mSELECT 2[0m in 0.10s]
[0m05:14:49.998630 [debug] [Thread-1 (]: Finished running node model.ffd.mrt__test
[0m05:14:49.999431 [debug] [Thread-1 (]: Began running node model.ffd.stg__test
[0m05:14:50.000694 [info ] [Thread-1 (]: 3 of 3 START table model 01_stg.stg__test ...................................... [RUN]
[0m05:14:50.002352 [debug] [Thread-1 (]: Acquiring new postgres connection "model.ffd.stg__test"
[0m05:14:50.003040 [debug] [Thread-1 (]: Began compiling node model.ffd.stg__test
[0m05:14:50.003662 [debug] [Thread-1 (]: Compiling model.ffd.stg__test
[0m05:14:50.009763 [debug] [Thread-1 (]: Writing injected SQL for node "model.ffd.stg__test"
[0m05:14:50.010968 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:50.011895 [debug] [Thread-1 (]: Began executing node model.ffd.stg__test
[0m05:14:50.023870 [debug] [Thread-1 (]: Writing runtime SQL for node "model.ffd.stg__test"
[0m05:14:50.025005 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:14:50.025417 [debug] [Thread-1 (]: On model.ffd.stg__test: BEGIN
[0m05:14:50.025715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:14:50.056169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m05:14:50.057015 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:14:50.057567 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "public", "node_id": "model.ffd.stg__test"} */


  create  table "ffd"."01_stg"."stg__test__dbt_tmp"
  as (
    SELECT 1
UNION
SELECT 2
  );
[0m05:14:50.062107 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m05:14:50.071059 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:14:50.071654 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "public", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."01_stg"."stg__test" rename to "stg__test__dbt_backup"
[0m05:14:50.073236 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:14:50.081585 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:14:50.082187 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "public", "node_id": "model.ffd.stg__test"} */
alter table "ffd"."01_stg"."stg__test__dbt_tmp" rename to "stg__test"
[0m05:14:50.083715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:14:50.090760 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m05:14:50.091634 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:14:50.092552 [debug] [Thread-1 (]: On model.ffd.stg__test: COMMIT
[0m05:14:50.103832 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m05:14:50.118735 [debug] [Thread-1 (]: Using postgres connection "model.ffd.stg__test"
[0m05:14:50.119301 [debug] [Thread-1 (]: On model.ffd.stg__test: /* {"app": "dbt", "dbt_version": "1.2.3", "profile_name": "ffd", "target_name": "public", "node_id": "model.ffd.stg__test"} */
drop table if exists "ffd"."01_stg"."stg__test__dbt_backup" cascade
[0m05:14:50.129401 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m05:14:50.133033 [debug] [Thread-1 (]: finished collecting timing info
[0m05:14:50.133678 [debug] [Thread-1 (]: On model.ffd.stg__test: Close
[0m05:14:50.135132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a6ae745-9e91-41b1-a3fd-ee8afb5ef600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d59e7e9b0>]}
[0m05:14:50.140795 [info ] [Thread-1 (]: 3 of 3 OK created table model 01_stg.stg__test ................................. [[32mSELECT 2[0m in 0.13s]
[0m05:14:50.142963 [debug] [Thread-1 (]: Finished running node model.ffd.stg__test
[0m05:14:50.159253 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m05:14:50.160022 [debug] [MainThread]: Using postgres connection "master"
[0m05:14:50.160542 [debug] [MainThread]: On master: BEGIN
[0m05:14:50.160991 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:14:50.188249 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m05:14:50.188926 [debug] [MainThread]: On master: COMMIT
[0m05:14:50.189407 [debug] [MainThread]: Using postgres connection "master"
[0m05:14:50.189825 [debug] [MainThread]: On master: COMMIT
[0m05:14:50.190651 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:14:50.191728 [debug] [MainThread]: On master: Close
[0m05:14:50.197663 [info ] [MainThread]: 
[0m05:14:50.198669 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m05:14:50.199510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:14:50.200166 [debug] [MainThread]: Connection 'model.ffd.stg__test' was properly closed.
[0m05:14:50.322168 [info ] [MainThread]: 
[0m05:14:50.322895 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:14:50.323600 [info ] [MainThread]: 
[0m05:14:50.324183 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:14:50.324948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d5bfd77f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d5bfd40a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d5bfd7670>]}
[0m05:14:50.325525 [debug] [MainThread]: Flushing usage events
